<div class="page-container">
    <h1>Liberalman</h1>
    <form id="form-login">
        <input type="text" name="username" id="username" placeholder="用户名/邮箱" value="zscchina@163.com">
        <input type="password" name="password" id="password" placeholder="密码" value="1234567">
        <button type="submit">登录</button>
        <div class="error"><span>+</span></div>
    </form>
    <form id="form-register" style="display:none;">
        <input type="text" name="username" id="username" placeholder="用户名" value="aaa">
        <input type="text" name="email" id="email" placeholder="email" value="zscchina@163.com">
        <input type="password" name="password" id="password" placeholder="密码" value="1234567">
        <button type="submit">注册</button>
        <div class="error"><span>+</span></div>
    </form>
    </br>
    <a id="btn-register" href="#">注册</a>
    <div class="connect">
        <p>Or connect with:</p>
        <p>
            <a class="facebook" href=""></a>
            <a class="twitter" href=""></a>
        </p>
    </div>
</div>
<div align="center">背景作品来自：<a href="http://liberalman.lofter.com" target="_blank" title="liberalman">liberalman</a></div>

<!-- Javascript -->
<script src="/js/jquery-1.8.2.min.js" type="text/javascript"></script>
<script src="/js/jquery.validate.js" type="text/javascript"></script>
<script src="/js/supersized.3.2.7.min.js"></script>
<script type="text/javascript" src="{{.staticPath}}/js/toastr.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {

    var islogin = 1;
    
    // 背景轮换
    $.supersized({

        // Functionality
        slide_interval     : 4000,    // Length between transitions
        transition         : 1,    // 0-None, 1-Fade, 2-Slide Top, 3-Slide Right, 4-Slide Bottom, 5-Slide Left, 6-Carousel Right, 7-Carousel Left
        transition_speed   : 1000,    // Speed of transition
        performance        : 1,    // 0-Normal, 1-Hybrid speed/quality, 2-Optimizes image quality, 3-Optimizes transition speed // (Only works for Firefox/IE, not Webkit)

        // Size & Position
        min_width          : 0,    // Min width allowed (in pixels)
        min_height         : 0,    // Min height allowed (in pixels)
        vertical_center    : 1,    // Vertically center background
        horizontal_center  : 1,    // Horizontally center background
        fit_always         : 0,    // Image will never exceed browser width or height (Ignores min. dimensions)
        fit_portrait       : 1,    // Portrait images will not exceed browser height
        fit_landscape      : 0,    // Landscape images will not exceed browser width

        // Components
        slide_links        : 'blank',    // Individual links for each slide (Options: false, 'num', 'name', 'blank')
        slides             : [    // Slideshow Images
                                 {image : '/img/background/1.jpg'},
                                 {image : '/img/background/2.jpg'},
                                 {image : '/img/background/3.jpg'},
                                 {image : '/img/background/smb_owner-1.jpg'},
                                 {image : '/img/background/smb_owner-2.jpg'},
                                 {image : '/img/background/smb_owner.jpg'},
                             ]

    });

    /*$('.page-container form').submit(function(){
        var username = $(this).find('.username').val();
        var password = $(this).find('.password').val();
        if(username == '') {
            $(this).find('.error').fadeOut('fast', function(){
                $(this).css('top', '27px');
            });
            $(this).find('.error').fadeIn('fast', function(){
                $(this).parent().find('.username').focus();
            });
            return false;
        }
        if(password == '') {
            $(this).find('.error').fadeOut('fast', function(){
                $(this).css('top', '96px');
            });
            $(this).find('.error').fadeIn('fast', function(){
                $(this).parent().find('.password').focus();
            });
            return false;
        }
    });

    $('.page-container form .username, .page-container form .password').keyup(function(){
        $(this).parent().find('.error').fadeOut('fast');
    });*/
    
    $("#form-login").validate({
        rules: {
            username: {
                required: true,
                minlength: 2
            },
            password: {
                required: true,
                minlength: 6
            }
        },
        messages: {
            username: {
                required: '<font color="red">请输入用户名!</font>',
                minlength: '<font color="red">用户名长度不能小于 2 个字母!</font>'
            },
            password: {
                required: '<font color="red">请输入密码!</font>',
                minlength: '<font color="red">密码长度不能小于 6 个字母!</font>'
            }
        },
        // 使用 ajax 方式提交
        submitHandler: function(form) {
            $.post('/login',
                $(form).serialize(),
                function(data) {
                    if ("0" != data) { // 返回0代表成功，其他失败
                        toastr.error(data);
                    } else {
                        toastr.success('登录成功');
                        window.location = "/"; //跳转到首页
                    }
                });
        },
        // 指明错误放置的位置，默认情况是：error.appendTo(element.parent());即把错误信息放在验证的元素后面。
        errorPlacement: function(error, element) {
            toastr.error(error[0].innerText);
            $(element).closest("form").find("input").removeClass('error'); //这个1.8.2版本的jquery和validate配合有问题，这里需要去除下error，不然input框会被删除。
            //$(element).closest("form").find("input[name='" + element.attr("id") + "']").append(error);
        }
    });
    
    $('#btn-register').click(function(){
        if(1 == islogin){
            $("#form-login").css('display', 'none');
            $("#form-register").css('display', 'block');
            $(this).html('登录');
            islogin = 0;
        } else {
            $("#form-register").css('display', 'none');
            $("#form-login").css('display', 'block');
            $(this).html('注册');
            islogin = 1;
        }
        
    });
});
</script>

