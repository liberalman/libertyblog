/*
Navicat MySQL Data Transfer

Source Server         : 192.168.0.5
Source Server Version : 50717
Source Host           : 192.168.0.5:3306
Source Database       : libertyblog

Target Server Type    : MYSQL
Target Server Version : 50717
File Encoding         : 65001

Date: 2017-02-09 00:48:26
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for tb_album
-- ----------------------------
DROP TABLE IF EXISTS `tb_album`;
CREATE TABLE `tb_album` (
  `id` mediumint(8) NOT NULL AUTO_INCREMENT,
  `name` varchar(100) NOT NULL COMMENT '相册名称',
  `cover` varchar(70) NOT NULL COMMENT '相册封面',
  `posttime` datetime NOT NULL,
  `ishide` tinyint(1) NOT NULL,
  `rank` tinyint(3) NOT NULL DEFAULT '0',
  `photonum` int(11) NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of tb_album
-- ----------------------------
INSERT INTO `tb_album` VALUES ('14', '风光', '/static/upload/smallpic/20151008/1444235608574745200.jpg', '2015-10-07 16:33:49', '0', '1', '2');

-- ----------------------------
-- Table structure for tb_comments
-- ----------------------------
DROP TABLE IF EXISTS `tb_comments`;
CREATE TABLE `tb_comments` (
  `id` mediumint(8) unsigned NOT NULL AUTO_INCREMENT COMMENT '评论id',
  `user_id` int(11) unsigned DEFAULT '0' COMMENT '用户id',
  `ref_comm_id` mediumint(9) unsigned DEFAULT NULL COMMENT '引用评论的id，引用的是本表的其他评论的id，作为对其评论的回复。默认为空，比如第一条评论就没有引用的评论。',
  `article_id` mediumint(8) unsigned DEFAULT '0' COMMENT '文章id，表示该评论是哪个文章下的评论。',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  `content` varchar(255) DEFAULT NULL COMMENT '评论内容',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of tb_comments
-- ----------------------------

-- ----------------------------
-- Table structure for tb_history
-- ----------------------------
DROP TABLE IF EXISTS `tb_history`;
CREATE TABLE `tb_history` (
  `id` mediumint(9) unsigned NOT NULL AUTO_INCREMENT COMMENT '历史足迹id',
  `userid` mediumint(9) unsigned DEFAULT '0' COMMENT '用户id',
  `dotime` datetime NOT NULL COMMENT '足迹时间',
  `title` varchar(128) CHARACTER SET utf8 DEFAULT NULL COMMENT '标题',
  `content` mediumtext CHARACTER SET utf8 COMMENT '内容',
  `pos` tinyint(4) DEFAULT '0' COMMENT '0 在时间轴左边 1 在时间轴右边',
  `icosty` tinyint(4) DEFAULT '0' COMMENT '0 1 2 3',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=50 DEFAULT CHARSET=utf8mb4;

-- ----------------------------
-- Records of tb_history
-- ----------------------------
INSERT INTO `tb_history` VALUES ('1', '1', '2015-10-08 16:40:51', '开天辟地', '今天是本站建立的日子，于本人而言犹如盘古开天地而主万物。我终于有了自己的个人网站了！本来早3年都可以做的事情，为什么要拖到现在，打死拖延症！域名暂不可用，先用公司域名，或者直接访问服务器的方式！', '1', '1');
INSERT INTO `tb_history` VALUES ('2', '1', '2016-08-09 22:31:57', '手机版上线', '今天，手机版上线。采用手机和PC端引导访问不同的路由的方式，选取各种的模板来实现各自风格的效果。', '0', '0');
INSERT INTO `tb_history` VALUES ('3', '1', '2016-08-10 00:20:20', '第一个评论用户', '接入\"多说 - 社交评论插件\"，迎来本站史上第一位\"评论用户\"，本人QQ好友的\"@新月\"，Thanks支持。', '1', '4');
INSERT INTO `tb_history` VALUES ('8', '1', '2016-08-11 00:32:06', '接入 sphinx - 基于SQL的全文检索引擎', '接入\"接入 sphinx - 基于SQL的全文检索引擎\"，这玩意果然牛逼，从此摆脱使用SQL模糊查询的时代，说不定还可以做一个搜索引擎出来呢！', '0', '2');
INSERT INTO `tb_history` VALUES ('9', '1', '2016-08-15 00:33:07', '引入QQ登录', '目前还没和我的账户系统做绑定逻辑.', '1', '3');
INSERT INTO `tb_history` VALUES ('10', '1', '2016-08-16 00:54:49', '历史足迹-完成40%', '历史足迹板块，第一阶段完成了个人的 查/曾，还差 删/改 功能，占总功能50%；第二阶段是完成超级管理员对所有人历史足迹的管理，占总功能50%！', '1', '0');
INSERT INTO `tb_history` VALUES ('44', '1', '2016-08-16 19:52:12', '第一个注册用户', '今天迎来本站第一个注册用户，通过qq第三方登录注册的，welcome @新月 ！', '0', '4');
INSERT INTO `tb_history` VALUES ('47', '1', '2016-03-28 16:35:50', 'liberalman.cn通过备案', 'liberalman.cn域名通过了阿里云备案审核，终于可以指向我的服务器了，开始对外提供网站服务！', '0', '4');
INSERT INTO `tb_history` VALUES ('48', '1', '2016-08-17 17:35:28', '历史足迹完成', '历史足迹删改查功能也完成', '1', '1');

-- ----------------------------
-- Table structure for tb_link
-- ----------------------------
DROP TABLE IF EXISTS `tb_link`;
CREATE TABLE `tb_link` (
  `id` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,
  `sitename` varchar(80) NOT NULL DEFAULT '' COMMENT '网站名字',
  `url` varchar(200) NOT NULL DEFAULT '' COMMENT '友链URL地址',
  `rank` tinyint(4) NOT NULL DEFAULT '0' COMMENT '排序值',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of tb_link
-- ----------------------------
INSERT INTO `tb_link` VALUES ('1', '云卷云舒', 'http://www.doubleliu.com', '0');
INSERT INTO `tb_link` VALUES ('3', '首超的CSDN博客', 'http://blog.csdn.net/socho', '1');

-- ----------------------------
-- Table structure for tb_mood
-- ----------------------------
DROP TABLE IF EXISTS `tb_mood`;
CREATE TABLE `tb_mood` (
  `id` mediumint(8) NOT NULL AUTO_INCREMENT,
  `content` text NOT NULL,
  `cover` varchar(70) NOT NULL DEFAULT '/static/upload/defaultcover.png' COMMENT '说说图片',
  `posttime` datetime DEFAULT NULL COMMENT '发布时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=16 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of tb_mood
-- ----------------------------
INSERT INTO `tb_mood` VALUES ('15', '<p>今天好开心的说哦</p>', 'http://p7.qhimg.com/t01cd396814812f35a4.jpg', '2015-10-07 16:36:04');

-- ----------------------------
-- Table structure for tb_option
-- ----------------------------
DROP TABLE IF EXISTS `tb_option`;
CREATE TABLE `tb_option` (
  `id` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(30) NOT NULL DEFAULT '',
  `value` text NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=InnoDB AUTO_INCREMENT=20 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of tb_option
-- ----------------------------
INSERT INTO `tb_option` VALUES ('1', 'sitename', 'LIBERALMAN');
INSERT INTO `tb_option` VALUES ('2', 'siteurl', 'http://www.liberalman.cn');
INSERT INTO `tb_option` VALUES ('3', 'subtitle', '愚昧是产生专治的唯一土壤，我扫的就是愚昧！');
INSERT INTO `tb_option` VALUES ('4', 'pagesize', '10');
INSERT INTO `tb_option` VALUES ('5', 'keywords', '郑首超 编程技术 c c++ Golang Go语言 mysql java php 算法 数据结构 比特币 CTO 首席架构师');
INSERT INTO `tb_option` VALUES ('6', 'description', '来一场说走就走的旅行');
INSERT INTO `tb_option` VALUES ('8', 'theme', 'lofter');
INSERT INTO `tb_option` VALUES ('9', 'timezone', '8');
INSERT INTO `tb_option` VALUES ('10', 'stat', '<script>\r\nvar _hmt = _hmt || [];\r\n(function() {\r\n  var hm = document.createElement(\"script\");\r\n  hm.src = \"//hm.baidu.com/hm.js?40c7766ca3a4973166fc90c6a0280e4b\";\r\n  var s = document.getElementsByTagName(\"script\")[0]; \r\n  s.parentNode.insertBefore(hm, s);\r\n})();\r\n</script>\r\n\r\n');
INSERT INTO `tb_option` VALUES ('11', 'weibo', 'http://weibo.com/u/2000465995');
INSERT INTO `tb_option` VALUES ('12', 'github', 'https://github.com/liberalman/libertylog');
INSERT INTO `tb_option` VALUES ('16', 'duoshuo', 'liberalman');
INSERT INTO `tb_option` VALUES ('17', 'albumsize', '9');
INSERT INTO `tb_option` VALUES ('18', 'nickname', '自由人 - LIBERALMAN');
INSERT INTO `tb_option` VALUES ('19', 'icp', '京ICP备16013925号');

-- ----------------------------
-- Table structure for tb_photo
-- ----------------------------
DROP TABLE IF EXISTS `tb_photo`;
CREATE TABLE `tb_photo` (
  `id` mediumint(8) NOT NULL AUTO_INCREMENT,
  `albumid` mediumint(8) NOT NULL COMMENT '所属相册ID',
  `des` varchar(100) NOT NULL COMMENT '照片描述',
  `posttime` datetime NOT NULL COMMENT '上传时间',
  `url` varchar(70) NOT NULL COMMENT '照片URL地址',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=264 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of tb_photo
-- ----------------------------
INSERT INTO `tb_photo` VALUES ('262', '14', 'QQ图片20151007003846.jpg', '2015-10-07 17:15:07', '/static/upload/bigpic/20151008/1444238106613624800.jpg');
INSERT INTO `tb_photo` VALUES ('263', '14', '一个冰火粉丝Po的一张图：每当看到一个角色死掉时，他就会用便签纸做一个记号。5本书看完之后，就变成了这样~.jpg', '2015-10-07 17:15:56', '/static/upload/bigpic/20151008/1444238156369470700.jpg');

-- ----------------------------
-- Table structure for tb_post
-- ----------------------------
DROP TABLE IF EXISTS `tb_post`;
CREATE TABLE `tb_post` (
  `id` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,
  `userid` mediumint(8) unsigned NOT NULL DEFAULT '0' COMMENT '用户id',
  `title` varchar(100) NOT NULL DEFAULT '' COMMENT '标题',
  `color` varchar(7) NOT NULL DEFAULT '' COMMENT '标题颜色',
  `urlname` varchar(100) NOT NULL DEFAULT '' COMMENT 'url名',
  `urltype` tinyint(3) NOT NULL DEFAULT '0' COMMENT 'url访问形式',
  `content` mediumtext NOT NULL COMMENT '内容',
  `tags` varchar(100) NOT NULL DEFAULT '' COMMENT '标签',
  `views` mediumint(8) unsigned NOT NULL DEFAULT '0' COMMENT '查看次数',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '状态{0:正常,1:草稿,2:回收站}',
  `posttime` datetime DEFAULT NULL COMMENT '发布时间',
  `updated` datetime DEFAULT NULL COMMENT '更新时间',
  `istop` tinyint(3) NOT NULL DEFAULT '0' COMMENT '是否置顶',
  `coverurl` varchar(255) DEFAULT NULL COMMENT '文章封面',
  `pubtype` tinyint(4) DEFAULT '0' COMMENT '发布类型 0原创 1转载',
  `reprinturl` varchar(128) DEFAULT NULL COMMENT '从何处转载的地址地址，pubtype=1的时候生效',
  PRIMARY KEY (`id`),
  KEY `userid` (`userid`),
  KEY `posttime` (`posttime`),
  KEY `urlname` (`urlname`)
) ENGINE=InnoDB AUTO_INCREMENT=88 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of tb_post
-- ----------------------------
INSERT INTO `tb_post` VALUES ('14', '1', '中国人为什么不讲诚信？', '', '', '0', '<p>中国人为什么不讲诚信？</p><p>文：雾满拦江</p><p>（01）</p><p>我有个朋友，是画家。</p><p>她有个朋友，也是画家，最近从丽江回来，归来空空的行囊，满身是伤，心已憔悴。</p><p>丽江归来的女画家，是个雄心勃勃的女生，几年前她背着行囊到丽江，以20年的租期，租下一简陋贫寒农家院，而后艺术设计，改造，工艺美化，加盖了一排极具乡间风情的房间，开始经营她的小客栈。当时，如她这样的文艺女青年有许多，就这样几年下来，终于打出了丽江旅游的文化品牌。</p><p>品牌效应是无敌的，第一个上门的是房东，一改此前的憨厚纯朴，开口就要改合同，涨房租。</p><p>涨就涨吧，可房东一口价，就长到把她客栈利润吞光光的地步，还不许讨价还价。不答应？嘿，房东正等着你的不答应呢，随后就是无休止的上门骚扰，寻衅，辱骂，泼粪，甚至殴打，夜晚时在窗外弄出极恐怖的动静。</p><p>她说：官司在打，但赢的希望不大。</p><p>甚至有媒体的帮助，也是枉然。</p><p>就算赢，也已经被折腾的心力交瘁，支撑不下去了。</p><p>她说，这已经是她第三次遭遇这种事了。第一次，是在798，第二次，是在宋庄。每次做的事业类型都不一样，但结局一样。都是品牌效果一出来，昔日闷憨的房东，就立即变了嘴脸，她说她现在再也不敢相信合同了。</p><p>只因为，她遇到的中国人，都不讲诚信。</p><p>（02）</p><p>陈志武教授以前有过一个讲话，大意是，中国人为何勤劳而不能致富？</p><p>解释是：因为中国社会，缺乏诚信意识。不讲诚信，做生意就艰难了，生意双方会为货到货款，还是款到付货，争得不可开交，谁也不相信谁，轻信就会吃大亏。</p><p>因为环境中缺乏诚信因素与契约要义，商业国家五秒钟做成的生意，在中国要忙活好几年。要把大单拆分成无数小单，一点一点的测试合作伙伴，哪怕是合作几十年的朋友，也放心不下。所以中国人忙得团团乱转，一年到头操劳奔波，全部心思都用在避免吃亏上当方面，实际上是在为不健康的环境埋单。</p><p>为什么中国人不讲诚信呢？</p><p>早在春秋战国，儒家就发现了这个问题，所以他们干脆利索的，反对诚信。</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p>', ',思想,', '47', '0', '2015-10-08 00:55:21', '2015-10-27 11:11:05', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('15', '1', '兼爱(上)', '', '', '0', '<p>原文</p><p>　　圣人以治天下为事者也，必知乱之所自起，焉能治之；不知乱之所自起，则不能治。譬之如医之攻人之疾者然：必知疾之所自起，焉能攻之；不知疾之所自起，则弗能攻。治乱者何独不然？必知乱之所自起，焉能治之；不知乱之斯自起，则弗能治。圣人以治天下为事者也，不可不察乱之所自起。</p><p><br/></p><p>　　当察乱何自起？起不相爱。臣子之不孝君父，所谓乱也。子自爱，不爱父，故亏父而自利；弟自爱，不爱兄，故亏兄而自利；臣自爱，不爱君，故亏君而自利，此所谓乱也。虽父之不慈子，兄之不慈弟，君之不慈臣，此亦天下之所谓乱也。父自爱也，不爱子，故亏子而自利；兄自爱也，不爱弟，故亏弟而自利；君自爱也，不爱臣，故亏臣而自利。是何也？皆起不相爱。</p><p><br/></p><p>　　虽至天下之为盗贼者亦然：盗爱其室，不爱其异室，故窃异室以利其室。贼爱其身，不爱人，故贼人以利其身。此何也？皆起不相爱。虽至大夫之相乱家，诸侯之相攻国者亦然：大夫各爱其家，不爱异家，故乱异家以利其家。诸侯各爱其国，不爱异国，故攻异国以利其国，天下之乱物，具此而巳矣。察此何自起？皆起不相爱。</p><p><br/></p><p>　　若使天下兼相爱，爱人若爱其身，犹有不孝者乎？视父兄与君若其身，恶施不孝？犹有不慈者乎？视弟子与臣若其身，恶施不慈？故不孝不慈亡有。犹有盗贼乎？故视人之室若其室，谁窃？视人身若其身，谁贼？故盗贼亡有。犹有大夫之相乱家、诸侯之相攻国者乎？视人家若其家，谁乱？视人国若其国，谁攻？故大夫之相乱家、诸侯之相攻国者亡有。若使天下兼相爱，国与国不相攻，家与家不相乱，盗贼无有，君臣父子皆能孝慈，若此，则天下治。</p><p><br/></p><p>　　故圣人以治天下为事者，恶得不禁恶而劝爱？故天下兼相爱则治，交相恶则乱。故子墨子曰：“不可以不劝爱人者，此也。”</p><p><br/></p><p><br/></p><p>译文</p><p>　　圣人是以治理天下为职业的人，必须知道混乱从哪里产生，才能对它进行治理。如果不知道混乱从哪里产生，就不能进行治理。这就好像医生给人治病一样，必须知道疾病产生的根源，才能进行医治。如果不知道疾病产生的根源，就不能医治。治理混乱又何尝不是这样，必须知道混乱产生的根源，才能进行治理。如果不知道混乱产生的根源，就不能治理。圣人是以治理天下为职业的人，不可不考察混乱产生的根源。</p><p><br/></p><p>　　试考察混乱从哪里产生呢？起于人与人不相爱。臣与子不孝敬君和父，就是所谓乱。儿子爱自己而不爱父亲，因而损害父亲以自利；弟弟爱自己而不爱兄长，因而损害兄长以自利；臣下爱自己而不爱君上，因而损害君上以自利，这就是所谓混乱。反过来，即使父亲不慈爱儿子，兄长不慈爱弟弟，君上不慈爱臣下，这也是天下的所谓混乱。父亲爱自己而不爱儿子，所以损害儿子以自利；兄长爱自己而不爱弟弟，所以损害弟弟以自利；君上爱自己</p><p><br/></p><p>　　而不爱臣下，所以损害臣下以自利。这是为什么呢？都是起于不相爱。</p><p><br/></p><p>　　即使在天底下做盗贼的人，也是这样。盗贼只爱自己的家，不爱别人的家，所以盗窃别人的家以利自己的家；盗贼只爱自身，不爱别人，所以残害别人以利自己。这是什么原因呢？都起于不相爱。</p><p><br/></p><p>　　即使大夫相互侵扰家族，诸侯相互攻伐封国，也是这样。大夫各自爱他自己的家族，不爱别人的家族，所以侵扰别人的家族以利他自己的家族；诸侯各自爱他自己的国家，不爱别人的国家，所以攻伐别人的国家以利他自己的国家。天下的乱事，全部都具备在这里了。细察它从哪里产生呢？都起于不相爱。</p><p><br/></p><p>　　假若天下都能相亲相爱，爱别人就象爱自己，还能有不孝的吗？看待父亲、兄弟和君上象自己一样，怎么会做出不孝的事呢？还会有不慈爱的吗？看待弟弟、儿子与臣下象自己一样，怎么会做出不慈的事呢？所以不孝不慈都没有了。还有盗贼吗？看待别人的家象自己的家一样，谁会盗窃？看待别人就象自己一样，谁会害人？所以盗贼没有了。还有大夫相互侵扰家族，诸侯相互攻伐封国吗？看待别人的家族就象自己的家族，谁会侵犯？看待别人的封国就象自己的封国，谁会攻伐？所以大夫相互侵扰家族，诸侯相互攻伐封国，都没有了。假若天下的人都相亲相爱，国家与国家不相互攻伐，家族与家族不相互侵扰，盗贼没有了，君臣父子间都能孝敬慈爱，象这样，天下也就治理了。</p><p><br/></p><p>　　所以圣人既然是以治理天下为职业的人，怎么能不禁止相互仇恨而鼓励相爱呢？因此天下的人相亲相爱就会治理好，相互憎恶则会混乱。所以墨子说：“不能不鼓励爱别人”，道理就在此。</p><p><br/></p><p>注释</p><p>（1）兼爱是墨家学派最有代表性的理论之一。所谓兼爱，其本质是要求人们爱人如己，彼此之间不要存在血缘与等级差别的观念。墨子认为，不相爱是当时社会混乱最大的原因，只有通过“兼相爱，交相利”才能达到社会安定的状态。这种理论具有反抗贵族等级观念的进步意义，但同时也带有强烈的理想色彩。</p><p>（2）当：读为“尝”。</p><p>（3）恶（wū）：何。</p><p>（4）亡：通“无”。</p><p><br/></p>', ',思想,', '64', '0', '2015-10-08 01:06:33', '2015-10-08 01:07:35', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('16', '1', '图片压缩的坑', '', '', '0', '<p><span id=\"paperTitle\" style=\"margin: 0px; padding: 25px 0px 0px; display: block; word-break: break-all; color: rgb(0, 0, 0);\"><span style=\"line-height: 1.5em;\">&nbsp; &nbsp;今天元菲有个朋友过来聊天，介绍他们产品的时候，提及图片压缩优化。对方使用的格式是webp格式，网上搜了下，比jpeg压缩率更高一些，他们的产品刷图片列表很快便加载下来，点击放大看也不模糊，一个大图50k左右，比我们2~300k的要小不少。</span><br/></span></p><p>&nbsp; &nbsp;其实之前我们是在客户端进行压缩，只裁剪和压缩了一遍，生成的图片很大；也曾尝试图重复压缩，发现生产环境中客户端有些图片模糊，遂去掉了二次压缩，保留高缩质量，导致出图占用空间很大，300K左右，有些图甚至1M，用户流量损耗巨大。<br/><span style=\"margin: 0px; padding: 0px;\">&nbsp; &nbsp; 这次提说webp格式很节省流量，遂查询资料并做尝试，发现将我们现有图用webp格式压缩后，比原来小了9/10，15k左右，观察图片质量，稍微逊色，没有很明显的下降。有种相见恨晚的感觉，遂倾向使用此格式。不过webp是谷歌出的，Android原生支持，ios要加第三方库才能使用，ios客户端有开发成本。在ios同事的建议下，又使用jpeg做了二次压缩，惊人的发现，压缩后的图片，也是比原来小了9/10，只比webp稍微大了1k&nbsp;多，图片质量也没看到明显下降。此时如梦初醒，原来是当初第一次压缩，保留细节太多，没有在质量上大刀阔斧的砍下去，当我尝试两种压缩方式都将质量保留100%时候，二次压缩基本只比原来少了1/10的样子，webp会少一点，但不是很明显。对我们而言，webp和jpeg都可以使用，都压缩到这个份上了，差一点也无所谓了。<br/><span style=\"margin: 0px; padding: 0px;\">&nbsp; &nbsp; 于是连夜修改，将所有图片重新做二次压缩，让测试反复测，看看调整图片质量，找到个合适的压缩率，以维持美观和节省流量平衡。这次可以大幅度压缩下，图片质量降低很多，在手机上感觉也不明显，之前因为太吹毛求疵了，一两张图片模糊就全盘否定，导致用户文件夹图片缓存动辄1~2G，安卓手机满了不清理的话，直接不能用，新图片无法下载。现在打算牺牲个别图片，即使看起来模糊，也要坚持大压缩率，以保证大部分人用起来顺畅，总想全都顾及到是不行的，必要时候牺牲一小部分是可以接受的！</span></span></p><p><br/></p>', ',技术,', '113', '0', '2015-10-08 01:08:18', '2015-10-08 01:10:12', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('17', '1', '【转】jQuery插件开发 - 其实很简单', '', '', '0', '<p>【转】<a href=\"http://www.cnblogs.com/fromearth/archive/2009/07/08/1519054.html\" _src=\"http://www.cnblogs.com/fromearth/archive/2009/07/08/1519054.html\">http://www.cnblogs.com/fromearth/archive/2009/07/08/1519054.html</a> </p><p style=\"margin: 10px auto;\"><span style=\"font-weight: bold;\"></span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">【前言】</span></p><p style=\"text-indent:29px\">jQuery<span style=\"font-family:宋体\">已经被广泛使用，凭借其简洁的</span>API<span style=\"font-family:宋体\">，对</span>DOM<span style=\"font-family: 宋体\">强大的操控性，易扩展性越来越受到</span>web<span style=\"font-family:宋体\">开发人员的喜爱，我在社区也发布了很多的</span>jQuery<span style=\"font-family:宋体\">插件，经常有人询问一些技巧，因此干脆写这么一篇文章给各位</span>jQuery<span style=\"font-family:宋体\">爱好者，算是抛砖引玉吧。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">【基础】</span>&nbsp;</p><p style=\"text-indent:29px\"><em>a)</em><em><span style=\"font-family:宋体\">样式</span></em></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">很</span> <span style=\"font-family:宋体\">多人会认为样式是个很复杂的东西，需要沉着冷静的心态加上非凡的审美观才能设计出赏心悦目的</span>UI<span style=\"font-family:宋体\">，抛开图片设计不说，其实</span>css<span style=\"font-family:宋体\">也就是那么些属</span> <span style=\"font-family:宋体\">性：</span>position,margin,padding,width,height,left,top,float,border,background...</p><p style=\"text-indent:29px\">UI<span style=\"font-family:宋体\">设计的漂亮与否在很大程度上依赖于设计人员对配色的把握和整体效果的协调。举个简单的例子，一个简单的页面，马虎的人：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">html&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:red\">xmlns</span><span style=\"font-size: 12px;font-family:Consolas;color:blue\">=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">head</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">title</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span><span style=\"font-size: 12px;font-family: Consolas\">Test&nbsp;Page</span><span style=\"font-size:12px;font-family: Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">title</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">head</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">body</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;jQuery</span><span style=\"font-size: 12px;font-family: 宋体\">是一个框架！压缩后有</span><span style=\"font-size: 12px;font-family: Consolas\">30</span><span style=\"font-size: 12px;font-family: 宋体\">多</span><span style=\"font-size: 12px;font-family: Consolas\">k</span><span style=\"font-size: 12px;font-family: 宋体\">吧。</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">body</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">html</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">细心的人：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">html&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:red\">xmlns</span><span style=\"font-size: 12px;font-family:Consolas;color:blue\">=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">head</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">title</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span><span style=\"font-size: 12px;font-family: Consolas\">Test&nbsp;Page</span><span style=\"font-size:12px;font-family: Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">title</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">style&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:red\">type</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">=&quot;text/css&quot;&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas;color: maroon\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas;color: maroon\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size: 12px;font-family: Consolas\">{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas;color: red\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size: 12px;font-family: Consolas;color: blue\">&#39;</span><span style=\"font-size: 12px;font-family: 宋体;color: blue\">宋体</span><span style=\"font-size: 12px;font-family: Consolas;color: blue\">&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas;color: red\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size: 12px;font-family: Consolas;color: blue\">12px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas;color: red\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas;color: maroon\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">style</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">head</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">body</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;jQuery</span><span style=\"font-size: 12px;font-family: 宋体\">是一个框架！压缩后有</span><span style=\"font-size: 12px;font-family: Consolas\">30</span><span style=\"font-size: 12px;font-family: 宋体\">多</span><span style=\"font-size: 12px;font-family: Consolas\">k</span><span style=\"font-size: 12px;font-family: 宋体\">吧。</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">body</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">html</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">专心的人：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">html&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:red\">xmlns</span><span style=\"font-size: 12px;font-family:Consolas;color:blue\">=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">head</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">title</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span><span style=\"font-size: 12px;font-family: Consolas\">Test&nbsp;Page</span><span style=\"font-size:12px;font-family: Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">title</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">style&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:red\">type</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">=&quot;text/css&quot;&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas;color: maroon\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;body</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas;color: maroon\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size: 12px;font-family: Consolas\">{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas;color: red\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size: 12px;font-family: Consolas;color: blue\">&#39;Verdana&#39;,&#39;</span><span style=\"font-size: 12px;font-family: 宋体;color: blue\">宋体</span><span style=\"font-size: 12px;font-family: Consolas;color: blue\">&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas;color: red\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size: 12px;font-family: Consolas;color: blue\">12px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas;color: red\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas;color: maroon\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">style</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">head</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">body</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;jQuery</span><span style=\"font-size: 12px;font-family: 宋体\">是一个框架！压缩后有</span><span style=\"font-size: 12px;font-family: Consolas\">30</span><span style=\"font-size: 12px;font-family: 宋体\">多</span><span style=\"font-size: 12px;font-family: Consolas\">k</span><span style=\"font-size: 12px;font-family: 宋体\">吧。</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">body</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">html</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">我们对比一下三者的</span>UI<span style=\"font-family:宋体\">效果：</span></p><p style=\"margin-top:10px;margin-bottom:10px;text-indent:0;line-height:18px;background:white\"><span style=\"font-size: 12px;font-family: Consolas\"><img width=\"307\" height=\"55\" src=\"/static/ueditor/themes/default/images/spacer.gif\" style=\"background:url(/static/ueditor/lang/zh-cn/images/localimage.png) no-repeat center center;border:1px solid #ddd\" border=\"0\" word_img=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image001.gif\"/></span></p><p style=\"margin-top:10px;margin-bottom:10px;text-indent:0;line-height:18px;background:white\"><span style=\"font-size: 12px;font-family: Consolas\"><img width=\"232\" height=\"43\" src=\"/static/ueditor/themes/default/images/spacer.gif\" style=\"background:url(/static/ueditor/lang/zh-cn/images/localimage.png) no-repeat center center;border:1px solid #ddd\" border=\"0\" word_img=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image002.gif\"/></span></p><p style=\"margin-top:10px;margin-bottom:10px;text-indent:0;line-height:18px;background:white\"><span style=\"font-size: 12px;font-family: Consolas\"><img width=\"245\" height=\"50\" src=\"/static/ueditor/themes/default/images/spacer.gif\" style=\"background:url(/static/ueditor/lang/zh-cn/images/localimage.png) no-repeat center center;border:1px solid #ddd\" border=\"0\" word_img=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image003.gif\"/></span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">一目了然，或许很多的站点失去关注正是因为这不起眼的</span>font-family,font-size<span style=\"font-family:宋体\">。当然这还只是个简单的例子，掌握</span>css<span style=\"font-family:宋体\">应该从简单做起，从基本入手，在实践中运用并不断深入。</span></p><p style=\"text-indent:29px\"><strong><em>b)</em></strong><strong><em><span style=\"font-family:宋体\">脚本</span></em></strong>&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">我们同样需要对</span>javascript<span style=\"font-family:宋体\">有着深刻的理解，对</span>dom, xhr, Regex, call-apply, prototype<span style=\"font-family: 宋体\">等都应该有一定的了解。</span></p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">有人会说要这些有啥用啊，对</span>dom<span style=\"font-family:宋体\">的操作其实通过</span>getElementById, getElementsByTagName<span style=\"font-family:宋体\">以及其他的</span>API<span style=\"font-family:宋体\">都可以轻松的完成，这话是没错，当思路确定后，思想才是重点，一段代码是精华还是糟粕很容易就</span> <span style=\"font-family:宋体\">可以区分出来，究其原因还是取决你自己，举个简单的例子，大量的</span>html<span style=\"font-family:宋体\">组装，路人甲：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;a&nbsp;=&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">new</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;Array(10);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;menu&nbsp;=&nbsp;&#39;&#39;;&nbsp;&nbsp;&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">for</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;(</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;a.length;&nbsp;i++)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;menu&nbsp;+=&nbsp;&#39;&lt;li&nbsp;class=&quot;style_&#39;&nbsp;+&nbsp;a[i]&nbsp;+&nbsp;&#39;&quot;&nbsp;&gt;&#39;&nbsp;+&nbsp;a[i]&nbsp;+&nbsp;&#39;&lt;/li&gt;&#39;;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">路人乙：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">String.prototype.format&nbsp;=&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">()&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;args&nbsp;=&nbsp;arguments;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">return</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">this</span><span style=\"font-size: 12px;font-family: Consolas\">.replace(/{(\\d{1})}/g,&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">()&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">return</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;args[arguments[1]];</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;});</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">};</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;a&nbsp;=&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">new</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;Array(1,2,3,4,5,6,7,8,9,0);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;m&nbsp;=&nbsp;&#39;&lt;li&nbsp;class=&quot;style_{0}&quot;&nbsp;&gt;{0}&lt;/li&gt;&#39;;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">for</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;(</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;a.length;&nbsp;i++)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;menu&nbsp;+=&nbsp;m.format(a[i]);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">在实现方式明确的情况下，优雅高效的代码显然更具吸引力。</span></p><p style=\"text-indent:29px\"><strong><span style=\"font-family:宋体\">【实践</span></strong><span style=\"font-family:宋体\">】</span></p><p style=\"text-indent:29px\">jQuery<span style=\"font-family:宋体\">开发或使用，更多的灵感是来自实践，而不是</span>copy||paste(<span style=\"font-family:宋体\">奉行拿来主义的同学可以离开了</span>)<span style=\"font-family:宋体\">。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">那么在这里我会用一个简单的例子来阐述</span>jQuery<span style=\"font-family:宋体\">插件开发的流程，能否举一反三就看各位看官了。</span></p><p style=\"text-indent:29px\"><strong><span style=\"font-family:宋体\">【目的】</span></strong>&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">开发一个插件之前我们需要对自己的目的有一个清醒的认识，有很明确的方向感，那么此次我作为示例插件的目的，就是呈现一个用于</span>UI<span style=\"font-family:宋体\">的</span><span style=\"color:red\">Slider - </span><span style=\"font-family:宋体;color:red\">滑动条</span><span style=\"font-family:宋体\">，常年从事于或暂时专注于</span>win32<span style=\"font-family:宋体\">开发的同学应该比较了解。</span></p><p style=\"text-indent:29px\"><strong><span style=\"font-family:宋体\">草图</span></strong></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">真正动手编码之前我们还需要有一个草图来描述自己插件的</span>“<span style=\"font-family:宋体\">长相</span>”<span style=\"font-family:宋体\">（事件驱动或</span>API<span style=\"font-family:宋体\">封装的可以忽略）。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">很多的同学在做</span>UI<span style=\"font-family:宋体\">开发前往往会忙于搜集各种小图片</span>(<span style=\"font-family:宋体\">非精通</span>ps<span style=\"font-family:宋体\">或</span>iconworkshop<span style=\"font-family:宋体\">人士</span>)<span style=\"font-family: 宋体\">，其实漂亮的图标的确可以美化我们的</span>UI<span style=\"font-family:宋体\">，不过我一般的处理方式是编写易于扩展的</span>css<span style=\"font-family:宋体\">，前期的</span>UI<span style=\"font-family:宋体\">呈现尽量少使用图片，多用线条完成。</span></p><p style=\"text-indent:29px\">ok<span style=\"font-family:宋体\">，言归正卷，那么我的</span>slider<span style=\"font-family:宋体\">设计草图是</span>:</p><p style=\"text-indent:29px\"><img width=\"300\" height=\"100\" src=\"/static/ueditor/themes/default/images/spacer.gif\" style=\"background:url(/static/ueditor/lang/zh-cn/images/localimage.png) no-repeat center center;border:1px solid #ddd\" border=\"0\" word_img=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image004.gif\"/>&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">解释下下文将用到的几个词：</span></p><p style=\"text-indent:29px\"><strong>slider:</strong>&nbsp;<span style=\"font-family:宋体\">此部分是作为拖拽手柄来使用，用户可以通过拖拽此部分来更新</span>completed bar<span style=\"font-family:宋体\">的位置。</span></p><p style=\"text-indent:29px\"><strong>completed:</strong>&nbsp;<span style=\"font-family:宋体\">此部分作为</span>bar<span style=\"font-family:宋体\">的内嵌元素，作为特殊效果来显示</span>slider<span style=\"font-family:宋体\">与起始点的距离，亦即与</span>slider<span style=\"font-family:宋体\">的</span>value<span style=\"font-family: 宋体\">值关联。</span></p><p style=\"text-indent:29px\"><strong>bar:</strong>&nbsp;slider<span style=\"font-family:宋体\">的载体，</span>completed<span style=\"font-family:宋体\">的满值。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">思路：</span></p><p style=\"text-indent:29px\">slider<span style=\"font-family:宋体\">作为手柄提供拖拽功能，作用区域为</span>bar<span style=\"font-family:宋体\">，拖拽过程中</span>completed<span style=\"font-family:宋体\">条必须实时更新</span>(<span style=\"font-family:宋体\">长度</span>)<span style=\"font-family: 宋体\">，影响区域为</span>slider<span style=\"font-family:宋体\">至</span>bar<span style=\"font-family:宋体\">左端的距离。</span></p><p style=\"text-indent:29px\"><strong><span style=\"font-family:宋体\">【编码】</span></strong>&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">开发</span>jQuery UI/Effect <span style=\"font-family:宋体\">插件在很多时候都需要与</span>UI<span style=\"font-family:宋体\">交互，因此在呈现上需要提供</span>Html tree<span style=\"font-family:宋体\">来绘制我们的插件，最终通过</span>js dom<span style=\"font-family:宋体\">来输出，那么在绘制简单的</span>dom<span style=\"font-family:宋体\">结构的时候我会直接用</span>js<span style=\"font-family:宋体\">来完成，不过如果嵌套比较复杂的话，我们还是应该先用</span>html<span style=\"font-family:宋体\">来完成，然后转变成</span>js<span style=\"font-family:宋体\">输</span> <span style=\"font-family:宋体\">出。</span></p><p style=\"margin-top:10px;margin-bottom:10px;text-indent:0;line-height:18px;background:white\"><span style=\"text-decoration:underline;\"><span style=\"font-size:12px;font-family:Consolas;color:red\">html tree:</span></span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">div&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:red\">class</span><span style=\"font-size: 12px;font-family:Consolas;color:blue\">=&quot;defaultbar&quot;&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">div&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:red\">class</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">=&quot;jquery-completed&quot;&gt;</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">div</span><span style=\"font-size: 12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">div&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:red\">class</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">=&quot;jquery-jslider&quot;&gt;</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">div</span><span style=\"font-size: 12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">&lt;/</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">div</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&gt;</span></p><p style=\"text-indent:29px\">deafultbar -&gt; bar</p><p style=\"text-indent:29px\">jquery-completed -&gt; completed</p><p style=\"text-indent:29px\">jquery-jslider -&gt; slider</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">前期</span>UI<span style=\"font-family:宋体\">呈现上我们不使用图片，尽量用线条、颜色来完成：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:green\">/*----default&nbsp;skin----*/</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:maroon\"><img width=\"11\" height=\"16\" src=\"/static/ueditor/themes/default/images/spacer.gif\" style=\"background:url(/static/ueditor/themes/default/images/word.gif) no-repeat center center;border:1px solid #ddd\" word_img=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image005.gif\"/>.defaultbar</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;margin-top</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;10px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;height</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;5px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;background-color</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;#FFFFE0</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;border</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;1px&nbsp;solid&nbsp;#A9C9E2</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;position</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;relative</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:maroon\">.defaultbar&nbsp;.jquery-completed</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;height</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;3px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;background-color</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;#7d9edb</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;top</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;1px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;left</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">1px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;position</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;absolute</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:maroon\">.defaultbar&nbsp;.jquery-jslider</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;height</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;15px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;background-color</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;#E6E6FA</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;border</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;1px&nbsp;solid&nbsp;#A5B6C8</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;top</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;-6px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;display</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;block</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;cursor</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;pointer</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;position</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;absolute</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">将</span>bar<span style=\"font-family:宋体\">的</span>position<span style=\"font-family:宋体\">属性设置成</span>relative<span style=\"font-family:宋体\">，以方便子节点的浮动（子节点使用</span>position:absolute<span style=\"font-family:宋体\">来获得内联浮动效果）。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">那么我们可以看下这个</span>css<span style=\"font-family:宋体\">和</span>html tree<span style=\"font-family:宋体\">产生的</span>UI<span style=\"font-family: 宋体\">效果：</span></p><p style=\"text-indent:29px\"><img width=\"431\" height=\"38\" src=\"/static/ueditor/themes/default/images/spacer.gif\" style=\"background:url(/static/ueditor/themes/default/images/word.gif) no-repeat center center;border:1px solid #ddd\" border=\"0\" word_img=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image006.gif\"/>&nbsp;</p><p style=\"text-indent:29px\">ok,<span style=\"font-family:宋体\">具备了所需的元素</span> - slider, completed, bar.</p><p style=\"text-indent:29px\"><span style=\"text-decoration:underline;\"><span style=\"font-family:宋体;color:red\">一些规范</span><span style=\"color:red\">:</span></span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">当我们画出了</span>UI<span style=\"font-family:宋体\">之后就可以正式编写</span>jQuery<span style=\"font-family:宋体\">插件代码了，不过在着之前我们还需要对</span>jQuery<span style=\"font-family:宋体\">插件开发的一些规范性有一些了解。</span></p><p style=\"text-indent:29px\">1. <span style=\"font-family:宋体\">使用闭包：</span></p><p style=\"margin-left:29px;text-indent:0;line-height:18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">(</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">($)&nbsp;{</span></p><p style=\"margin-left:29px;text-indent:0;line-height:18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:green\">//&nbsp;Code&nbsp;goes&nbsp;here</span></p><p style=\"margin-left:29px;text-indent:0;line-height:18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">})(jQuery);</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">这是来自</span>jQuery<span style=\"font-family:宋体\">官方的插件开发规范要求，使用这种编写方式有什么好处呢？</span></p><p style=\"text-indent:29px\">a) <span style=\"font-family:宋体\">避免全局依赖。</span></p><p style=\"text-indent:29px\">b) <span style=\"font-family:宋体\">避免第三方破坏。</span></p><p style=\"text-indent:29px\">c) <span style=\"font-family:宋体\">兼容</span>jQuery<span style=\"font-family:宋体\">操作符</span>&#39;$&#39;<span style=\"font-family: 宋体\">和</span>&#39;jQuery &#39;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">我们知道这段代码在被解析时会形同如下代码：</span></p><p style=\"margin-left:29px;text-indent:0;line-height:18px;background:whitesmoke\"><span style=\"font-size:12px;font-family: Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;jq&nbsp;=&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">($)&nbsp;{</span></p><p style=\"margin-left:29px;text-indent:0;line-height:18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:green\">//&nbsp;Code&nbsp;goes&nbsp;here</span></p><p style=\"margin-left:29px;text-indent:0;line-height:18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">};&nbsp;</span></p><p style=\"margin-left:29px;text-indent:0;line-height:18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">jq(jQuery);</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">这样效果就一目了然了。</span></p><p style=\"text-indent:29px\">2. <span style=\"font-family:宋体\">扩展</span></p><p style=\"text-indent:29px\">jQuery<span style=\"font-family:宋体\">提供了</span>2<span style=\"font-family: 宋体\">个供用户扩展的</span>‘<span style=\"font-family:宋体\">基类</span>’ - $.extend<span style=\"font-family:宋体\">和</span>$.fn.extend.</p><p style=\"text-indent:29px\">$.extend <span style=\"font-family:宋体\">用于扩展自身方法，如</span>$.ajax, $.getJSON<span style=\"font-family:宋体\">等，</span>$.fn.extend<span style=\"font-family:宋体\">则是用于扩展</span>jQuery<span style=\"font-family:宋体\">类，包括方法和对</span>jQuery<span style=\"font-family:宋体\">对象的操作。为了保持</span>jQuery<span style=\"font-family:宋体\">的完整性，我比较</span> <span style=\"font-family:宋体\">趋向于使用</span>$.fn.extend<span style=\"font-family:宋体\">进行插件开发而尽量少使用</span>$.extend.</p><p style=\"text-indent:29px\">3. <span style=\"font-family:宋体\">选择器</span></p><p style=\"text-indent:29px\">jQuery<span style=\"font-family:宋体\">提供了功能强大，并兼容多种</span>css<span style=\"font-family:宋体\">版本的选择器，不过发现很多同学在使用选择器时并未注重效率的问题。</span>&nbsp;</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">a) <span style=\"font-family:宋体\">尽量使用</span>Id<span style=\"font-family: 宋体\">选择器，</span>jQuery<span style=\"font-family:宋体\">的选择器使用的</span>API<span style=\"font-family:宋体\">都是基于</span>getElementById<span style=\"font-family:宋体\">或</span>getElementsByTagName<span style=\"font-family:宋体\">，因此可以知道</span> <span style=\"font-family:宋体\">效率最高的是</span>Id<span style=\"font-family:宋体\">选择器，因为</span>jQuery<span style=\"font-family:宋体\">会直接调用</span>getElementById<span style=\"font-family:宋体\">去获取</span>dom<span style=\"font-family: 宋体\">，而通过样式选择器获取</span>jQuery<span style=\"font-family:宋体\">对象时往往会使用</span> getElementsByTagName<span style=\"font-family:宋体\">去获取然后筛选。</span></p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">b) <span style=\"font-family:宋体\">样式选择器应该尽量明确指定</span>tagName, <span style=\"font-family:宋体\">如果开发人员使用样式选择器来获取</span>dom<span style=\"font-family:宋体\">，且这些</span>dom<span style=\"font-family:宋体\">属于同一类型，例如获取所有</span>className<span style=\"font-family:宋体\">为</span>jquery<span style=\"font-family:宋体\">的</span>div<span style=\"font-family: 宋体\">，那么我们应该使用的写法</span> <span style=\"font-family:宋体\">是</span>$(&#39;div.jquery&#39;)<span style=\"font-family:宋体\">而不是</span>$(&#39;.jquery&#39;)<span style=\"font-family:宋体\">，这样写的好处非常明显，在获取</span>dom<span style=\"font-family:宋体\">时</span>jQuery<span style=\"font-family:宋体\">会获取</span>div<span style=\"font-family: 宋体\">然后进行筛选，而不是</span> <span style=\"font-family:宋体\">获取所有</span>dom<span style=\"font-family:宋体\">再筛选。</span></p><p style=\"text-indent:29px\">c) <span style=\"font-family:宋体\">避免迭代，很多同学在使用</span>jQuery<span style=\"font-family:宋体\">获取指定上下文中的</span>dom<span style=\"font-family:宋体\">时喜欢使用迭代方式，如</span>$(&#39;.jquery .child&#39;)<span style=\"font-family:宋体\">，获取</span>className<span style=\"font-family:宋体\">为</span>jquery<span style=\"font-family:宋体\">的</span>dom<span style=\"font-family: 宋体\">下的所有</span>className<span style=\"font-family:宋体\">为</span>child<span style=\"font-family:宋体\">的节点，其实这样编写代码付出的代价是非常大</span> <span style=\"font-family:宋体\">的，</span>jQuery<span style=\"font-family:宋体\">会不断的进行深层遍历来获取需要的元素，即使确实需要，我们也应该使用诸如</span>$(selector,context), $(&#39;selector1&gt;selector2&#39;), $(selector1).children(selector2), $(selctor1).find(selector2)<span style=\"font-family:宋体\">之类的方式。</span></p><p style=\"text-indent:29px\"><span style=\"text-decoration:underline;\"><span style=\"font-family:宋体;color:red\">开始编码</span></span>&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">话题有点扯远，</span>ok<span style=\"font-family:宋体\">，在对</span>UI<span style=\"font-family:宋体\">有了清晰的认识后我们就可以使用</span>js<span style=\"font-family:宋体\">来输出</span>html<span style=\"font-family:宋体\">了。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">我们使用</span>jSlider<span style=\"font-family:宋体\">来命名这个</span>slider<span style=\"font-family:宋体\">插件</span>(<span style=\"font-family:宋体\">为了避免插件冲突，插件命名时也应十分考究，这里我就俗一回</span>)<span style=\"font-family:宋体\">。</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">$.extend($.fn,&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:green\">///&lt;summary&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:green\">///&nbsp;apply&nbsp;a&nbsp;slider&nbsp;UI</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:green\">///&lt;/summary&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jSlider:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">(setting)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">});</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">在插件开发中比较标准的方式是将元数据独立出来并开放</span>API<span style=\"font-family:宋体\">，比如这里的</span>setting<span style=\"font-family:宋体\">参数传入值，有时候为了减少代码编写量，我习惯于直接在插件内赋值：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;ps&nbsp;=&nbsp;$.extend({</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;renderTo:&nbsp;$(document.body),</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;enable:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">true</span><span style=\"font-size: 12px;font-family: Consolas\">,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;initPosition:&nbsp;&#39;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">max</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;size:&nbsp;{&nbsp;barWidth:&nbsp;200,&nbsp;sliderWidth:&nbsp;5&nbsp;},</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;barCssName:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;defaultbar&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;completedCssName:&nbsp;&#39;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">jquery-completed</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;sliderCssName:&nbsp;&#39;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">jquery-jslider&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;sliderHover:&nbsp;&#39;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">jquery-jslider-hover</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;onChanging:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">()&nbsp;{&nbsp;},</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;onChanged:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">()&nbsp;{&nbsp;}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">},&nbsp;setting);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">规范的做法：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">$.fn.jSlider.</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">default</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;=&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;renderTo:&nbsp;$(document.body),</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;enable:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">true</span><span style=\"font-size: 12px;font-family: Consolas\">,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;initPosition:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;max&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;size:&nbsp;{&nbsp;barWidth:&nbsp;200,&nbsp;sliderWidth:&nbsp;5&nbsp;},</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;barCssName:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;defaultbar&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;completedCssName:&nbsp;&#39;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">jquery-completed</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;sliderCssName:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;jquery-jslider</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;sliderHover:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;jquery-jslider-hover</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;onChanging:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">()&nbsp;{&nbsp;},</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;onChanged:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">()&nbsp;{&nbsp;}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;};</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">$.extend({},$.fn.jSlider.</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">default</span><span style=\"font-size: 12px;font-family: Consolas\">,setting);</span></p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">ok, <span style=\"font-family:宋体\">下面描述下我所定义的这些</span>API<span style=\"font-family:宋体\">的作用：</span></p><p style=\"text-indent:29px\"><strong>renderTo</strong>: jSlider<span style=\"font-family:宋体\">的载体、容器，可以是一个</span>jQuery<span style=\"font-family:宋体\">对象，也可以是选择器。</span></p><p style=\"text-indent:29px\"><strong>enable</strong>: jSlider<span style=\"font-family:宋体\">插件是否可用，</span>true<span style=\"font-family:宋体\">时</span>end-user<span style=\"font-family:宋体\">可拖拽，否则禁止。</span></p><p style=\"text-indent:29px\"><strong>initPosition</strong>: jSlider<span style=\"font-family:宋体\">的初始值，</span>‘max’<span style=\"font-family:宋体\">或者</span>‘min’<span style=\"font-family:宋体\">，亦即</span> slider<span style=\"font-family:宋体\">的</span>value<span style=\"font-family: 宋体\">值，</span>1<span style=\"font-family:宋体\">或者</span>0<span style=\"font-family:宋体\">。</span></p><p style=\"text-indent:29px\"><strong>size</strong>: jSlider<span style=\"font-family:宋体\">的参数，包括</span>2<span style=\"font-family:宋体\">个值</span>barWidth - bar<span style=\"font-family:宋体\">的长度，</span> sliderWidth - slider<span style=\"font-family:宋体\">的长度。</span></p><p style=\"text-indent:29px\"><strong>barCssName</strong>: bar<span style=\"font-family:宋体\">的样式名称，便于</span>end-user<span style=\"font-family:宋体\">自行扩展样式。</span></p><p style=\"text-indent:29px\"><strong>completedCssName</strong>: completed<span style=\"font-family:宋体\">的样式名称。</span></p><p style=\"text-indent:29px\"><strong>sliderCssName</strong>: slider<span style=\"font-family:宋体\">的样式名称。</span></p><p style=\"text-indent:29px\"><strong>sliderHover</strong>: slider<span style=\"font-family:宋体\">聚焦时的样式名称。</span></p><p style=\"text-indent:29px\"><strong>onChanging</strong>: slider<span style=\"font-family:宋体\">被拖拽时触发的事件。</span></p><p style=\"text-indent:29px\"><strong>onChanged</strong>: slider<span style=\"font-family:宋体\">拖拽结束时触发的事件。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">此时我们需要将</span>renderTo<span style=\"font-family:宋体\">强制转换成</span>jQuery<span style=\"font-family:宋体\">对象</span>(<span style=\"font-family:宋体\">兼容使用</span>selector<span style=\"font-family:宋体\">的情况</span>)<span style=\"font-family: 宋体\">：</span></p><p style=\"text-indent:29px\">ps.renderTo&nbsp;=&nbsp;(<span style=\"color:blue\">typeof</span>&nbsp;ps.renderTo&nbsp;==&nbsp;&#39;string&#39;&nbsp;?</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(ps.renderTo)&nbsp;:&nbsp;ps.renderTo);</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">然后将</span>html tree<span style=\"font-family:宋体\">输出到</span>render:</p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:green\">/*&nbsp;----------&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:green\">html&nbsp;tree:</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:green\">&lt;div&gt;&nbsp;----&gt;sliderbar</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:green\">&lt;div&gt;&amp;nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;----&gt;&nbsp;completed&nbsp;bar</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:green\">&lt;div&gt;&amp;nbsp;&lt;/div&gt;&nbsp;&nbsp;&nbsp;----&gt;&nbsp;slider&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:green\">&lt;/div&gt;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:green\">&lt;-----------*/</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;sliderbar&nbsp;=&nbsp;$(&#39;</span><span style=\"font-size: 12px;font-family:Consolas;color:maroon\">&lt;div&gt;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;div&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;)</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.attr(</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;class&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,&nbsp;ps.barCssName)</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.css(</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;width&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,&nbsp;ps.size.barWidth)</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.appendTo(ps.renderTo);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;completedbar&nbsp;=&nbsp;sliderbar.find(&#39;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">div:eq(0)</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;)</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.attr(</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;class&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,&nbsp;ps.completedCssName);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;slider&nbsp;=&nbsp;sliderbar.find(&#39;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">div:eq(1)</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;)</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.attr(</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;class&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,&nbsp;ps.sliderCssName)</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.css(</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;width&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,&nbsp;ps.size.sliderWidth);</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">这样我们就在</span>UI<span style=\"font-family:宋体\">上直接呈现了</span>Html<span style=\"font-family:宋体\">并且用定制的</span>css<span style=\"font-family:宋体\">进行渲染，分别用</span>sliderbar, completedbar, slider<span style=\"font-family:宋体\">对我们需要的三个对象进行缓存。</span></p><p style=\"text-indent:29px\">ok, <span style=\"font-family:宋体\">在呈现了</span>UI<span style=\"font-family: 宋体\">后我们就需要提供方法来实现</span>slider<span style=\"font-family:宋体\">的拖拽，在这之前我们还需要实现一个方法，就是</span>completedbar<span style=\"font-family:宋体\">的实时更新，即在拖动</span>slider<span style=\"font-family:宋体\">的时候让</span>completedbar<span style=\"font-family:宋体\">始终填充左侧区域：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;bw&nbsp;=&nbsp;sliderbar.width(),&nbsp;sw&nbsp;=&nbsp;slider.width();</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:green\">//make&nbsp;sure&nbsp;that&nbsp;the&nbsp;slider&nbsp;was&nbsp;displayed&nbsp;in&nbsp;the&nbsp;bar(make&nbsp;a&nbsp;limited)</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">ps.limited&nbsp;=&nbsp;{&nbsp;min:&nbsp;0,&nbsp;max:&nbsp;bw&nbsp;-&nbsp;sw&nbsp;};</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">if</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;(</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">typeof</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;window.$sliderProcess&nbsp;==&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;undefined&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;window.$sliderProcess&nbsp;=&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">new</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;Function(</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;obj1&#39;,&nbsp;&#39;obj2&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;left&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">obj1.css(\\&#39;left\\&#39;,left);obj2.css(\\&#39;width\\&#39;,left);</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">$sliderProcess(slider,&nbsp;completedbar,&nbsp;eval(&#39;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">ps.limited.</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;&nbsp;+&nbsp;ps.initPosition));</span></p><p style=\"text-indent:29px\">bw,sw<span style=\"font-family:宋体\">用来存储</span>sliderbar<span style=\"font-family:宋体\">和</span>slider<span style=\"font-family:宋体\">的长度，此处没有直接使用</span>ps.size<span style=\"font-family:宋体\">里的值是为了防止样式里的</span>border-width<span style=\"font-family:宋体\">对</span>width<span style=\"font-family: 宋体\">造成破坏。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">定义一个私用成员</span>limited<span style=\"font-family:宋体\">来存储</span>slider[left]<span style=\"font-family:宋体\">的最大值和最小值，并在后面直接使用</span>eval(&#39;<span style=\"color:maroon\">ps.limited.</span>&#39;&nbsp;+&nbsp;ps.initPosition)<span style=\"font-family:宋体\">来获取，从而避免</span>switch<span style=\"font-family:宋体\">操</span> <span style=\"font-family:宋体\">作。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">同时还需定义一个全局</span>Function<span style=\"font-family:宋体\">用来定位</span>completedbar<span style=\"font-family:宋体\">的填充长度以及</span>slider<span style=\"font-family:宋体\">左侧距离，我给其命名为</span>$sliderProcess<span style=\"font-family:宋体\">。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">那么我们接下来剩下的工作就是</span>slider<span style=\"font-family:宋体\">的拖拽功能了，那么在这里我会用到之前发布的一款</span>jQuery<span style=\"font-family:宋体\">拖拽插件，并做适量的订制：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:green\">//drag&nbsp;and&nbsp;drop</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;slide&nbsp;=&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;drag:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">(e)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;d&nbsp;=&nbsp;e.data;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;l&nbsp;=&nbsp;Math.min(Math.max(e.pageX&nbsp;-&nbsp;d.pageX&nbsp;+&nbsp;d.left,&nbsp;ps.limited.min),&nbsp;ps.limited.max);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sliderProcess(slider,&nbsp;completedbar,&nbsp;l);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:green\">//push&nbsp;two&nbsp;parameters:&nbsp;1st:percentage,&nbsp;2nd:&nbsp;event</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps.onChanging(l&nbsp;/&nbsp;ps.limited.max,&nbsp;e);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;},</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;drop:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">(e)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slider.removeClass(ps.sliderHover);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:green\">//push&nbsp;two&nbsp;parameters:&nbsp;1st:percentage,&nbsp;2nd:&nbsp;event</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps.onChanged(parseInt(slider.css(</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;left&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">))&nbsp;/&nbsp;ps.limited.max,&nbsp;e);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$().unbind(</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;mousemove&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,&nbsp;slide.drag).unbind(&#39;mouseup&#39;,&nbsp;slide.drop);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">};</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">if</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;(ps.enable)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:green\">//bind&nbsp;events</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;slider.bind(</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;mousedown&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">(e)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;d&nbsp;=&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left:&nbsp;parseInt(slider.css(</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;left&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">)),</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pageX:&nbsp;e.pageX</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">this</span><span style=\"font-size: 12px;font-family: Consolas\">).addClass(ps.sliderHover);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$().bind(</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;mousemove&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,&nbsp;d,&nbsp;slide.drag).bind(</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;mouseup&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,&nbsp;d,&nbsp;slide.drop);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;});</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">这样当</span>jSlider enable<span style=\"font-family:宋体\">属性为</span>true<span style=\"font-family:宋体\">时，在</span>end-user<span style=\"font-family:宋体\">按下鼠标时绑定</span>mousemove<span style=\"font-family:宋体\">事件，在鼠标弹起时移除，我们只需要同步更新</span>slider<span style=\"font-family:宋体\">的</span>left <span style=\"font-family: 宋体\">属性和</span>completedbar<span style=\"font-family:宋体\">的</span>width<span style=\"font-family:宋体\">即可，同时在</span>drag<span style=\"font-family:宋体\">中绑定</span>onChanging<span style=\"font-family:宋体\">方法，在</span>drop<span style=\"font-family:宋体\">中绑定</span>onChanged<span style=\"font-family:宋体\">方法，向这两个方</span> <span style=\"font-family:宋体\">法推送的参数相同，</span>1&gt;<span style=\"font-family:宋体\">百分比，即</span>value<span style=\"font-family:宋体\">值，介于</span>0~1<span style=\"font-family:宋体\">，</span>2&gt;event<span style=\"font-family:宋体\">。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">那么至此我们的</span>jSlider<span style=\"font-family:宋体\">插件就基本成型，向用户提供了一个可拖拽的</span>slider<span style=\"font-family:宋体\">。</span></p><p style=\"text-indent:29px\"><strong><span style=\"font-family:宋体\">【扩展】</span></strong>&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">有的时候用户却不是那么容易满足，于是有人高呼：</span>“<span style=\"font-family:宋体\">我要自己设置</span>value<span style=\"font-family:宋体\">，为什么不提供这个功能？</span>”<span style=\"font-family:宋体\">。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">那么这时我们就需要为用户公开一个方法，用于设置</span>jSlider<span style=\"font-family:宋体\">的</span>value<span style=\"font-family:宋体\">，首先考虑的是作为方法需要一个作用对象</span>(jSlider)<span style=\"font-family:宋体\">，那么此时我又不</span> <span style=\"font-family:宋体\">想将作用对象作为参数传入，那么我们还是将这个方法作为插件来开发，我们将方法命名为</span>setSliderValue<span style=\"font-family:宋体\">，开放</span>2<span style=\"font-family:宋体\">个参数，</span>v(value<span style=\"font-family:宋体\">值</span>)<span style=\"font-family: 宋体\">和</span> callback(<span style=\"font-family:宋体\">设置完成后的回调函数</span>)<span style=\"font-family:宋体\">。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">即：</span>$.fn.setSliderValue(v,callback);</p><p style=\"text-indent:29px\">ok<span style=\"font-family:宋体\">，那么剩下的就是作用对象了，由之前的设计可知，在</span>slider<span style=\"font-family:宋体\">拖动时主要作用于</span>2<span style=\"font-family:宋体\">个对象，</span>slider<span style=\"font-family:宋体\">和</span>completedbar<span style=\"font-family:宋体\">，那么我们在</span>jSlider<span style=\"font-family:宋体\">插件末尾加上一段代码来返回</span>slider<span style=\"font-family:宋体\">对象：</span></p><p style=\"text-indent:29px\">slider.data&nbsp;=&nbsp;{&nbsp;bar:&nbsp;sliderbar,&nbsp;completed:&nbsp;completedbar&nbsp;};</p><p style=\"text-indent:29px\"><span style=\"color:blue\">return</span>&nbsp;slider;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">这样我们在初始化</span>jSlider<span style=\"font-family:宋体\">的时候就可以直接用一个变量来获取</span>jSlider<span style=\"font-family:宋体\">对象，然后调用</span>setSliderValue<span style=\"font-family:宋体\">方法了，伪码：</span></p><p style=\"text-indent:29px\"><span style=\"color:blue\">var</span>&nbsp;slider&nbsp;=&nbsp;$.fn.jSlider({<img width=\"15\" height=\"13\" src=\"/static/ueditor/themes/default/images/spacer.gif\" style=\"background:url(/static/ueditor/themes/default/images/word.gif) no-repeat center center;border:1px solid #ddd\" word_img=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image007.png\"/>});</p><p style=\"text-indent:29px\">slider.setSliderValue(v,<span style=\"color:blue\">function</span>(){});</p><p style=\"text-indent:29px\">setSliderValue<span style=\"font-family:宋体\">代码：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">try</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:green\">//validate</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">if</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;(</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">typeof</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;v&nbsp;==&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;undefined&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;||&nbsp;v&nbsp;&lt;&nbsp;0&nbsp;||&nbsp;v&nbsp;&gt;&nbsp;1)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">throw</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">new</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;Error(&#39;</span><span style=\"font-size:12px;font-family: Consolas;color:maroon\">\\&#39;v\\&#39;&nbsp;must&nbsp;be&nbsp;a&nbsp;Float&nbsp;variable&nbsp;between&nbsp;0&nbsp;and&nbsp;1.</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;s&nbsp;=&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">this</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:green\">//validate&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">if</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;(</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">typeof</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;s&nbsp;==&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;undefined&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;||</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">typeof</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;s.data&nbsp;==&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;undefined&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;||</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">typeof</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;s.data.bar&nbsp;==&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;undefined&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">throw</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">new</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;Error(&#39;</span><span style=\"font-size:12px;font-family: Consolas;color:maroon\">You&nbsp;bound&nbsp;the&nbsp;method&nbsp;to&nbsp;an&nbsp;object&nbsp;that&nbsp;is&nbsp;not&nbsp;a&nbsp;slider!</span><span style=\"font-size: 12px;font-family: Consolas\">&#39;);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;$sliderProcess(s,&nbsp;s.data.completed,&nbsp;v&nbsp;*&nbsp;s.data.bar.width());</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">if</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;(</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">typeof</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;callback&nbsp;!=&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;undefined&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">)&nbsp;{&nbsp;callback(v);&nbsp;}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">catch</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;(e)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;alert(e.message);</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">这里同样调用了全局</span>Function $sliderProcess<span style=\"font-family:宋体\">在设置</span>slider<span style=\"font-family:宋体\">的</span>value<span style=\"font-family:宋体\">值时进行</span>completedbar[width]<span style=\"font-family:宋体\">和</span>slider[left]<span style=\"font-family:宋体\">的更新。由于此</span> <span style=\"font-family:宋体\">处进行了异常处理，所以如果</span>end-user<span style=\"font-family:宋体\">在确保</span>setSliderValue<span style=\"font-family:宋体\">被作用于</span>jSlider<span style=\"font-family:宋体\">对象的时候可以删除此异常处理代</span> <span style=\"font-family:宋体\">码。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">【<strong>皮肤</strong>】</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">根据</span>jSlider<span style=\"font-family:宋体\">的</span>API<span style=\"font-family:宋体\">我们可以更加方便的为其设定皮肤，为了让</span>jSlider<span style=\"font-family:宋体\">更加专业，我们需要</span>2<span style=\"font-family:宋体\">张图片：</span></p><p style=\"margin-top:10px;margin-bottom:10px;text-indent:0;line-height:18px;background:white\"><span style=\"font-size: 12px;font-family: Consolas\"><img width=\"264\" height=\"98\" src=\"/static/ueditor/themes/default/images/spacer.gif\" style=\"background:url(/static/ueditor/lang/zh-cn/images/localimage.png) no-repeat center center;border:1px solid #ddd\" border=\"0\" word_img=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image008.gif\"/></span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">用来作为</span>completedbar<span style=\"font-family:宋体\">背景的</span>&#39;bar&#39;<span style=\"font-family:宋体\">和用来作为</span>slider<span style=\"font-family:宋体\">背景的</span>&#39;slider&#39;<span style=\"font-family:宋体\">，</span>ok<span style=\"font-family: 宋体\">，我们更新下样式：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:green\">/*----blue&nbsp;skin----*/</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:maroon\">.bluebar</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;margin-top</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;10px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;height</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;4px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;background</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">#F7F7F7</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;border</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">solid&nbsp;1px&nbsp;#3e3e3e</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;position</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;relative</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:maroon\">.bluebar&nbsp;.jquery-completed</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;height</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;4px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;background</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">url(../images/slider/blue/bar.gif)&nbsp;left&nbsp;center&nbsp;no-repeat</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;top</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;0</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;left</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">0</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;position</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;absolute</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:maroon\">.bluebar&nbsp;.jquery-jslider</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;height</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;17px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;background</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">url(../images/slider/blue/slider.gif)&nbsp;center&nbsp;0&nbsp;no-repeat</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;top</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;-4px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;display</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;block</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;cursor</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;pointer</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;position</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">&nbsp;absolute</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:maroon\">.bluebar&nbsp;.jquery-jslider-hover</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:red\">&nbsp;&nbsp;&nbsp;&nbsp;background-position</span><span style=\"font-size: 12px;font-family: Consolas\">:</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">center&nbsp;-17px</span><span style=\"font-size: 12px;font-family: Consolas\">;</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">}</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">由于在设置样式时我仍然让子节点样式使用了</span>API<span style=\"font-family:宋体\">的默认值，因此在创建</span>jSlider<span style=\"font-family:宋体\">时我们只需要设置</span><strong>barCssName</strong><span style=\"font-family:宋体\">就行了：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:blue\">var</span><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;blue&nbsp;=&nbsp;$.fn.jSlider({</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;renderTo:&nbsp;&#39;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">#slidercontainer&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;size:&nbsp;{&nbsp;barWidth:&nbsp;500,&nbsp;sliderWidth:&nbsp;10&nbsp;},</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;barCssName:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:maroon\">&#39;bluebar&#39;</span><span style=\"font-size: 12px;font-family: Consolas\">,</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;onChanging:&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">(percentage,&nbsp;e)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:green\">//&nbsp;code&nbsp;goes&nbsp;here</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">});</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">呈现出来的</span>UI:</p><p style=\"text-indent:29px\"><img width=\"530\" height=\"43\" src=\"/static/ueditor/themes/default/images/spacer.gif\" style=\"background:url(/static/ueditor/lang/zh-cn/images/localimage.png) no-repeat center center;border:1px solid #ddd\" border=\"0\" word_img=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image009.gif\"/></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">我们这样来设置其值：</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size:12px;font-family:Consolas;color:green\">//set&nbsp;percentage&nbsp;with&nbsp;a&nbsp;callback&nbsp;function</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">blue.setSliderValue(0.65,&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:blue\">function</span><span style=\"font-size: 12px;font-family: Consolas\">(percentage)&nbsp;{</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:12px;font-family:Consolas;color:green\">//&nbsp;code&nbsp;goes&nbsp;here</span></p><p style=\"text-indent:0;line-height: 18px;background:whitesmoke\"><span style=\"font-size: 12px;font-family: Consolas\">});</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">【<strong>通用性</strong>】</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">当然，我们不仅可以将</span>jSlider<span style=\"font-family:宋体\">作为</span>slider<span style=\"font-family:宋体\">使用，有时候它也是一个</span>progressbar:</p><p style=\"margin-top:10px;margin-bottom:10px;text-indent:0;line-height:18px;background:white\"><span style=\"font-size: 12px;font-family: Consolas\"><img width=\"210\" height=\"82\" src=\"/static/ueditor/themes/default/images/spacer.gif\" style=\"background:url(/static/ueditor/lang/zh-cn/images/localimage.png) no-repeat center center;border:1px solid #ddd\" border=\"0\" word_img=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image010.gif\"/></span></p><p style=\"text-indent:29px\">(<span style=\"font-family:宋体\">代码我就不贴了，直接在</span>demo<span style=\"font-family:宋体\">里查看</span> ;-) )</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">【<strong>小结</strong>】</span>&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">通篇到这里就结束了，简单的介绍了一款</span>jQuery<span style=\"font-family:宋体\">插件的开发流程，以及开发中应该注意的细节，那么在下一篇的文章中我会向大家介绍如何打造一个通用型的</span> <span style=\"font-family:宋体\">自动完成</span> <span style=\"font-family:宋体\">插件。</span></p><p style=\"margin-top:10px;margin-bottom:10px;text-indent:0;line-height:18px;background:white\"><span style=\"font-size: 12px;font-family: Consolas\"><a href=\"http://www.ajaxplaza.net/slider/slider.htm\" target=\"_blank\"><span style=\"color:#8AB459;text-underline:none\">live demo</span></a></span></p><p style=\"margin-top:10px;text-indent:0;line-height:18px;background:white\"><span style=\"font-size: 12px;font-family: Consolas\"><a href=\"http://code.google.com/p/jqueryslider/downloads/list\" target=\"_blank\"><span style=\"color:#8AB459;text-underline: none\">source[google code]</span></a></span></p><p style=\"text-indent:0;line-height: 18px;background:white\"><span style=\"font-size:12px;font-family:Consolas;color:green\">/**</span></p><p style=\"text-indent:0;line-height: 18px;background:white\"><span style=\"font-size:12px;font-family:Consolas;color:green\">&nbsp;*&nbsp;</span></p><p style=\"text-indent:0;line-height: 18px;background:white\"><span style=\"font-size:12px;font-family:Consolas;color:green\">&nbsp;* Licensed</span></p><p style=\"text-indent:0;line-height: 18px;background:white\"><span style=\"font-size:12px;font-family:Consolas;color:green\">&nbsp;* Under an Attribution, Share Alike License</span></p><p style=\"text-indent:0;line-height: 18px;background:white\"><span style=\"font-size:12px;font-family:Consolas;color:green\">&nbsp;*</span></p><p style=\"text-indent:0;line-height: 18px;background:white\"><span style=\"font-size:12px;font-family:Consolas;color:green\">&nbsp;* Copyright 2008-2014 Tjatse [ thisnamemeansnothing[at]gmail.com ]</span></p><p style=\"text-indent:0;line-height: 18px;background:white\"><span style=\"font-size:12px;font-family:Consolas;color:green\">&nbsp;*</span></p><p style=\"text-indent:6px;line-height:18px;background:white\"><span style=\"font-size:12px;font-family:Consolas;color:green\">**/</span></p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"margin: 10px auto;\"><br/></p>', ',技术,', '57', '0', '2015-10-08 21:14:42', '2015-10-08 21:27:22', '0', null, '1', null);
INSERT INTO `tb_post` VALUES ('18', '1', '我们应该尊重长者吗？', '', '', '0', '<p>“先生，我们应该尊重长者吗？”“我说，不”</p><p>校长就坐在我旁边，他说“你说什么？我们应该尊敬长者。在我们的文化中，尊敬是应该的，但是尊敬什么呢？”</p><p>“您说的这点很重要，我要告诉观众，我们的文化是这样，教孩子尊敬长者。这没错，是要尊敬，正如博士所说，尊敬他们的行为，而不是年龄。如果一个人的行为不正确，那么不管他多大岁数，都不能尊敬他，反而要去指责他。”</p>', ',思想,', '71', '0', '2015-10-09 01:07:28', '2015-10-09 01:12:13', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('19', '1', '【转】比“教女儿如何自保”更重要的', '', '', '0', '<p><span style=\"line-height: 1.5em;\">&nbsp; &nbsp; 文/翕(xi)如</span><br/></p><p>&nbsp; &nbsp; “传媒大学男生强奸女同学未遂将其杀死”，这条新闻一出，和以往任何性侵案件上了新闻一样，又出现许多“女生该如何保护自我”的文章。而每次看到这些“教女人如何自保”的文章，我都心情复杂。</p><p>&nbsp; &nbsp; 我自己还小时，就十分热爱设想，他年要是有个小女儿，我该如何教育她。如今时光一晃，这两年身边渐渐多了结婚生子的朋友，哪怕此刻并不能真正的确定，以后就想成为一个母亲，我仍然乐于琢磨：有朝一日，如果真的有了一个小女儿，有哪些话与道理，我想告诉她。</p><p>&nbsp; &nbsp; 去年暑假在南京时，和朋友吃饭，饭后逛书店，看到一本书是所谓的给女孩的人生建议。类似的书，我小时候也见过，标题类似于“给女孩的一百条忠告”，封面粉红色，隐瞒玫瑰花纹——其中那些忠告，如今基本忘光，唯有一条印象深刻：“夜间出门不要穿着过于暴露性感”。作者在写这条忠告时，还配了个小故事，说某个品学兼优的漂亮女孩，晚上出门穿着性感，被人先奸后杀。我至今连故事的细节都记得清楚——作者说她穿着性感，是红色毛线吊带黑色超短裙，而她出门，是为了给班级活动买电池。</p><p>&nbsp; &nbsp; 去年夏天在书店里，朋友和我翻了翻“给女孩的人生建议”的目录，我讲起这个童年读到的故事/忠告，然后万分矛盾地说，如果有了女儿，我会告诉建议她夜间独自出门不要穿着过于暴露吗？</p><p>&nbsp; &nbsp; 去年夏天，我自问自答地极其纠结，当时觉得，立足于眼下的社会环境，设身处地的站在一个母亲的立场上想，或许一定会——即便这听上去近似一种可疑的“谴责受害者”逻辑，即便很多时候，性侵犯和“穿什么样，长什么样、做了什么”并没有任何关系。可是面对想象中的女儿，与这个并不符合想象的世界，母亲总是想将发生危险的可能再降低一点。所以不仅如此，我或许还会教她哪些“自保”方式是有效的（比如一般来说，我不觉得带着武器一定管用——特别是，歹徒很有可能将你的水果刀胡椒粉用在你身上）——当然，即便如此，假如她不幸受到任何伤害，我一定也不会说“谁让你不保护好自己”这话，不会让她觉得自己该负任何责任。</p><p>&nbsp; &nbsp; 可是说完，还是觉得少了点什么。我们的社会舆论家庭教育观念，似乎从来不缺少对女儿如何避免危险、如何自我保护的教育，也从不缺少对“没有保护好自己”的谴责批评事后诸葛亮，然而成问题的恰恰在于，当我们将重心一味地放在“教女儿如何避免性侵会吃亏。”）</p><p>&nbsp; &nbsp; BBC纪录片《印度的女儿》中，一位当年的凶手在接受采访时说，“她不应该反抗，她要是不反抗，就不会死”——《印度的女儿》在印度被禁，之后，在由这部纪录片引起的女权/人权抗议示威中，有这样一条标语“别教我女儿该穿什么，教你的儿子别去强奸。”</p><p><br/></p>', ',思想,', '56', '0', '2015-10-09 01:18:16', '2015-10-09 01:18:39', '0', null, '1', null);
INSERT INTO `tb_post` VALUES ('20', '1', 'geohash实现(c语言)', '', '', '0', '<p style=\"margin-top:auto;margin-bottom:auto;text-indent:28px;line-height:26px;background:white\"><strong><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">GeoHash算法简介</span></strong></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:28px;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">首先，你要Baidu下，找到该算法核心原理，这里摘自网络文档，简单介绍下。<br/></span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">GeoHash算法是通过二分法，经过一定次数的无限逼近，将经纬度的二维坐标浮点值变成一个可排序、可比较的的字符串编码。</span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">在编码中的每个字符代表一个区域，并且前面的字符是后面字符的父区域，即父子字符串有相同的前缀。其算法的过程如下：</span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">地球纬度区间是[-90,90]， 如某纬度是39.92324，可以通过下面算法对39.92324进行逼近编码:</span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">1）区间[-90,90]进行二分为[-90,0),[0,90]，称为左右区间，可以确定39.92324属于右区间[0,90]，给标记为1；</span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">2）接着将区间[0,90]进行二分为 [0,45),[45,90]，可以确定39.92324属于左区间 [0,45)，给标记为0；</span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">3）递归上述过程39.92324总是属于某个区间[a,b]。随着每次迭代区间[a,b]总在缩小，并越来越逼近39.928167；</span></p><p><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">4）如果给定的纬度（39.92324）属于左区间，则记录0，如果属于右区间则记录1，这样随着算法的进行会产生一个序列1011 1000 1100 01111001，序列的长度跟给定的区间划分次数有关。</span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\"><img src=\"/static/upload/bigpic/20151027/1445915589633127061.png\"/></span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">同理，地球经度区间是</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">[-180,180]</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">，对经度</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">116.3906</span><span style=\"font-size:14px;font-family: 宋体;color:#362E2B\">进行编码的过程也类似：</span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family: 宋体;color:#362E2B\"><img src=\"/static/upload/bigpic/20151027/1445915619033198681.png\"/></span></p><p style=\"text-indent:0;background: white\"><span style=\"color: rgb(54, 46, 43); font-family: 宋体; line-height: 26px;\">组码</span><br/></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">通过上述计算，纬度产生的编码为</span><span style=\"font-size: 14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">1011 1000 1100 0111 1001</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">，经度产生的编码为</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">1101 00101100 0100 0100</span><span style=\"font-size:14px;font-family: 宋体;color:#362E2B\">。奇数位放纬度，偶数位放经度，相互穿插，把</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">2</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">条串编码组合生成新串：</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">1</span><span style=\"font-size: 14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">1</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:red\">0</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#00B0F0\">1</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">。</span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">最后使用用</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">0-9</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">、</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">b-z</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">（去掉</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">a, i, l, o</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">）这</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">32</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">个字母进行</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">base32</span><span style=\"font-size:14px;font-family: 宋体;color:#362E2B\">编码，不会</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">base32</span><span style=\"font-size:14px;font-family: 宋体;color:#362E2B\">的网上搜搜。首先将</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">1110011101 00100 01111 00000 01101 01011 00001</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">转成十进制</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\"> 28</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">，</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">29</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">，</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">4</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">，</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">15</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">，</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">0</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">，</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">13</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">，</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">11</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">，</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">1</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">，十进制对应的编码就是</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">wx4g0ec1</span><span style=\"font-size:14px;font-family: 宋体;color:#362E2B\">。同理，将编码转换成经纬度的解码算法与之相反，具体不再赘述。</span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family: 宋体;color:#362E2B\"><img src=\"/static/upload/bigpic/20151027/1445915653824211920.png\"/></span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">由上可知，字符串越长，表示的范围越精确。当</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">GeoHash base32</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">编码长度为</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">8</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">时，精度在</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">19</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">米左右，而当编码长度为</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">9</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">时，精度在</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">2</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">米左右，编码长度需要根据数据情况进行选择。不过从</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">GeoHash</span><span style=\"font-size:14px;font-family: 宋体;color:#362E2B\">的编码算法中可以看出它的一个缺点，位于边界两侧的两点，虽然十分接近，但编码会完全不同。实际应用中，可以同时搜索该点所在区域的其他八个区域的点，即可解决这个问题。</span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:0;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">&nbsp;</span></p><p style=\"margin-top:auto;margin-bottom:auto;text-indent:28px;line-height:26px;background:white\"><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">以上原理部分是我从网路上摘录的，以下是我的</span><span style=\"font-size:14px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#362E2B\">c</span><span style=\"font-size:14px;font-family:宋体;color:#362E2B\">实现方法：</span></p><p style=\"text-indent:0;background: white\"><span style=\"font-size:13px;line-height:150%;font-family: &#39;Courier New&#39;;color:teal\">/**</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* C</span><span style=\"font-size: 13px;font-family:宋体;color:teal\">语言实现版本</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#804000\">#include<stdio.h></stdio.h></span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#804000\">#define BASE32 &quot;0123456789bcdefghjkmnpqrstuvwxyz&quot;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">把</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">ASCII</span><span style=\"font-size:13px;font-family:宋体;color:green\">码表搬下来，去掉我们不用的字符，将解码要用的下标转换如下</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">static</span> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> UNBASE32</span><strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">[]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">={</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">3</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">4</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">5</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">6</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">7</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">8</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">9</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">10</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">11</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">12</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">13</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">14</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">15</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">16</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">17</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">18</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">19</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">20</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">21</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">22</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">23</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">24</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">25</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">26</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">27</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">28</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">29</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">30</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">31</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">};</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">/**</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param latitude </span><span style=\"font-size:13px;font-family:宋体;color:teal\">纬度</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param longitude </span><span style=\"font-size:13px;font-family:宋体;color:teal\">经度</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param precision </span><span style=\"font-size:13px;font-family:宋体;color:teal\">字符编码结果的长度（精度）</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param geohash </span><span style=\"font-size:13px;font-family:宋体;color:teal\">编码结果</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">void</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> geohash_encode</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">double</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> latitude</span><strong><span style=\"font-size:13px;font-family: &#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">double</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> longitude</span><strong><span style=\"font-size:13px;font-family: &#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> precision</span><strong><span style=\"font-size:13px;font-family: &#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">char</span> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">geohash</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">char</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> is_odd </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">是否奇数标志，</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">1</span><span style=\"font-size:13px;font-family:宋体;color:green\">奇数</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\"> 0</span><span style=\"font-size:13px;font-family:宋体;color:green\">偶数</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">编码计数</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">double</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">];</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">纬度，</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">lats[0]</span><span style=\"font-size:13px;font-family:宋体;color:green\">当前查找区间的左边界，最小值；</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">lats[1]</span><span style=\"font-size:13px;font-family:宋体;color:green\">当前查找范围的右边界，最大值；</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">double</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">];</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">经度，</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">lons[0]</span><span style=\"font-size:13px;font-family:宋体;color:green\">当前查找区间的左边界，最小值；</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">lons[1]</span><span style=\"font-size:13px;font-family:宋体;color:green\">当前查找范围的右边界，最大值；</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">double</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">对当前查找区间向左或向右折半后，新的边界值。</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">char</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> bits</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[]</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0x10</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0x08</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0x04</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0x02</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0x01</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">};</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">用二进制表示，依次为</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\"> {00010000,00001000,00000100,00000010,00000001}</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> bit </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//bits</span><span style=\"font-size:13px;font-family: 宋体;color:green\">的下标</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">char</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> tmp </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">每计算满</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">5</span><span style=\"font-size:13px;font-family:宋体;color:green\">位二进制位后，进行一次</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">Base32</span><span style=\"font-size:13px;font-family: 宋体;color:green\">编码，然后清零重复计算。这个值就是临时存储</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">5</span><span style=\"font-size:13px;font-family:宋体;color:green\">位二进制中间值的。</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">初始化，将查找区间设为最大。</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">90.0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">90.0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">180.0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">180.0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">while</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;&lt; span=&quot;&quot;&gt;<!--<--><!--<--><!--<--><!--<--><!--<--></span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> precision</span><strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">is_odd</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">奇数，处理纬度</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mid </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">])</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">/</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">latitude </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&gt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tmp </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">|=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> bits</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">bit</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">];</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">else</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:blue\">else</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">偶数，处理经度</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mid </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">])</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">/</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">longitude </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&gt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">落在右侧</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tmp </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">|=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> bits</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">bit</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">];</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">求</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">“</span><span style=\"font-size:13px;font-family:宋体;color:green\">或</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">”</span><span style=\"font-size:13px;font-family:宋体;color:green\">运算，实际是给第</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">i</span><span style=\"font-size:13px;font-family:宋体;color:green\">位赋值</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">“1”</span><span style=\"font-size:13px;font-family:宋体;color:green\">。</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">else</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">落在左侧，给第</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">i</span><span style=\"font-size:13px;font-family:宋体;color:green\">位赋值</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">“0”</span><span style=\"font-size:13px;font-family:宋体;color:green\">，由于初始化就是</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">0</span><span style=\"font-size:13px;font-family:宋体;color:green\">，所以这里不用操作了。</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is_odd </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">!</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">is_odd</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">取反</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">bit </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;&lt; span=&quot;&quot;&gt;<!--<--><!--<--><!--<--><!--<--><!--<--></span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">4</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bit</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">else</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">满</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">4bit</span><span style=\"font-size:13px;font-family:宋体;color:green\">，进行</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">base32</span><span style=\"font-size:13px;font-family:宋体;color:green\">编码，然后对中间值清零</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;geohash</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">++]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> BASE32</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">tmp</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">];</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">进行</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">Base32</span><span style=\"font-size:13px;font-family:宋体;color:green\">编码</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bit </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tmp </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; geohash</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">最后一位置</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">0</span><span style=\"font-size:13px;font-family:宋体;color:green\">，数组结束标志</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">二分查找</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> find</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">char</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> c</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> start </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> end </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">31</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">15</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">for</span></strong><strong><span style=\"font-size:13px;font-family: &#39;Courier New&#39;;color:navy\">(;;){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">二分查找</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;mid </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">start </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> end</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">/</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">BASE32</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">==</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> c </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">||</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> start </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&gt;=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> end</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:blue\">else</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">c </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;&lt; span=&quot;&quot;&gt;<!--<--><!--<--><!--<--><!--<--><!--<--></span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> BASE32</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">左侧</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:blue\">else</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; start </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">右侧</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">void</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> geohash_decode</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">double</span> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">latitude</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">double</span> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">longitude</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">precision</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">const</span> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">char</span> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">geohash</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">char</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> is_even </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">char</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> index </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">char</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> tmp1 </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> bit </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">double</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">];</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">double</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">];</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">double</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">char</span> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">p </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> geohash</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">precision </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp; &nbsp;lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">90.0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">90.0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">180.0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">180.0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">while</span></strong><strong><span style=\"font-size:13px;font-family: &#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">!=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">p</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bit </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//index = find(*p);</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> UNBASE32</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[(*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">p </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&#39;0&#39;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)];</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">while</span></strong><strong><span style=\"font-size:13px;font-family: &#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">bit</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;&lt; span=&quot;&quot;&gt;<!--<--><!--<--><!--<--><!--<--><!--<--></span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">5</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tmp1 </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">index </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&gt;&gt;</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">4</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">bit</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">))</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&amp;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0x01</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">将结果右移到最低位，和</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">1</span><span style=\"font-size:13px;font-family:宋体;color:green\">求</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">“</span><span style=\"font-size:13px;font-family:宋体;color:green\">与</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">”</span><span style=\"font-size:13px;font-family:宋体;color:green\">后，取出值</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">is_even</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mid </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">])</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">/</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">tmp1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">右区间</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">else</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">else</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mid </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">])</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">/</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">tmp1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">else</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mid</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; is_even </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">!</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">is_even</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bit</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//printf(&quot;%d %c [%f,%f %f,%f]\\n&quot;, index, *p, lats[0], lats[1], lons[0], lons[1]);</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">precision</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)++;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">latitude </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> lats</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">])</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">/</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">longitude </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> lons</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">])</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">/</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> main</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">double</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> latitude </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">39.909605</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">double</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> longitude </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">116.397228</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> precision </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">5</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">char</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> geohash</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">20</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">];</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; geohash_encode</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">latitude</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> longitude</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> precision</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> geohash</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;[%f,%f] </span><span style=\"font-size:13px;font-family:宋体;color:gray\">编码结果</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:gray\">:%s\\n&quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> latitude</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> longitude</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> geohash</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; latitude </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; longitude </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; precision </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; geohash_decode</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(&amp;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">latitude</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&amp;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">longitude</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&amp;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">precision</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> geohash</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;%s </span><span style=\"font-size:13px;font-family:宋体;color:gray\">解码结果</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:gray\">:[%f,%f] %d\\n&quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> geohash</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> latitude</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> longitude</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> precision</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">执行结果：</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">经度为</span>5<span style=\"font-family:宋体\">的时候</span></p><p style=\"text-indent:29px\"><span style=\"background:#D9D9D9\">[<span style=\"color:#00B0F0\">39.9</span>09605,<span style=\"color:#00B0F0\">116.3</span>97228] </span><span style=\"font-family:宋体;background:#D9D9D9\">编码结果</span><span style=\"background:#D9D9D9\">:wx4g0</span></p><p style=\"text-indent:29px\"><span style=\"background:#D9D9D9\">wx4g0 </span><span style=\"font-family:宋体;background:#D9D9D9\">解码结果</span><span style=\"background:#D9D9D9\">:[<span style=\"color:#00B0F0\">39.9</span>24316,<span style=\"color:#00B0F0\">116.3</span>89160] 5</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">经度为</span>10<span style=\"font-family:宋体\">的时候</span></p><p style=\"text-indent:29px\"><span style=\"background:#D9D9D9\">[<span style=\"color:#00B050\">39.90960</span>5,<span style=\"color:#00B050\">116.39722</span>8] </span><span style=\"font-family:宋体;background:#D9D9D9\">编码结果</span><span style=\"background:#D9D9D9\">:wx4g09mf7c</span></p><p style=\"text-indent:29px\"><span style=\"background:#D9D9D9\">wx4g09mf7c </span><span style=\"font-family:宋体;background:#D9D9D9\">解码结果</span><span style=\"background:#D9D9D9\">:[<span style=\"color:#00B050\">39.90960</span>4,<span style=\"color:#00B050\">116.39722</span>3] 10</span></p><p><span style=\"font-size:15px;line-height:150%;font-family:宋体\">经过对比，明显能看出精度为</span><span style=\"font-size:15px;line-height:150%;font-family:&#39;Times New Roman&#39;,&#39;serif&#39;\">10</span><span style=\"font-size:15px;line-height:150%;font-family:宋体\">的时候，解码的结果更接近原始经纬度值。</span></p><p><br/></p>', ',技术,', '189', '0', '2015-10-27 11:06:21', '2015-11-05 14:04:54', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('21', '1', '排列组合(C语言实现)', '', '', '0', '<p>C语言，采用递归调用的方式实现排列和组合，代码如下</p><p>#include &lt;stdio.h&gt;</p><p>#include &lt;stdlib.h&gt;</p><p><br/></p><p>int array[] = {1,2,3,4};</p><p><br/></p><p>#define N &nbsp;4</p><p>#define M &nbsp;3</p><p>int queue[N] = {0}; //保存已经找到的结果，前缀</p><p>int top = 0; //队列顶部下标</p><p>int flag[N] = {0}; //是否已经排列过了的标志</p><p><br/></p><p>/**</p><p>&nbsp;* 排列</p><p>&nbsp;* @param s 递归深度</p><p>&nbsp;* @param n 数组最大长度</p><p>&nbsp;*/</p><p>void perm(int s, int n)</p><p>{</p><p>&nbsp; &nbsp; int i;</p><p>&nbsp; &nbsp; if (s &gt; n) // 越界递归结束</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; return;</p><p>&nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; if (s == n) // 找到结果，打印，递归结束</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for (i = 0; i &lt; n; i++)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;%d&quot;, queue[i]);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;\\t&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; return ;</p><p>&nbsp; &nbsp; }</p><p><br/></p><p>&nbsp; &nbsp; for (i = 0; i &lt; n; i++)</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if (flag[i] == 0)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flag[i] = 1;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; queue[s] = array[i];</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; perm(s+1, n);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flag[i] = 0;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; }</p><p>}</p><p><br/></p><p>/**</p><p>&nbsp;* 组合</p><p>&nbsp;* @param s 递归深度</p><p>&nbsp;* @param n 数组最大长度</p><p>&nbsp;* @param m 需要的组合长度</p><p>&nbsp;*/</p><p>void comb(int s, int n, int m)</p><p>{</p><p>&nbsp; &nbsp; int i = 0;</p><p>&nbsp; &nbsp; if (s &gt; n) // 越界递归结束</p><p>&nbsp; &nbsp; &nbsp; &nbsp; return ;</p><p>&nbsp; &nbsp; if (top == m) // 找到结果，打印，递归结束</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for (i = 0; i &lt; m; i++)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;%d&quot;, queue[i]);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;\\t&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; return ;</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; queue[top++] = array[s];</p><p>&nbsp; &nbsp; comb(s+1, n, m); //向下一级递归</p><p>&nbsp; &nbsp; top--;</p><p>&nbsp; &nbsp; comb(s+1, n, m); //向下一级递归</p><p>}</p><p><br/></p><p>int main()</p><p>{</p><p>&nbsp; &nbsp; int i = 0;</p><p>&nbsp; &nbsp; printf(&quot;全排列:\\n&quot;);</p><p>&nbsp; &nbsp; perm(0, N);</p><p>&nbsp; &nbsp; printf(&quot;\\n1~%d的所有组合:\\n&quot;, N);</p><p>&nbsp; &nbsp; for(i=1; i&lt;=N; i++){</p><p>&nbsp; &nbsp; &nbsp; &nbsp; comb(0, N, i);</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; printf(&quot;\\n&quot;);</p><p>&nbsp; &nbsp; return 0;</p><p>}</p><p style=\"text-indent: 0px; background: white;\"><span style=\"text-indent: 29px; font-size: 13px; line-height: normal;\"><span style=\"color:#000080;font-family:Courier New\"><strong>结果:</strong></span></span></p><p style=\"text-indent: 0px; background: white;\"><span style=\"text-indent: 29px; font-size: 13px; line-height: normal;\"><span style=\"color:#000080;font-family:Courier New\"></span></span></p><p>全排列:</p><p>1234 &nbsp; &nbsp;1243 &nbsp; &nbsp;1324 &nbsp; &nbsp;1342 &nbsp; &nbsp;1423 &nbsp; &nbsp;1432 &nbsp; &nbsp;2134 &nbsp; &nbsp;2143 &nbsp; &nbsp;2314 &nbsp; &nbsp;2341 &nbsp; &nbsp;2413 &nbsp; &nbsp;2431 &nbsp; &nbsp;3124 &nbsp; &nbsp;3142 &nbsp; &nbsp;3214 &nbsp; &nbsp;3241 &nbsp; 3412 &nbsp; &nbsp; 3421 &nbsp; &nbsp;4123 &nbsp; &nbsp;4132 &nbsp; &nbsp;4213 &nbsp; &nbsp;4231 &nbsp; &nbsp;4312 &nbsp; &nbsp;4321</p><p>1~4的所有组合:</p><p>1 &nbsp; &nbsp; &nbsp; 2 &nbsp; &nbsp; &nbsp; 3 &nbsp; &nbsp; &nbsp; 4 &nbsp; &nbsp; &nbsp; 12 &nbsp; &nbsp; &nbsp;13 &nbsp; &nbsp; &nbsp;14 &nbsp; &nbsp; &nbsp;23 &nbsp; &nbsp; &nbsp;24 &nbsp; &nbsp; &nbsp;34 &nbsp; &nbsp; &nbsp;123 &nbsp; &nbsp; 124 &nbsp; &nbsp; 134 &nbsp; &nbsp; 234 &nbsp; &nbsp; 1234</p><p style=\"text-indent: 0px; background: white;\"><span style=\"text-indent: 29px; font-size: 13px; line-height: normal;\"><span style=\"color:#000080;font-family:Courier New\"><strong><br/></strong></span></span><br/></p>', ',技术,', '43', '0', '2015-10-28 20:11:39', '2015-10-28 23:22:09', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('22', '1', '神奇的求平方根的代码', '', '', '0', '<p><span style=\"line-height: 1.5em;\">/*</span><br/></p><p>神奇的求平方根的代码</p><p><br/></p><p>转载：http://www.vimer.cn?p=334</p><p>有人在Quake III的源代码里面发现这么一段用来求平方根的代码。0×5f3759df？ 这是个什么东西？ 学过数值分析就知道，算法里面求平方根一般采用的是无限逼近的方法，比如牛顿迭代法，抱歉当年我数值分析学的太烂，也讲不清楚。简单来说比如求5的平方根，选一个猜测值比如2，那么我们可以这么算：</p><p>&nbsp;5/2 = 2.5; 2.5+2/2 = 2.25; 5/2.25 = xxx; 2.25+xxx/2 = xxxx …</p><p>这样反复迭代下去，结果必定收敛于sqrt(5)，没错，一般的求平方根都是这么算的。而卡马克的不同之处在于，他选择了一个神秘的猜测值 0×5f3759df作为起始，使得整个逼近过程收敛速度暴涨，对于Quake III所要求的精度10的负三次方，只需要一次迭代就能够得到结果。普渡大学的数学家Chris Lomont看了以后觉得有趣，决定要研究一下卡马克弄出来的这个猜测值有什么奥秘。Lomont也是个牛人，在精心研究之后从理论上也推导出一个最佳猜 测值，和卡马克的数字非常接近, 0×5f37642f。卡马克真牛，他是外星人吗？传奇并没有在这里结束。Lomont计算出结果以后非常满意，于是拿自己计算出的起始值和卡马克的神秘 数字做比赛，看看谁的数字能够更快更精确的求得平方根。结果是卡马克赢了… 谁也不知道卡马克是怎么找到这个数字的。最后Lomont怒了，采用暴力方法一个数字一个数字试过来，终于找到一个比卡马克数字要好上那么一丁点的数字， 虽然实际上这两个数字所产生的结果非常近似，这个暴力得出的数字是0×5f375a86。</p><p>*/</p><p>#include &lt;stdio.h&gt;</p><p><br/></p><p>/*================SquareRootFloat================*/</p><p>float SquareRootFloat(float number)</p><p>{</p><p>&nbsp; &nbsp; long i;</p><p>&nbsp; &nbsp; float x, y;</p><p>&nbsp; &nbsp; const float f = 1.5F;</p><p>&nbsp; &nbsp; x = number * 0.5F;</p><p>&nbsp; &nbsp; y = number;</p><p>&nbsp; &nbsp; i = * ( long * ) &amp;y;</p><p>&nbsp; &nbsp; i = 0x5f3759df - ( i &gt;&gt; 1 ); // 注意这一行</p><p>&nbsp; &nbsp; y = * ( float * ) &amp;i; y = y * ( f - ( x * y * y ) );</p><p>&nbsp; &nbsp; y = y * ( f - ( x * y * y ) );</p><p>&nbsp; &nbsp; return number * y;</p><p>}</p><p>/*===============================================*/</p><p><br/></p><p>int main()</p><p>{</p><p>&nbsp; &nbsp; printf(&quot;%f\\n&quot;, SquareRootFloat(5));</p><p>&nbsp; &nbsp; return 0;</p><p>}</p><p><br/></p>', ',技术,', '98', '0', '2015-10-30 11:37:41', '2015-10-30 11:42:12', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('23', '1', '【转】小白鼠喝毒水问题-海明码', '', '', '0', '<span id=\"_baidu_bookmark_start_2\" style=\"display: none; line-height: 0px;\"><span style=\"line-height: 0px;\">﻿</span>‍</span><span id=\"_baidu_bookmark_start_5\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_8\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_11\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_14\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_17\" style=\"display: none; line-height: 0px;\">‍</span><p><span id=\"_baidu_bookmark_start_1\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_4\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_7\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_10\" style=\"display: none; line-height: 0px;\">‍</span></p><p>&nbsp; &nbsp; 有1000瓶水，其中有一瓶有毒，小白鼠只要尝一点带毒的水24小时后就会死亡，至少要多少只小白鼠才能在24小时时鉴别出哪瓶水有毒？</p><p>&nbsp; &nbsp; 这是一道很经典的面试题目，先说解题方法吧，2^n &gt;= 1000,其中n就是小白鼠的数量。如果知道答案了，也许很多人就恍然大雾，当然有些专业的人士用下面的归纳法证明了下：</p><p>1）当n=1时，即有2瓶水，任取一瓶水喂老鼠，若24小时后老鼠死，则此瓶水有毒；若24小时后老鼠没死，则此瓶水无毒，另一瓶水有毒。课件只需一个老鼠即可判断出哪瓶有毒。即当n=1时命题成立。</p><p>2）假设当n=k(k&gt;1)时，命题为真。即须k只老鼠即可判断出哪瓶水有毒。</p><p>&nbsp; &nbsp;则当n=k+1时，即有2^(n+1)瓶水。</p><p>&nbsp; &nbsp;将水分成2组，命名为P1和P2，每组2^n瓶水.</p><p>&nbsp; &nbsp;则这两组瓶中有一组全没毒，另一组中有仅一瓶有毒。</p><p>&nbsp; &nbsp;a) 取1只老鼠、任取一组瓶子，假设取的是P1，将P1中的全部瓶子水都让老鼠尝一下。则24小时后可以根据此老鼠的生死情况判断毒药在哪一组。</p><p>&nbsp; &nbsp;b) 取k只老鼠，根据假设可知当n=k时，可判断哪瓶水有毒。用这k只老鼠同时去检测P1和P2，则24小时后可挑出P1中的某一瓶和P2中的某一瓶，这两瓶可能有毒。</p><p>&nbsp; &nbsp;根据a、b中的结果综合分析，可得知毒药瓶是哪一个。</p><p>&nbsp; &nbsp;即当n=k+1时，命题为真。</p><p>命题得证。</p><p><br/></p><p>这个证明应该是没问题，但是我很感兴趣的就是，如何猜出来这个命题的哪？我就说下这个过程吧，来检测瓶中的水有没有毒，只能靠小白鼠死没死亡来判断，也就是2种状态，这里1表示死亡，0表示存活。那么10个小白鼠，那么可以表示2^10（代表10次方）种状态，也就是1024。那么这1024种状态能不能对应出那瓶水有毒那，如果可以这个题目就解决了。看到这里，又回到了上面的证明，这个归纳法明显可以证明，此猜想没问题。由此归纳法可以看出，此问题符合算法中的，动态规划法，也就是该问题可以分解成更小的问题，1000（也就是1024瓶以内）瓶水给10个老鼠喝，512（512瓶水以内）瓶水给9个老鼠喝...以此类推，平且每个大问题的子问题，还跟这个大问题有关系，由数学归纳法证明的第二步，可以看出，通过子问题的解决，更大的问题带入到步骤2中就可以解决了。</p><p>以上步骤说了半天都是，说明此方法是正确的，可证明的。但是如果要问怎么安排老鼠喝水，才能判断那瓶有毒那？也就是把这个动态规划的算法如何来实现。其实改归纳法证明中的第二步骤中的b)后面的内容，已经透露出了运用的实现方法。也就是把有所有的水给某一个老鼠M10喝，剩下的老鼠喝的水都不能包含M10喝的那瓶毒水，那么如果M10死亡了，剩下的都活着，就检查出来毒水了。以此类推老鼠M9喝的水肯定包含一瓶其他老鼠都没喝过的，这样才能检查出这瓶水有毒。这样我们就可以得出下面的结论：</p><p>1 表示死亡 0 表示存活</p><p>0000000001 &nbsp; &nbsp; &nbsp;M1喝了第一瓶的水，其他老鼠都没喝，那么M1老鼠死亡，其他没死推断出第1瓶水有毒</p><p>0000000010 &nbsp; &nbsp; &nbsp;M2喝了第二瓶的水，其他老鼠都没喝，那么M2老鼠死亡，其他没死推断出第2瓶水有毒</p><p>0000000100 &nbsp; &nbsp; &nbsp;M3喝了第4（2^2）瓶的水，其他老鼠都没喝，那么M3老鼠死亡，其他没死推断出第4(2^2)瓶水有毒</p><p>......</p><p>这里开始有疑问了，那么从第2---第4瓶水，中间的那瓶水有毒如何推断那？这里就用到一个方法叫组合。11代表第3瓶水有毒，也就是M1和M2必须同时喝第三瓶水，而M3不能喝，那么M1和M2死，M3没死就可以得出第三瓶水有毒。下面的各瓶水的判断，都快可以依据这个理论类推，根据上面数学归纳的证明，应该可以判断出来所有的剩余的水。这里可以发现一个显而易见的规律，M1老鼠所有奇数位置的水都得喝，因为M1老鼠可以测试有毒瓶子的位置为xxxxxxxxx1 (x代表未知)，换成10进制必须包含一个2^0也就是1，那显然是奇数。只有这样才能组合出水的位置，从刚才第三瓶水的判断也可以看出。M2老鼠喝水当然也有规律了，xxxxxxxx1x，换成10进制必须包含2^1也就是2，根据2进制转换成10进制的算法，我们看下面的数字，4号瓶子(100)2=(4)10==2^2 ,3号瓶 (11)2=(3)10=2^1 + 2^0 , 2号瓶(10)2=(2)10= 2^1 , 1号瓶(1)2=(1)10=2^0。其中3就包含了2^1方，也就是3号瓶子的水，M2必须喝，根据这个方法(101)2=(5)10=2^2 + 2^0那么5号M2就不用喝，我们总结下就可以看出，其实M2如果换成10进制的话，每隔2个位置就需要M2喝，也就是6，8，10，12...都需要。那么M3那同理根据这个推算方式，每隔4个位置就需要M3喝，也就是4，8，12...。至此所有的老鼠应该喝的水所在的瓶子的位置都判断出来了。</p><p>上面的方法，讲完后，如果你学习过计算机网络中海明码的编码规则，那你岂不是就恍然大悟了。这不就是海明码的编码规则么？下面我们就对比下海明码的编码规则：</p><h2 style=\"line-height: 26px;background: white\"><span style=\"font-family:华文行楷;color:#333333\">下面看如何计算海明码</span><span style=\"font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333\">(Hamming Code )</span></h2><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">海明码</span>(Hamming Code )<span style=\"font-family:宋体\">编码的关键是使用多余的奇偶校验位来识别一位错误。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">码字</span>(Code Word)&nbsp;<span style=\"font-family:宋体\">按如下方法构建：</span></p><p style=\"text-indent:29px\">1<span style=\"font-family:宋体\">、把所有</span>2<span style=\"font-family: 宋体\">的幂次方的数据位标记为奇偶校验位</span>(<span style=\"font-family:宋体\">编号为</span>1, 2, 4, 8, 16, 32, 64<span style=\"font-family:宋体\">等的位置</span>)<span style=\"font-family:宋体\">，如</span><span style=\"color:red\">10</span>1<span style=\"color:red\">1</span>011<span style=\"color:red\">1</span>0101101<span style=\"color:red\">1</span>10…<span style=\"font-family: 宋体\">，从左往右，标红的是对应的校验位</span></p><p style=\"text-indent:29px\">2<span style=\"font-family:宋体\">、其他数据位用于待编码数据</span>. (<span style=\"font-family:宋体\">编号为</span>3, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 17<span style=\"font-family:宋体\">等的位置</span>)</p><p style=\"text-indent:29px\">3<span style=\"font-family:宋体\">、每个奇偶校验位的值代表了代码字中部分数据位的奇偶性，其所在位置决定了要校验和跳过的比特位顺序。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">位置</span>1<span style=\"font-family:宋体\">：校验</span>1<span style=\"font-family:宋体\">位，跳过</span>1<span style=\"font-family: 宋体\">位，校验</span>1<span style=\"font-family:宋体\">位，跳过</span>1<span style=\"font-family:宋体\">位</span>(1,3,5,7,9,11,13,15,…) &nbsp;&nbsp;<span style=\"font-family:宋体;color:red\">这里和老鼠和水的位置是不是一样的</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">位置</span>2<span style=\"font-family:宋体\">：校验</span>2<span style=\"font-family:宋体\">位，跳过</span>2<span style=\"font-family: 宋体\">位，校验</span>2<span style=\"font-family:宋体\">位，跳过</span>2<span style=\"font-family:宋体\">位</span>&nbsp;(<span style=\"color:#00B0F0\">2,3</span>,6,7,<span style=\"color:#00B0F0\">10,11</span>,14,15,…)</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">位置</span>4<span style=\"font-family:宋体\">：校验</span>4<span style=\"font-family:宋体\">位，跳过</span>4<span style=\"font-family: 宋体\">位，校验</span>4<span style=\"font-family:宋体\">位，跳过</span>4<span style=\"font-family:宋体\">位</span>(<span style=\"color:#00B0F0\">4,5,6,7</span>,12,13,14,15,<span style=\"color:#00B0F0\">20,21,22,23</span>,…)</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">位置</span>8<span style=\"font-family:宋体\">：校验</span>8<span style=\"font-family:宋体\">位，跳过</span>8<span style=\"font-family: 宋体\">位，校验</span>8<span style=\"font-family:宋体\">位，跳过</span>8<span style=\"font-family:宋体\">位</span>(8-15,24-31,40-47,…)</p><p style=\"text-indent:29px\">…</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">如果全部校验的位置中有奇数个</span>1<span style=\"font-family:宋体\">，把该奇偶校验位置为</span>1<span style=\"font-family:宋体\">；如果全部校验的位置中有偶数个</span>1<span style=\"font-family:宋体\">，把该奇偶校验位置为</span>0.</p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">举例说明：</span></p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">一个字节的数据：</span>10011010</p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">构造数据字</span>(Data Word),<span style=\"font-family:宋体\">对应的校验位留空</span>_ _ 1 _ 0 0 1 _ 1 0 1 0</p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">计算每个校验位的奇偶性</span>&nbsp;( ?<span style=\"font-family:宋体\">代表要设置的比特位</span>):</p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">位置</span>1<span style=\"font-family:宋体\">检查</span>1,3,5,7,9,11:</p><p style=\"text-indent: 29px\">? _&nbsp;<span style=\"color:#FF6600\">1</span>&nbsp;_&nbsp;<span style=\"color:#FF6600\">0</span>&nbsp;0&nbsp;<span style=\"color:#FF9900\">1</span>&nbsp;_&nbsp;<span style=\"color:#FF9900\">1</span>&nbsp;0&nbsp;<span style=\"color:#FF9900\">1</span>&nbsp;0.&nbsp;<span style=\"font-family: 宋体\">偶数个</span>1<span style=\"font-family:宋体\">，因此位置</span>1<span style=\"font-family:宋体\">设为</span>0<span style=\"font-family:宋体\">，即</span>: 0 _ 1 _ 0 0 1 _ 1 0 1 0</p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">位置</span>2<span style=\"font-family:宋体\">检查</span>2,3,6,7,10,11:</p><p style=\"text-indent: 29px\">0<span style=\"color:#993300\">&nbsp;?</span>&nbsp;<span style=\"color:red\">1</span>&nbsp;_ 0&nbsp;<span style=\"color:red\">0 1</span>&nbsp;_ 1&nbsp;<span style=\"color: red\">0 1</span>&nbsp;0.&nbsp;<span style=\"font-family:宋体\">奇数个</span>1<span style=\"font-family:宋体\">，因此位置</span>2<span style=\"font-family:宋体\">设为</span>1<span style=\"font-family:宋体\">，即</span>: 0 1 1 _ 0 0 1 _ 1 0 1 0</p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">位置</span>4<span style=\"font-family:宋体\">检查</span>4,5,6,7,12:</p><p style=\"text-indent: 29px\">0 1 1 ?&nbsp;<span style=\"color:red\">0 0 1</span>&nbsp;_ 1 0 1&nbsp;<span style=\"color:red\">0</span>.&nbsp;<span style=\"font-family:宋体\">奇数个</span>1<span style=\"font-family:宋体\">，因此位置</span>4<span style=\"font-family:宋体\">设为</span>1<span style=\"font-family:宋体\">，即</span>: 0 1 1 1 0 0 1 _ 1 0 1 0</p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">位置</span>8<span style=\"font-family:宋体\">检查</span>8,9,10,11,12:</p><p style=\"text-indent: 29px\">0 1 1 1 0 0 1 ?&nbsp;<span style=\"color:red\">1 0 1 0</span>.&nbsp;<span style=\"font-family:宋体\">偶数个</span>1<span style=\"font-family:宋体\">，因此位置</span>8<span style=\"font-family:宋体\">设为</span>0<span style=\"font-family:宋体\">，即</span>: 0 1 1 1 0 0 1 0 1 0 1 0</p><p style=\"text-indent: 29px\"><br/></p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">因此码字为</span>: 011100101010.</p><p style=\"text-indent: 28px;line-height: 26px;background: white\"><strong><span style=\"font-size:14px;font-family:宋体;color:#333333\">&nbsp;</span></strong><strong><span style=\"font-size:14px;font-family:宋体;color:#333333\">查找并纠错一位错误</span></strong></p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">上例中构建了一个码字</span>&nbsp;011100101010<span style=\"font-family:宋体\">，假定实际接收到的数据是</span>011100101110.&nbsp;<span style=\"font-family:宋体\">则接收方可以计算出哪一位出错并对其进行更正。方法就是验证每一个校验位。记下所有出错的校验位，可以发现校验位</span>2<span style=\"font-family:宋体\">和</span>8<span style=\"font-family:宋体\">的数据不正确</span>.&nbsp;<span style=\"font-family:宋体\">错误校验位</span>&nbsp;2 + 8 = 10,&nbsp;<span style=\"font-family:宋体\">则位置</span>10<span style=\"font-family: 宋体\">的数据出错。一般说来，对所有校验位进行检查</span>,&nbsp;<span style=\"font-family:宋体;color:#00B0F0\">将所有出错的校验位置相加</span><span style=\"color:#00B0F0\">,&nbsp;</span><span style=\"font-family:宋体;color:#00B0F0\">得到的就是错误信息所在的位置</span>.</p><p style=\"text-indent: 29px\"><span style=\"font-size: 14px; line-height: 21px; text-indent: 29px;\">转自&nbsp;</span><a href=\"http://blog.csdn.net/mengtnt/article/details/8477747\" _src=\"http://blog.csdn.net/mengtnt/article/details/8477747\" style=\"font-size: 14px; line-height: 21px; text-indent: 29px; white-space: normal;\">http://blog.csdn.net/mengtnt/article/details/8477747</a><span style=\"font-size: 14px; line-height: 21px; text-indent: 29px;\">&nbsp;针对原文做了部分修改。</span></p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">&nbsp;</p><p><br/></p>', ',技术,', '32', '0', '2015-10-30 22:36:23', '2015-10-30 22:47:44', '0', null, '1', null);
INSERT INTO `tb_post` VALUES ('24', '1', '【转】大数取模', '', '', '0', '<p style=\"text-indent:29px\"><span style=\"font-family:宋体\">【问题】求大数取模如：</span>2147483647 <span style=\"font-family:宋体\">的</span> 2147483647<span style=\"font-family:宋体\">次方与</span>28461<span style=\"font-family:宋体\">取模？</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">知道大数取模的二进制方法么？</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">举个例子。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">设要计算</span>(5^100)%7 <span style=\"font-family:宋体\">（</span>&#39;^&#39;<span style=\"font-family:宋体\">表示乘方运算）</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">因</span>100=50*2<span style=\"font-family:宋体\">，</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">故</span>(5^100)%7=((5^50)^2)%7=(((5^50)%7)^2)%7<span style=\"font-family:宋体\">。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">现在，我们只要计算</span>(5^50)%7<span style=\"font-family:宋体\">的值，代入上式就可以得到</span>(5^100)%7<span style=\"font-family:宋体\">的值。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">而</span>(5^50)%7<span style=\"font-family:宋体\">比</span>(5^100)%7<span style=\"font-family:宋体\">显然要好计算，因为指数已经减少了</span>2<span style=\"font-family:宋体\">倍。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">现在，我们要计算</span>(5^50)%7<span style=\"font-family:宋体\">的值，我们仍可按照上面的方法来进行：</span></p><p style=\"text-indent:29px\">50=25*2</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">于是：</span>(5^50)%7==((5^25)^2)%7<span style=\"font-family:宋体\">。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">再就是求</span>(5^25)%7<span style=\"font-family:宋体\">的值。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">因</span>25=12*2+1</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">故：</span>(5^25)%7=(((5^12)^2)*5)%7<span style=\"font-family:宋体\">。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">再就是求</span>(5^12)%7...</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">最后，我们注意到，我们将指数分解的是按照指数的二进制形式来进行的。</span></p><p style=\"text-indent:29px\"><br/></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">以下是解决的代码</span></p><p style=\"text-indent:29px\">http://blog.sina.com.cn/s/blog_6a14dbb701014fns.html</p><p style=\"text-indent:29px\">(a+b)%n=(a%n+b%n)%n</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">(a-b)%n=(a%n-b%n+n)%n</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">为什么要加</span>n<span style=\"font-family:宋体\">，由于</span>a%n<span style=\"font-family:宋体\">可能小于</span>b%n,<span style=\"font-family:宋体\">所以加</span>n<span style=\"font-family: 宋体\">保证为正整数</span></p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">a*b%n=(a%n*b%n)%n</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">这些事大整数取模的基础</span></p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">幂取模</span></p><p style=\"text-indent:29px\">int pow_mod(int a,int n,int m)</p><p style=\"text-indent:29px\">{</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;if(n==1) return a;</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;{</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int x=pow_mod(int a,int n/2,int m)</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;long long x=(long long)x*x%m;</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(n%2==1) x=(long long)x*a%m;</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (int)x;</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p style=\"text-indent:29px\">}</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">字符串类型的数字</span></p><p style=\"text-indent:29px\">int mod(char str[],int num)</p><p style=\"text-indent:29px\">{</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;int number[100];</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;for(int i=0;i<strlen(str);i++)< p=\"\"></strlen(str);i++)<></p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number[i]=str[i]-&#39;0&#39;;</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;int remainder=0;</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;for(int i=0;i<strlen(str);i++)< p=\"\"></strlen(str);i++)<></p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;{</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remainder=((long long)remainder*10+number[i])%num;</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;}</p><p style=\"text-indent:29px\">&nbsp;&nbsp;&nbsp;&nbsp;return remainder;</p><p style=\"text-indent:29px\">}</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">之所以强制转换为</span>long long <span style=\"font-family:宋体\">，是为了防止乘法过程中溢出</span></p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">/**</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* </span><span style=\"font-size: 13px;font-family:宋体;color:teal\">大整数取模，转自</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\"> http://bbs.csdn.net/topics/210031004</span><span style=\"font-size:13px;font-family:宋体;color:teal\">和</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:teal\">http://blog.sina.com.cn/s/blog_6a14dbb701014fns.html</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#804000\">#include<stdio.h></stdio.h></span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#804000\">#include<string.h></string.h></span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">/**</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* a^n%mod=? a</span><span style=\"font-size:13px;font-family:宋体;color:teal\">的</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:teal\">n</span><span style=\"font-size:13px;font-family:宋体;color:teal\">次方，对</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:teal\">mod</span><span style=\"font-size:13px;font-family:宋体;color:teal\">取模的结果</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param&nbsp;&nbsp; a </span><span style=\"font-size:13px;font-family:宋体;color:teal\">底数</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param&nbsp;&nbsp; n </span><span style=\"font-size:13px;font-family:宋体;color:teal\">指数</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param&nbsp;&nbsp; mod </span><span style=\"font-size:13px;font-family:宋体;color:teal\">模</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @return&nbsp; </span><span style=\"font-size:13px;font-family:宋体;color:teal\">余数</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> Mod</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> a</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mod</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">==</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">指数为</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">1</span><span style=\"font-size:13px;font-family:宋体;color:green\">的时候，直接输出模结果。</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> a </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">%</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mod</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">else</span></strong> </p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> x </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> Mod</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">a</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> n </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&gt;&gt;=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mod</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">指数除以</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">2,</span><span style=\"font-size:13px;font-family:宋体;color:green\">降为原来的一半，再递归调用，算出子值。</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> x </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> x </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">%</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mod</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">平方后取模</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">n </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&amp;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">指数为奇数，再加一个次幂后取模的计算</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> x </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> a </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">%</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mod</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">x</span><strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">/**</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* </span><span style=\"font-size: 13px;font-family:宋体;color:teal\">超过整型长度的数字，用字符串表示，对</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">mod</span><span style=\"font-size:13px;font-family:宋体;color:teal\">取模的结果</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param&nbsp;&nbsp; str </span><span style=\"font-size:13px;font-family:宋体;color:teal\">底数</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param&nbsp;&nbsp; mod </span><span style=\"font-size:13px;font-family:宋体;color:teal\">模</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @return&nbsp; </span><span style=\"font-size:13px;font-family:宋体;color:teal\">余数</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> Modstr</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">char</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> str</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[],</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mod</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> number</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">100</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">];</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">for</span></strong><strong><span style=\"font-size:13px;font-family: &#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i&nbsp;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;&nbsp;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">strlen</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">str</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++)</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; number</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">str</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]-</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&#39;0&#39;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> remainder</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">for</span></strong><strong><span style=\"font-size:13px;font-family: &#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i&nbsp;<font color=\"#000080\"><b>&lt;&nbsp;</b></font></span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">strlen</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">str</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++)</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; remainder </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">((</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">remainder </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">10</span> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> number</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">])</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">%</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> mod</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> remainder</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> main</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;Mod 5^3 %% 7 = %d\\n&quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> Mod</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">5</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">3</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">7</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">));</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;Mod 2053417840^2041433586 %% 29313 = %d\\n&quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> Mod</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2053417840</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2041433586</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">29313</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">));</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;Modstr 123434567890123 %% 5 = %d\\n&quot;</span><strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> Modstr</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;123434567890123&quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">5</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">));</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">运行结果</span></p><p style=\"text-indent:29px\">Mod 5^3 % 7 = 6</p><p style=\"text-indent:29px\">Mod 2053417840^2041433586 % 29313 = 15037</p><p style=\"text-indent:29px\">Modstr 123434567890123 % 5 = 3</p><p><span style=\"font-size:13px;line-height:150%;font-family:宋体;color:teal\">转自</span><span style=\"font-size:13px;line-height:150%;font-family:&#39;Courier New&#39;;color:teal\"> http://bbs.csdn.net/topics/210031004</span><span style=\"font-size:13px;line-height:150%;font-family:宋体;color:teal\">和</span><span style=\"font-size:13px;line-height:150%;font-family:&#39;Courier New&#39;;color:teal\">http://blog.sina.com.cn/s/blog_6a14dbb701014fns.html</span></p><p><br/></p><p><br/></p>', ',技术,', '23', '0', '2015-11-02 16:02:28', '2015-11-05 14:01:17', '0', null, '1', null);
INSERT INTO `tb_post` VALUES ('25', '1', '斐波那契数列', '', '', '0', '<p><span id=\"_baidu_bookmark_start_10\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_13\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_16\" style=\"display: none; line-height: 0px;\">‍</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">首先看一个兔子问题：</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">一般而言，兔子在出生两个月后，就有繁殖能力，一对兔子每个月能生出一对小兔子来。如果所有兔都不死，那么一年以后可以繁殖多少对兔子？</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">我们不妨拿新出生的一对小兔子分析一下：</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">第一个月小兔子没有繁殖能力，所以还是一对；</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">两个月后，生下一对小兔总数共有两对；</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">三个月以后，老兔子又生下一对，因为小兔子还没有繁殖能力，所以一共是三对；</span></p><p style=\"text-indent:29px\"><span style=\"background:white\">……</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">依次类推可以列出下表：</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\"></span></p><p style=\"text-indent:29px\"><img src=\"/static/upload/bigpic/20151102/1446463851043410148.png\"/><span style=\"font-family:宋体;background:white\"></span><br/></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\"></span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">以上生兔子的数列，就是斐波那契数列</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">斐波那契数列，又称黄金分割数列，指的是这样一个数列：</span><span style=\"background:white\">0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background: white\">377</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background:white\">610</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background:white\">987</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background: white\">1597</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background:white\">2584</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background:white\">4181</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background: white\">6765</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background:white\">10946</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background:white\">17711</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background: white\">28657</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background:white\">46368</span>……</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">在较高的序列，两个连续的</span><span style=\"background:white\">“</span><span style=\"font-family:宋体;background:white\">斐波纳契数</span><span style=\"background:white\">”</span><span style=\"font-family:宋体;background:white\">的序列相互分割，将接近黄金比例（</span><span style=\"background:white\">1.618:1</span><span style=\"font-family: 宋体;background:white\">或</span><span style=\"background:white\">1:0.618</span><span style=\"font-family:宋体;background:white\">）。</span></p><p style=\"text-indent:29px\"><strong><span style=\"font-family:宋体\">特别指出：第</span>0</strong><strong><span style=\"font-family:宋体\">项是</span>0</strong><strong><span style=\"font-family:宋体\">，第</span>1</strong><strong><span style=\"font-family:宋体\">项是第一个</span>1</strong><span style=\"font-family:宋体\">。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">这个数列从第</span>2<span style=\"font-family:宋体\">项开始，每一项都等于前两项之和。</span></p><h3 style=\"margin-top:20px;margin-bottom:12px;margin-left: 0;text-indent:43px;line-height:19px;background:white\"><span style=\"font-family:&#39;微软雅黑&#39;,&#39;sans-serif&#39;;color:#333333;font-weight:normal\">递推公式</span></h3><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">如果设</span><span style=\"background:white\">F(n</span><span style=\"font-family:宋体;background:white\">）为该数列的第</span><span style=\"background:white\">n</span><span style=\"font-family:宋体;background:white\">项（</span><span style=\"background:white\">n</span><span style=\"font-family:宋体;background:white\">∈</span><span style=\"background:white\">N*</span><span style=\"font-family:宋体;background:white\">），那么这句话可以写成如下形式：</span><span style=\"background:white\">&nbsp;</span></p><p style=\"text-indent:29px\"><span style=\"background:white\">F(0)=0</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background:white\">F(1)=1</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background:white\">F(n)=F(n-1)+F(n-2) (n≥2</span><span style=\"font-family:宋体;background:white\">，</span><span style=\"background:white\">n</span><span style=\"font-family:宋体;background:white\">∈</span><span style=\"background:white\">N*)</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">这是一个线性递推数列。</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">代码实现</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#804000\">#include<stdio.h></stdio.h></span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> deep </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">斐波那契</span> <span style=\"font-size:13px;font-family:宋体;color:green\">递归方式</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> Fibonacci</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> fib </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">==</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">||</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">==</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">n </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&gt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> deep</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;0 1 1 &quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; deep</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; fib </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> Fibonacci</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">n</span><strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> Fibonacci</span><strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">n </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&gt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> deep</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;%d &quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> fib</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; deep</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> fib</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">斐波那契</span> <span style=\"font-size:13px;font-family:宋体;color:green\">迭代方式</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> Fibonacci1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> fib </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> fib1 </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> fib2 </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;0 1 &quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">for</span></strong><strong><span style=\"font-size:13px;font-family: &#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;=&lt; span=&quot;&quot;&gt;<!--=<--><!--=<--><!--=<--></span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++){</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fib </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> fib1 </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> fib2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fib1 </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> fib2</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fib2 </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> fib</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;%d &quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> fib</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> fib</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> main</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">()</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> n </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">20</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;n=%d\\n</span><span style=\"font-size:13px;font-family:宋体;color:gray\">斐波那契</span> <span style=\"font-size:13px;font-family:宋体;color:gray\">递归方式</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:gray\">:\\n&quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; Fibonacci</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;\\n</span><span style=\"font-size:13px;font-family:宋体;color:gray\">斐波那契</span> <span style=\"font-size:13px;font-family:宋体;color:gray\">迭代方式</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:gray\">:\\n&quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; Fibonacci1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">运行结果</span></p><p style=\"text-indent:29px\"><span style=\"background:white\">n=20</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">斐波那契</span> <span style=\"font-family:宋体;background:white\">递归方式</span><span style=\"background:white\">:</span></p><p style=\"text-indent:29px\"><span style=\"background:white\">0 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 </span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">斐波那契</span> <span style=\"font-family:宋体;background:white\">迭代方式</span><span style=\"background:white\">:</span></p><p style=\"text-indent:29px\"><span style=\"background:white\">0 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765</span></p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\"><br/></span><br/></p><p><br/></p>', ',技术,', '24', '0', '2015-11-02 19:22:22', '2015-11-05 14:05:08', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('26', '1', '【转】抢红包的红包生成算法', '', '', '0', '<p style=\"text-indent:29px\"><font face=\"宋体\">算法思想摘自</font></p><p style=\"text-indent:29px\">http://blog.csdn.net/hengyunabc/article/details/19177877</p><p style=\"text-indent:29px\"><font face=\"宋体\"></font>不过这篇文章没有C实现的代码，我根据他的思想用C实现了红包算法，并且将结果复制到Excel绘制出概率分布图！</p><p style=\"text-indent:29px\"><br/></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">过年微信红包很火，最近有个项目也要做抢红包，于是写了个红包的生成算法。</span></p><p style=\"text-indent:29px\"><strong><span style=\"font-family:宋体\">红包生成算法的需求</span></strong></p><p style=\"text-indent:29px\"><strong><span style=\"font-family:宋体\">预先生成所有的红包还是一个请求随机生成一个红包</span></strong></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">简单来说，就是<span style=\"color:#00B0F0\">把一个大整数</span></span><span style=\"color:#00B0F0\">m</span><span style=\"font-family:宋体;color:#00B0F0\">分解（直接以</span><span style=\"color:#00B0F0\">“</span><span style=\"font-family:宋体;color:#00B0F0\">分为单位，如</span><span style=\"color:#00B0F0\">1</span><span style=\"font-family:宋体;color:#00B0F0\">元即</span><span style=\"color:#00B0F0\">100</span><span style=\"font-family:宋体;color:#00B0F0\">）分解成</span><span style=\"color:#00B0F0\">n</span><span style=\"font-family:宋体;color:#00B0F0\">个小整数的过程</span><span style=\"font-family:宋体\">，小整数的范围是</span>[min, max]<span style=\"font-family:宋体\">。</span></p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">最简单的思路，先保底，每个小红包保证有</span>min<span style=\"font-family:宋体\">，然后每个请求都随机生成一个</span>0<span style=\"font-family:宋体\">到</span>(max-min)<span style=\"font-family:宋体\">范围的整数，再加上</span>min<span style=\"font-family:宋体\">就是红包的钱数。</span></p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">这个算法虽然简单，但是有一个弊端：最后生成的红包可能都是</span>min<span style=\"font-family:宋体\">钱数的。也就是说可能最后的红包都是</span>0.01<span style=\"font-family:宋体\">元的。</span></p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">另一种方式是预先生成所有红包，这样就比较容易控制了。我选择的是预先生成所有的红包。</span></p><p style=\"text-indent:29px\"><strong><span style=\"font-family:宋体\">理想的红包生成算法</span></strong></p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">理想的红包生成结果是平均值附近的红包比较多，大红包和小红包的数量比较少。</span></p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">可以想像下，生成红包的数量的分布有点像</span><strong><span style=\"font-size:14px;line-height:150%;font-family:宋体;color:#333333\">正态分布</span></strong><span style=\"font-family:宋体\">。</span></p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">那么如何实现这种平均线附近值比较多的要求呢？</span></p><p style=\"text-indent: 29px\"><span style=\"font-family:宋体\">就是要找到一种算法，可以提高平均值附近的概率。那么利用一种</span>”<span style=\"font-family:宋体\">膨胀</span>“<span style=\"font-family:宋体\">再</span>”<span style=\"font-family: 宋体\">收缩</span>“<span style=\"font-family:宋体\">的方式来达到这种效果。</span></p><p style=\"text-indent: 28px\"><strong><span style=\"font-size:14px;line-height:150%;font-family:宋体;color:#333333\">先平方，再生成平方范围内的随机数，再开方，那么概率就不再是平均的了。</span></strong></p><p><span style=\"font-size:15px;line-height:150%;font-family:宋体\">具体算法：</span></p><p style=\"text-indent:29px\">C<span style=\"font-family:宋体\">语言实现版本</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#804000\">#include &lt;stdio.h&gt;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#804000\">#include &lt;time.h&gt;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#804000\">#include &lt;math.h&gt;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#804000\">#include &lt;stdlib.h&gt;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> sqr</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">查表快，还是直接算快？</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> n </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> nextLong</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> rand</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">()%((</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> n</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> nextLong1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> max</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> rand</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">()%((</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">max </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">))</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">/**</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* </span><span style=\"font-size: 13px;font-family:宋体;color:teal\">生产</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">min</span><span style=\"font-size:13px;font-family:宋体;color:teal\">和</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">max</span><span style=\"font-size:13px;font-family:宋体;color:teal\">之间的随机数，但是概率不是平均的，从</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">min</span><span style=\"font-size:13px;font-family:宋体;color:teal\">到</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">max</span><span style=\"font-size:13px;font-family:宋体;color:teal\">方向概率逐渐加大。</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\"> </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* </span><span style=\"font-size: 13px;font-family:宋体;color:teal\">先平方，然后产生一个平方值范围内的随机数，再开方，这样就产生了一种</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:teal\">“</span><span style=\"font-size:13px;font-family:宋体;color:teal\">膨胀</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:teal\">”</span><span style=\"font-size:13px;font-family:宋体;color:teal\">再</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:teal\">“</span><span style=\"font-size:13px;font-family:宋体;color:teal\">收缩</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:teal\">”</span><span style=\"font-size:13px;font-family:宋体;color:teal\">的效果。</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\"> </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;*&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param min </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param max </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @return </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> xRandom</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> max</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">return</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> sqrt</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">nextLong</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">sqr</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">max </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)));</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">/** </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;*&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param total </span><span style=\"font-size:13px;font-family:宋体;color:teal\">红包总金额</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param count </span><span style=\"font-size:13px;font-family:宋体;color:teal\">红包数量</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param max </span><span style=\"font-size:13px;font-family:宋体;color:teal\">每个小红包的最大金额</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param min </span><span style=\"font-size:13px;font-family:宋体;color:teal\">每个小红包的最小金额</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @param result </span><span style=\"font-size:13px;font-family:宋体;color:teal\">存放生成的每个小红包的值的数组</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;* @return </span><span style=\"font-size:13px;font-family:宋体;color:teal\">红包数量</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:teal\">&nbsp;*/</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">void</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> generate</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> total</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> max</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> average </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> total </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">/</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> a </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> average </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> b </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> max </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">这样的随机数的概率实际改变了，产生大数的可能性要比产生小数的概率要小。</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">这样就实现了大部分红包的值在平均数附近。大红包和小红包比较少。</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> range1 </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> sqr</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">average </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> range2 </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> sqr</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">max </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> average</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">for</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">因为小红包的数量通常是要比大红包的数量要多的，因为这里的概率要调换过来。</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">当随机数</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">&gt;</span><span style=\"font-size:13px;font-family:宋体;color:green\">平均值，则产生小红包</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">当随机数</span><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:green\">&lt;</span><span style=\"font-size:13px;font-family:宋体;color:green\">平均值，则产生大红包</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">nextLong1</span><strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">min</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> max</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&gt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> average</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">在平均线上减钱</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> temp </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> xRandom</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">min</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> average</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> temp</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> temp</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">else</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">在平均线上加钱</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> temp </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> max </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> xRandom</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">average</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> max</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> temp</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">-=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> temp</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">如果还有余钱，则尝试加到小红包里，如果加不进去，则尝试下一个。</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">while</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">total </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&gt;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">for</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">total </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&gt;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&amp;&amp;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> max</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]++;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;total</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">--;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">// </span><span style=\"font-size:13px;font-family:宋体;color:green\">如果钱是负数了，还得从已生成的小红包中抽取回来</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">while</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">total </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">for</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">if</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">total </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&amp;&amp;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&gt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]--;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</span><strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> main</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">()</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> max </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">15</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> total </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> count </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:#FF8000\">10</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">红包数量</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">money_count</span><strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">每个钱数的红包数量</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; srand</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">time</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">));</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; result </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*)</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">malloc</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">sizeof</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">long</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; generate</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">100</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> max</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> min</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;hongbao:\\n&quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">for</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;%d &quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+=</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">];</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">检查生成的红包的总额是否正确</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;\\ntotal:%d\\n&quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> total</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">统计每个钱数的红包数量，也就是概率值，检查是否接近正态分布</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; money_count </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">*)</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">malloc</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">sizeof</span></strong><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)*</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">max</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">for</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; money_count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#8000FF\">int</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">)</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]]</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">+=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">1</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;fenbu:\\n&quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">for</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> max</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;%d %d|&quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> money_count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">//</span><span style=\"font-size:13px;font-family:宋体;color:green\">为了方便在</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">excel</span><span style=\"font-size:13px;font-family:宋体;color:green\">中绘制折线图，这里特地将结果竖直输出，复制到</span><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:green\">excel</span><span style=\"font-size:13px;font-family: 宋体;color:green\">中直接绘制折线图。</span></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:blue\">for</span></strong> <strong><span style=\"font-size: 13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">=</span></strong> <span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:#FF8000\">0</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">&lt;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> max</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">;</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">++)</span></strong> <strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">{</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:gray\">&quot;%d\\n&quot;</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">,</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\"> money_count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">[</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">i</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">]);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; </span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; free</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">money_count</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">&nbsp;&nbsp;&nbsp; free</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">(</span></strong><span style=\"font-size: 13px;font-family: &#39;Courier New&#39;\">result</span><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">);</span></strong></p><p style=\"text-indent:0;line-height: normal;background:white\"><strong><span style=\"font-size:13px;font-family:&#39;Courier New&#39;;color:navy\">}</span></strong></p><p style=\"text-indent:29px\">1.<span style=\"font-family:宋体\">总金额为</span>100<span style=\"font-family:宋体\">，发红包数量为</span>10<span style=\"font-family:宋体\">，单个红包最低</span>1<span style=\"font-family:宋体\">最高</span>15<span style=\"font-family: 宋体\">时候，输出结果</span></p><p style=\"text-indent:29px\">hongbao:</p><p style=\"text-indent:29px\">12 3 8 12 13 11 13 11 8 9</p><p style=\"text-indent:29px\">total:100</p><p style=\"text-indent:29px\">fenbu:</p><p style=\"text-indent:29px\">0 0|1 0|2 0|3 1|4 0|5 0|6 0|7 0|8 2|9 1|10 0|11 2|12 2|13 2|14 0|</p><p style=\"text-indent:29px\">2.<span style=\"font-family:宋体\">总金额为</span>1000000<span style=\"font-family:宋体\">，发红包数量为</span>10000<span style=\"font-family:宋体\">，单个红包最低</span>1<span style=\"font-family:宋体\">最高</span>200<span style=\"font-family: 宋体\">时候，根据输出结果绘制折线图如下，可以看出满足正态分布：</span></p><p style=\"text-indent:29px\"><img src=\"/static/upload/bigpic/20151103/1446559056644536200.png\"/></p><p><br/></p>', ',技术,', '19', '0', '2015-11-03 21:54:40', '2015-11-03 21:57:46', '0', null, '1', null);
INSERT INTO `tb_post` VALUES ('27', '1', '李鸿章之死', '', '', '0', '100年前的1901年11月7日，李鸿章在屈辱和病痛中辞世。生当“三千年未有之变局”的李鸿章，生前身后都遭到诟病。本文试图从新的视角审视李鸿章，相信对仍致力于实现现代化的国人不无助益。离1901年的结束仅剩不到一个月的时候，回銮路上的大清国皇太后慈禧在黄河岸边的辉县收到了那个令朝野上下无不悲哀的消息：李鸿章死了。\r\n\r\n李鸿章，大清国直隶总督兼北洋大臣。\r\n\r\n就在他咽气之前的一个小时，俄国公使还站在他的床头逼迫他在俄占中国东北的条约上签字。为了大清国与洋人争辩了一生的李鸿章已不能说话，他只有眼泪了。眼泪流尽了，他的眼睛闭上了。\r\n\r\n自1840年英国人用舰炮打开中国的国门以后，中国人沿海岸修筑的所有整齐对称的炮台和花费巨银买来的位居世界第六的舰队，没有一次阻挡住“蛮夷”的入侵：“自道光中叶以来，外患渐深，至于今日，危迫极已。咸丰十年，英法联军入都，毁圆明园，文宗出走，崩于热河……自此以后，法并安南，日攘朝鲜，属地渐失。各海口亦为列强所据，德占胶州，俄占旅顺大连，英占威海九龙，法占广湾……”而就在李鸿章死时，因为允许外国在中国驻军和几近天文数字的赔款而成为“将来无数困难问题发生之源”的《辛丑条约》刚刚签订，外国联军仍在整个朝廷逃亡在外的情况下占领着大清国的都城北京。\r\n\r\n对于风雨飘摇中的大清国来说，洋人的气焰永远是一个巨大的威胁。而李鸿章一死，大清上下就失去了惟一能够与洋人周旋的人。李鸿章的死令“太后及帝哭失声”，大清国犹如“梁倾栋折，骤失倚侍”。\r\n\r\n#### 洋务重臣\r\n还在与太平军作战的时候，李鸿章就显露出他与大清国所有官员的不同之处：对外国的科学技术和国内的经济活动有极大的兴趣。最初的动机是他组建的淮军需要银两购买武器。当淮军在两岸布满太平军营垒的水道上成功地进行了大穿越进至上海，从而一举扫平了长江下游的太平军后，李鸿章利用上海富绅的银两引进洋人的机器设备，创办了中国第一个近代军工企业：上海洋枪三局。李鸿章算过一笔账：一发英国的普通炮弹在市场上要卖到30两银子，1万发铜帽子弹要卖到19两银子。大清国凭什么要把白花花的银子给了洋人？\r\n\r\n创办近代企业需要的不仅仅是财力，更重要的是思想和观念的更新。李鸿章曾写有一份描绘蒸汽动力运转的奏折，无异于100年前的一篇科普文章：\r\n\r\n镟木、打眼、绞镙旋、铸弹诸机器，皆绾于汽炉，中盛水而下炽炭，水沸气满，开窍由铜喉达入气筒，筒中络一铁柱，随气升降俯仰，拔动铁轮，轮绾皮带，系绕轴心，彼此连缀，轮转则带旋，带旋则机动，仅资人力以发纵，不靠人力之运动。\r\n\r\n在几乎没人知道世界上有蒸汽机的大清国里，头上是顶戴花翎、脑后依然拖着辫子的李鸿章，能够如此细致地观察蒸汽机的运转原理，这着实令人惊叹。\r\n\r\n大清中叶以后，由于京杭运河淤塞，朝廷南北货物的调运部分改为海路，李鸿章抓住时机，督办创立了“招商局轮船公司”。这是中国第一家民营轮船公司，它承揽了朝廷“官物”运输一半的运量，而其随后展开的客运业竟挤垮了英美合办的旗昌公司。\r\n\r\n而当洋人要在中国开设电报业务的时候，大清国朝野上下无不惊慌失措，以为“电报之设，深入地下，横冲直撞，四通八达，地脉既绝……”李鸿章也不允许洋人从香港铺设来的海底电缆上岸。只是，时隔不久，由他支持铺设的中国第一条电报电缆线在大沽口到天津城之间开通了。李鸿章能够完全不理会“地脉”，也能够完全不理会洋人，因为他知道电报业蕴藏着极高的军事和民用价值。之后，由大清国政府的银子作为投资、以赢利为目的的电报公司成立。李鸿章称此举为“官督商办”，因为在中国创办拥有自主权的企业“事体重大，有裨国计民生，故需官为扶持并酌借官帑以助商力之不足”。\r\n\r\n由于李鸿章的主持和参与，洋务派创办了中国近代第一条铁路、第一座钢铁厂、第一座机器制造厂、第一所近代化军校、第一支近代化海军舰队……\r\n\r\n李鸿章为大清国国计民生近代化所奠基的所有事业，令他身后的国人一直在受益。他是对中国近代化产生了至关重要影响的洋务运动的中坚。但是，李鸿章一生所从事的另一种“洋务”，却使他在生前和身后招致众多的痛骂，因为根据国人一向的认知，中国近代史上的屈辱与不公都是他一手造成的，他所有竭尽心力的努力无不是在把国家的领土、财富和臣民出卖给洋人，这位大清重臣的罪责深重得几乎令人难以置信。\r\n\r\n大清国没有“外交”的概念，所有的外事统统归于“洋务”。洋务运动的首领李鸿章不可避免地成为了大清国当然的“外交家”。李鸿章的外交生涯不但让西方人知道了大清国有一个“相貌堂堂”且“矜持、自信和傲慢”的李中堂，而且也让中国人在上一个世纪之交那段悲伤的日子里终于揪出了一个“罪魁祸首”————李鸿章让国人因为遭受屈辱而积淀的愤恨在怒斥他的过程中得到宣泄。\r\n\r\n洋人了解李鸿章的外交能力，是通过中英《烟台条约》的谈判。其时，英国人的军舰开入烟台，日本军队开始向朝鲜武装挑衅，以对大清国构成战争威胁。皇亲醇亲王主张与英国人决裂开战，而李鸿章的思路是：大清国不能再在外交上走一贯的老路，即事端一出，动辄开战，战则必败，败则议和，和则割地赔款。1876年9月，《烟台条约》签订。觊觎更多在华利益的英国人事后说：“这个文件既不明智也不实用，毫无意义，是一堆冗言赘语而已。”尽管洋人说，面对强大的威胁，李鸿章依然能谈出一个明显存有抵抗态度的条约，是一件“值得惊诧”的外交事件，但从烟台回到直隶总督府的李鸿章还是因为赔款和开放口岸而背上了卖国的罪名。\r\n\r\n1894年爆发的中日甲午之战，是李鸿章一生遇到的最大的挫折———“海军费绌，设备多不完，惟鸿章知之深。朝野皆不习外事，谓日本国小不足平，故全国主战，独鸿章深知其强盛，逆料中国海陆军皆不可恃，故宁忍诟言和。朝臣争劾鸿章误国，枢臣日责鸿章，乃不得已而备战。”到1895年2月17日16时，日本联合舰队在风雪交加中开进威海卫，浩浩大清国败于一个弹丸小国的事实，令自认为是“天朝中心”的国人举国愕然。朝廷顾不得“天国颜面”，再令李鸿章去日本议和。\r\n\r\n李鸿章在日本马关被一名刺客击中，子弹卡在他左眼下的骨头缝里，没有医生敢在这个位置下手术刀，李鸿章给朝廷的电报只有六个字：“伤处疼，弹难出。”而面对日本人割让辽东、台湾、澎湖，赔款军费3亿两白银的“要价”，朝廷在给李鸿章的电报中均是模棱两可的“着鸿章酌量办理”。伤痛和心痛折磨着李鸿章。如果采取强硬的态度和立场，只能导致中日战争继续扩大。以大清国实际的军力状况而言，战争的结果只能是中国的东北被全面占领；而如果答应日本人的条件，大清国主权和财产的损失也是巨大的。两害取其轻，这是面对残局的李鸿章的选择。\r\n\r\n1895年4月，带着《马关条约》草约和脸上的绷带回国的李鸿章，发现他成了举国的“公敌”：朝廷斥责他办事不力，官员说他丧权辱国，民间暗示他拿了日本人的银子，更有人公开声明要不惜一切杀掉他以雪“心头奇耻大辱”。\r\n\r\n每一次在国家面临危机时出来收拾残局的李鸿章，被国人目为卖国者，只有全体军机大臣在上奏给皇帝的一份奏折中说过的“中国之败全由不西化之故，非鸿章之过”，曾令李鸿章老泪纵横。\r\n\r\n#### 振聋发聩之声\r\n因为签订《马关条约》而被免去显赫职务的李鸿章，赋闲在京城贤良寺。\r\n\r\n1896年，俄国沙皇加冕，各国派员祝贺，俄国人特别提到了代表的级别问题，朝廷只有派李鸿章去。因为洋人们说，对于19世纪的中国，他们只知有李鸿章而不知有朝廷。李鸿章以在马关被刺为由一再推辞，而朝廷就一再坚决不准，当李鸿章认为确实到了“众望所归”的时候了，便表示自己“非敢爱身，惟虞辱命”，只有“一息尚存，万程当赴”。\r\n\r\n李鸿章的俄国之行还有一个重要行动，即与俄国结盟。\r\n\r\n“联俄拒日”是甲午之后大清国朝廷中的主流认识，以两江总督刘坤一说得最为明确：威胁大清国的国家以日本为最，日本企图占领东北的野心积蓄已久，而俄国因为与大清国东北接壤必最不愿意。所以“我若乘此时与之深相结纳，互为声援，并稍予便宜，俄必乐从我”。\r\n\r\n在插满了大清黄龙旗的彼得堡，李鸿章开始与俄国人商谈《中俄密约》。《中俄密约》的要点是：中俄两国针对日本的军事威胁结成互相援助的军事联盟；俄国在中国东北地区铺设铁路与俄国横穿西伯利亚的远东铁路接轨。\r\n\r\n这一次，李鸿章没能意识到一个具有近代常识的问题：铁路的延伸正是扩张领土的主要手段。至于当大清国受到日本威胁的时候，铁路能够便于军事援助这一点，李鸿章和大清国的官员都没想到，如果俄国人想侵入并占领中国的东北，这条铁路同样会给俄国人提供军事运输的便利。更何况在中国境内修建铁路，一旦“路权”模糊不清，俄国人就会有理由在铁路沿线派驻武装。后来的历史证明这就是对中国东北安全构成巨大威胁的“中东铁路警察队”。关于后者，李鸿章想到了，于是他坚决反对俄国以官方的名义投资铁路，而坚持用私人投资的方式。李鸿章以为这样就可以将铁路的修建变成商业行为。\r\n\r\n离开俄国，李鸿章开始了他的欧美之行。在英国，他特意在代表西方民主制度的议院旁听了议员们的辩论，李鸿章觉得那简直是一窝蜂似的吵架。而大清国要员的出现引起了英国人极大的关注。一位英国人这样描述了他所看到的73岁的李鸿章：\r\n\r\n他像来自另外一个世界的身材奇高、容貌慈祥的异乡人。他蓝色的长袍光彩夺目，步伐和举止端庄，向看他的每个人投以感激的优雅的微笑。从容貌看来，这一代或上一代人都会认为李鸿章难以接近，这不是因为他给你巨大的成就或人格力量的深刻印象，而是他的神采给人以威严的感觉，像是某种半神、半人，自信、超然，然而又有文雅和对苦苦挣扎的芸芸众生的优越感。\r\n\r\n令李鸿章感兴趣的是英国的海军和陆军。他还参加了汇丰银行的招待会，在英国商人们表示要到中国去开拓市场的时候，李鸿章的开明思想令他说出了：“实具同心。”　　当李鸿章乘坐的客轮到达纽约港时，美国海军最强大的舰队依次列阵港湾，鸣炮致敬以欢迎大清国的重臣。美国《纽约时报》记者报道说，当客轮驶往美国的途中，李鸿章在船上对每一位他见到的美国人都问这样的三个问题：你是做什么的？你能挣多少钱？你住得离纽约近吗？\r\n\r\n《纽约时报》记者接着报道说：“没有乘客表示他曾向女士问过这三个问题。”\r\n\r\n而对美国记者关于“美国资本在中国投资出路”的回题，李鸿章的回答是：只有将货币、劳动力和土地有机地结合起来，才会产生财富。清国政府非常高兴地欢迎任何资本到我国投资……必须邀请欧美资本进入清国以建立现代化的工业企业，帮助清国人民开发利用本国丰富的自然资源。但这些企业的自主权应掌握在清国政府手中。我们欢迎你们来华投资，资金和技工由你们提供。但是，对于铁路、电讯等事务，要由我们自己控制。我们必须保护国家主权。这不可谓不前瞻。\r\n\r\n美国记者的另一个问题是：阁下，您赞成将美国的或欧洲的报纸介绍到贵国吗？\r\n\r\n李鸿章的回答是：清国办有报纸，但遗憾的是清国的编辑们不愿将真相告诉读者，他们不像你们的报纸讲真话，只讲真话。清国的编辑们在讲真话的时候十分吝啬，他们只讲部分的真实，而且他们也没有你们报纸这么大的发行量。由于不能诚实地说明真相，我们的报纸就失去了新闻本身的高贵价值，也就未能成为广泛传播文明的方式了。\r\n\r\n为了抗议美国的排华法案，李鸿章甚至宁愿选择经加拿大而非美国西部回国。李说：排华法案是世界上最不公平的法案。所有的政治经济学家都承认，竞争促使全世界的市场迸发活力，而竞争既适用于商品也适用于劳动力。(引自郑曦原编《帝国的回忆》)\r\n\r\n结束访美之后，李鸿章搭乘美轮回国。到达日本横滨港需要换船。李鸿章当年离开马关的时候曾表示“终生不履日地”，现在又有了《中俄密约》，让他痛恨起日本人更有底气了。换船必须先上码头，但是为了不让自己的精神和肉体与日本国土发生一丝关系，李鸿章无论如何也不上岸。侍从们只好在美轮和招商局的轮船之间搭起一块跳板，冒着掉到海里的危险将他扶上船。\r\n\r\n李鸿章以为《中俄密约》可保大清国20年无事。然而仅仅4年之后，最先攻破大清国都城第一道城门东便门的正是俄国人！紧接着，曾经告诉李鸿章自己的国土大得用不完、没有侵占别人一寸土地想法的俄国人开始胁迫大清政府将“东三省永远归俄国所有”。这时候，李鸿章终于明白：大清国自与洋人来往以来所奉行的“以夷制夷”的策略是多么的天真无知。\r\n\r\n李鸿章在给朝廷的奏折中表示：在某种意义上讲，大清国已经没有绝对封闭的国防。西方势力不但在文化上侵蚀着中国，更重要的是他们有侵占中国的野心，其手段是“一国生事，多国构煽”，列强的“友好”和“野心”从来都是搀杂在一起的，大清国对此必须保持警惕。世界发展至今日，一国已不可能关闭国门而安然生存。大清国如果打开国门参与世界商品经济的往来，不但可以富强自己，而且因为贸易是双边的，等于也就制约了别人，这样的制约甚至强过武力，整个地球便可“胥聚于中国”。持有这样的认识，不但在百年前的中国可谓凤毛麟角，即使是在当代中国也可属振聋发聩之声。\r\n\r\n#### 最后一次出场\r\n1900年6月，外国联军攻陷了中国北方的海岸门户大沽炮台，3天之后，京城门户天津陷落，以保护使馆为名登陆的联军向通州进发，而通州距大清国的都城北京仅20公里。21日，大清国宣布与各国进入战争状态。然后朝廷的电报一封接一封地到达南方，要求各省封疆大臣率兵北上共同灭洋。而李鸿章深知国家忧患日深，军力积弱日久，“若不量力而轻于一试，恐数千年文物之邦，从此已矣”。李鸿章给朝廷发去一封电报————大清国两广总督对朝廷“北上勤王”的圣旨的回答是：“此乱命也，粤不奉诏。”\r\n\r\n这也许是上一个世纪之交中国历史上最著名的一句话，它标志着在封建帝国内具有近代政治意识的官员第一次在国家政治事务中显示出鲜明的独立性和抗争性。大清国南方日益活跃的商品贸易和经济活动，潜移默化地影响着官员们的思维方式和统治模式，这种影响虽可能如风蚀岩石般缓慢但却是不可逆转的。两江总督刘坤一、湖广总督张之洞、闽浙总督许应、四川总督奎俊等在获悉了李鸿章的电文后，确定了共同抗旨以求东南互保的原则。他们的道理很简单：如果大清国的南方也发生了动乱，那么乱了敌人的同时肯定也要乱了自己。虽然在以后很长时期内这些人无不被国人痛斥为一群“出卖民族利益的无耻之徒”，但在1900年的庚子巨祸中究竟是他们确保了大清国南方半壁江山的稳定。\r\n\r\n“以卵敌石，岂能幸免？”\r\n\r\n1900年8月15日，大清国都城沦陷，政府和朝廷逃亡。\r\n\r\n此一悲惨事件发生之前，朝廷的电报再一次一封接一封地到达南方，要求李鸿章北上与正在攻打这个国家的洋人议和。朝廷为此将李鸿章由两广总督重新调任为大清国封疆大臣中的最高职位：直隶总督兼北洋大臣。而慈禧的最后一纸任命是：“着李鸿章为全权大臣。”———“每当满清政府把这个巨大的帝国带到毁灭的边缘，他们惟一必须启用的人就是李鸿章。”1900年7月17日，当77岁的李鸿章在广州登船准备北上的时候，南海知县裴景福问他有什么办法可以让国家少受些损失，李鸿章感叹道：“不能预料！惟有竭力磋磨，展缓年分，尚不知做得到否？吾尚有几年？一日和尚一日钟，钟不鸣，和尚亦死矣！”李鸿章生命的最后一年，就是在这样悲伤的心境中开始了他与洋人噩梦般的周旋。　　9月29日，李鸿章到达天津。他去了他曾经执政达20多年的直隶总督府，在满目疮痍的天津城中，总督府已是一片废墟。10月11日，李鸿章到达北京。外国联军宣布除了“两个小院落仍属于清国政府管辖”之外，整个京城由各国军队分区占领。那两个小院落一个是李鸿章居住的贤良寺，一个是参加与联军议和谈判的庆亲王的府邸。\r\n\r\n11月初，联军照会李鸿章和庆亲王，提出议和谈判的六项原则：惩办祸首；禁止军火输入中国；索取赔款；使馆驻扎卫兵；拆毁大沽炮台；天津至大沽间驻扎洋兵，保障大沽与北京之间的交通安全自由。这六项严重侮辱大清国国家主权的“原则”，令李鸿章说出了列强犹如“虎狼群”的话，他终于意识到自己根本无法结束大清国的厄运。　　逃亡至西安的慈禧在黄尘烈风中天天盼着李鸿章的“好”消息———“望电报如饥渴”，虽然大清国于1900年夏天发生的巨祸是由慈禧一手酿成，但李鸿章必须在联军的追究面前维护住慈禧的权力，他只有日复一日地“竭力磋磨”————“每当聚议时，一切辩驳均由李鸿章陈词；所奏朝廷折电，概出李鸿章之手。”李鸿章病倒了，起因是在拜会英、德公使后回贤良寺的路上受了风寒。故作拖延以“漫天要价”的联军沉不气了，占尽“中国财力兵力”的“议和大纲”终于出笼。\r\n\r\n湖广总督张之洞联合南方的封疆大臣，力主不能在“议和大纲”上“画押”。李鸿章对“不明敌情”却“局外论事”的张之洞十分恼火，他表示如果坚持不“画押”，谈判即刻便会破裂，结果只能是将大清国拖入无休止的战乱————联军在京城屯兵数万，有随时扩大战争的能力；在这种内外皆危之际，高谈阔论并不能扭转危难。\r\n\r\n而因为“议和大纲”既没有将慈禧列为祸首，又没有让她交出权力，于是朝廷给李鸿章回电：“敬念宗庙社稷，关系至重，不得不委曲求全。”1901年1月15日，李鸿章和庆亲王代表大清国在“议和大纲”上签字。国人即刻指责道：“卖国者秦桧，误国者李鸿章！”\r\n\r\n李鸿章吐血了。知道自己已经时日不多，李鸿章想尽快地结束谈判，而谈判结束的直接标志是联军撤出京城和皇室朝廷回京。可是，“议和大纲”签字后，联军并没有撤军的迹象。各国的态度是：必须把赔款的数额定下来，必须亲眼看到惩办祸首。\r\n\r\n关于惩办问题的谈判耗尽了李鸿章最后的气力，他无法接受皇亲们在菜市口被洋人斩首，最终还是顶住了联军要求对皇亲“正法”的压力。\r\n\r\n接下来是赔款问题的谈判，李鸿章已经没有力气与洋人争来争去了，他不愿为大清国的几两银子再低三下四了，他吐血已经吐到了“濒危”的程度。只是，病中的李鸿章没忘给张之洞传话，说是电报每个字四角银元实在太贵，要他不要再发“空论长电”，凡事可以摘要发出，以节省经费。赔款问题全部是由下级官员谈的，结果是大清国赔款4亿5千万两，分39年还清，年息4厘。列强们说，4亿5千万中国人，“人均一两，以示侮辱”。朝廷的回电是：“应准照办。”\r\n\r\n1901年9月7日，代表大清国与11国签订了中国近代史上著名的不平等条约《辛丑条约》的李鸿章，在签字回来后再一次大口地吐血————“紫黑色，有大块”，“痰咳不支，饮食不进”。医生诊断为：胃血管破裂。\r\n\r\n李鸿章在病榻上上奏朝廷：\r\n\r\n臣等伏查近数十年内，每有一次构衅，必多一次吃亏。上年事变之来尤为仓促，创深痛巨，薄海惊心。今议和已成，大局稍定，仍希朝廷坚持定见，外修和好，内图富强，或可渐有转机。\r\n\r\n难以想象就要离世的李鸿章在写下“必多一次吃亏”这几个字时会是什么心情。他毕生致力的“外修和好，内图富强”的愿望此时说出来实在是一种前途渺茫下的伤心无奈。\r\n\r\n远在逃亡地的慈禧复电李鸿章，言他“为国宣劳，忧勤致疾”，望他“早日痊愈，荣膺懋赏”。\r\n\r\n但是，李鸿章没有等到“荣膺懋赏”的那一天。1901年11月7日，这位大清重臣已处在油尽灯枯之际，他“久经患难，今当垂暮，复遭此变，忧郁成疾，已乖常度”。站在他床头逼迫他签字的俄国公使走了之后，身边的人大哭：“还有话要对中堂说，不能就这么走了！”李鸿章的眼睛又睁开了，身边的人对他说：“俄国人说了，中堂走了以后，绝不与中国为难！还有，两宫不久就能抵京了！”李鸿章两目炯炯不瞑，张着口似乎想说什么。身边的人再说：“未了之事，我辈可了，请公放心！”李鸿章“目乃瞑”，享年78岁。\r\n\r\n#### 几种评论\r\n李鸿章死后两个月，梁启超写出皇皇大作《李鸿章传》，称：鸿章必为数千年中国历史上一人物，无可疑也。李鸿章必为十九世纪世界历史上一人物，无可疑也。梁启超说他“敬李鸿章之才”，“惜李鸿章之识”，“悲李鸿章之遇”。\r\n\r\n日本人对李鸿章的评价是：知西来大势，识外国文明，想效法自强，有卓越的眼光和敏捷的手腕。\r\n\r\n美国人的评价是：以文人来说，他是卓越的；以军人来说，他在重要的战役中为国家作了有价值的贡献；以从政来说，他为这个地球上最古老、人口最多的国家的人民提供了公认的优良设施；以一个外交家来说，他的成就使他成为外交史上名列前茅的人。\r\n\r\n李鸿章生逢大清国最黑暗、最动荡的年代，他的每一次“出场”无不是在国家存亡危急之时，大清国要他承担的无不是“人情所最难堪”之事。因此，国人在对他咒骂痛斥之时，确实“不可不深自反也”，确实不可“放弃国民之责任”。\r\n\r\n只是，该怎样评价100年前这位不同寻常的大清重臣，中国人一向的定论与百年以来的世界舆论截然不同。\r\n\r\n在中国，评价一个人是很容易同时也是很难的事情。\r\n\r\n李鸿章(1823—1901)', ',历史,', '30', '0', '2015-11-06 19:37:58', '2016-08-25 16:31:39', '0', null, '1', '《重读李鸿章》 作者牛贯杰,东方出版社出版。');
INSERT INTO `tb_post` VALUES ('28', '1', '索引查找', '', '', '0', '<p><span id=\"_baidu_bookmark_start_2\" style=\"display: none; line-height: 0px;\"><span style=\"line-height: 0px;\">﻿</span>‍</span><span id=\"_baidu_bookmark_start_5\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_8\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_11\" style=\"display: none; line-height: 0px;\">‍</span></p><p><span id=\"_baidu_bookmark_start_1\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_4\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_7\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_10\" style=\"display: none; line-height: 0px;\">‍</span></p><p>索引查找，就是新建一个索引表，将源数据hash后对应到索引表上，查询的时候直接查索引表得到源数据地址。以下是C语言实现的一级索引简单示例</p><p>#include stdio.h<stdio.h></stdio.h></p><p><br/></p><p>#define N 100 // 主表最大长度</p><p>#define M 30 // 索引表最大长度</p><p>int ROW_WIDTH = 10;</p><p><br/></p><p>/**</p><p>&nbsp;* 计算索引编号的哈希函数</p><p>&nbsp;*/</p><p>#define hashindex(key) key / 100</p><p><br/></p><p>/**</p><p>&nbsp;* 索引项</p><p>&nbsp;*/</p><p>typedef struct</p><p>{</p><p>&nbsp; &nbsp; int index; // 索引编号，按照间隔固定的每行长度index_width个数据划分为一个索引段。</p><p>&nbsp; &nbsp; int start; // 索引起始位置，以此为基准搜索本行内数据，start = (index - 1) * ROW_WIDTH；</p><p>&nbsp; &nbsp; int length; // 有效数据长度</p><p>} IndexItem;</p><p><br/></p><p>/**</p><p>&nbsp;* 主表</p><p>&nbsp;*/</p><p>int MainTable[N] = {</p><p>/* &nbsp;177,189,100,123,111,0,0,0,0,0, // 主表固定的每行长度 ROW_WIDTH = 10，后面为0的代表无效数据</p><p>&nbsp; &nbsp; 201,202,203,204, &nbsp;0,0,0,0,0,0,</p><p>&nbsp; &nbsp; 301,302,303, &nbsp;0, &nbsp;0,0,0,0,0,0</p><p>*/</p><p>};</p><p>int MainLength = 0; // 主表长度</p><p><br/></p><p>/**</p><p>&nbsp;* 索引表</p><p>&nbsp;*/</p><p>IndexItem IndexTable[M] = {</p><p>/* &nbsp;{1, 0,5}, // 第一行：第一列索引编号1；第二列索引起始位置 0 = (1 - 1) * 10；第三列有效数据长度是5个；</p><p>&nbsp; &nbsp; {2,10,4}, // 第二行：第一列索引编号2；第二列索引起始位置10 = (2 - 1) * 10；第三列有效数据长度是4个；</p><p>&nbsp; &nbsp; {3,20,3} &nbsp;// 第三行：第一列索引编号3；第二列索引起始位置20 = (3 - 1) * 10；第三列有效数据长度是3个；</p><p>*/</p><p>};</p><p>int IndexLength = 0; // 索引表当前有效索引长度</p><p><br/></p><p><br/></p><p><br/></p><p>void CreateIndex(int *data, int length){</p><p>&nbsp; &nbsp; int i = 0;</p><p>&nbsp; &nbsp; int j = 0;</p><p>&nbsp; &nbsp; // 初始化索引表</p><p>&nbsp; &nbsp; for (i = 0; i &lt; M; i++){</p><p>&nbsp; &nbsp; &nbsp; &nbsp; IndexTable[i].index = i + 1;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; IndexTable[i].start = i * ROW_WIDTH;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; IndexTable[i].length = 0;</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; // 将数据写入主表和索引表</p><p>&nbsp; &nbsp; for (i = 0; i &lt; length; i++){</p><p>&nbsp; &nbsp; &nbsp; &nbsp; j = hashindex(data[i]);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if(j &gt; IndexLength) //记录下当前有效索引长度</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IndexLength = j;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; MainTable[IndexTable[j-1].start + IndexTable[j-1].length++] = data[i];</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; MainLength = IndexLength * ROW_WIDTH;</p><p>}</p><p><br/></p><p>/**</p><p>&nbsp;* 索引查找算法</p><p>&nbsp;* @param key 给定值</p><p>&nbsp;* @return 给定值在表中的位置,返回-1表示索引表中不存在该索引项</p><p>&nbsp;*/</p><p>int IndexSearch(int key)</p><p>{</p><p>&nbsp; &nbsp; int i = 0;</p><p>&nbsp; &nbsp; int j = 0;</p><p>&nbsp; &nbsp; int index = hashindex(key); // 求索引编号</p><p><br/></p><p>&nbsp; &nbsp; //遍历索引表,找到对应的索引项</p><p>&nbsp; &nbsp; for (i = 0; i &lt; IndexLength; i++)</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; //找到索引项</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if (IndexTable[i].index == index)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //在源数据中顺序查找，也可以使用二分查找等其他更高效的查找方法，这里就不演示了，只说明下索引的基本原理。</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for (j = IndexTable[i].start; j &lt; IndexTable[i].start + IndexTable[i].length; j++)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (MainTable[j] == key)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return j;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; //索引表中不存在该索引项</p><p>&nbsp; &nbsp; return -1;</p><p>}</p><p><br/></p><p>/**</p><p>&nbsp;* 插入数据</p><p>&nbsp;* @param key 给定值</p><p>&nbsp;* @return 0,插入成功,返回-1表示索引表中不存在该索引项</p><p>&nbsp;*/</p><p>int Insert(int key)</p><p>{</p><p>&nbsp; &nbsp; int i = 0;</p><p>&nbsp; &nbsp; int index = hashindex(key); // 求索引编号</p><p><br/></p><p>&nbsp; &nbsp; //遍历索引表,找到对应的索引项</p><p>&nbsp; &nbsp; for (i = 0; i &lt; IndexLength; i++)</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if (IndexTable[i].index == index)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //依索引项将值插入到主表中，这里为了降低复杂度，只演示了在末尾追加数据。</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MainTable[IndexTable[i].start + IndexTable[i].length] = key;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //更新索引表</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IndexTable[i].length++;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 0;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; //索引表中不存在该索引项</p><p>&nbsp; &nbsp; return -1;</p><p>}</p><p><br/></p><p>int main()</p><p>{</p><p>&nbsp; &nbsp; int test[20] = {177,202,189,123,111,302,201,203,301,204,303,100};</p><p>&nbsp; &nbsp; int testlen = 12;</p><p>&nbsp; &nbsp; int value = 245;</p><p>&nbsp; &nbsp; int i = 0;</p><p>&nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; printf(&quot;================= initial ===================\\n&quot;);</p><p>&nbsp; &nbsp; printf(&quot;initial datas:\\t&quot;);</p><p>&nbsp; &nbsp; for(i = 0; i &lt; testlen; i++){</p><p>&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;%d\\t&quot;, test[i]);</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; CreateIndex(test, testlen);</p><p>&nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; printf(&quot;\\nMain table:&quot;);</p><p>&nbsp; &nbsp; for(i = 0; i &lt; MainLength; i++){</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if(0 == i % 10)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;\\n&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;%d\\t&quot;, MainTable[i]);</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; printf(&quot;\\nIndex table:\\n&quot;);</p><p>&nbsp; &nbsp; for(i = 0; i &lt; IndexLength; i++){</p><p>&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;{index=%d, start=%d, length=%d}\\n&quot;, IndexTable[i].index, IndexTable[i].start, IndexTable[i].length);</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; printf(&quot;\\n================= insert ===================\\n&quot;);</p><p>&nbsp; &nbsp; printf(&quot;insert value:\\t%d\\n&quot;, value);</p><p>&nbsp; &nbsp; //插入成功</p><p>&nbsp; &nbsp; if (0 == Insert(value))</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;inserted Main table:&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for(i = 0; i &lt; MainLength; i++){</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(0 == i % 10)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;\\n&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;%d\\t&quot;, MainTable[i]);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;\\ninserted Index table:\\n&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for(i = 0; i &lt; IndexLength; i++){</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;{index=%d, start=%d, length=%d}\\n&quot;, IndexTable[i].index, IndexTable[i].start, IndexTable[i].length);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;\\nthe index of %d is:\\t%d\\n&quot;, value, IndexSearch(value));</p><p>&nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;inserted Main table:&quot;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for(i = 0; i &lt; MainLength; i++){</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf(&quot;%d\\t&quot;, MainTable[i]);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; return 0;</p><p>}</p><p>================= initial ===================</p><p>initial datas:<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>177<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>202<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>189<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>123<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>111<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>302<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>201<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>203<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>301<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>204<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>303<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>100<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span></p><p>Main table:</p><p>177<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>189<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>123<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>111<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>100<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span></p><p>202<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>201<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>203<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>204<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span></p><p>302<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>301<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>303<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span></p><p>Index table:</p><p>{index=1, start=0, length=5}</p><p>{index=2, start=10, length=4}</p><p>{index=3, start=20, length=3}</p><p><br/></p><p>================= insert ===================</p><p>insert value:<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>245</p><p>inserted Main table:</p><p>177<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>189<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>123<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>111<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>100<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span></p><p>202<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>201<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>203<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>204<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span><span style=\"color: rgb(255, 0, 0);\">245</span><span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span></p><p>302<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>301<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>303<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span></p><p>inserted Index table:</p><p>{index=1, start=0, length=5}</p><p>{index=2, start=10, length=<span style=\"color: rgb(255, 0, 0);\">5</span>}</p><p>{index=3, start=20, length=3}</p><p><br/></p><p>the index of 245 is:<span class=\"Apple-tab-span\" style=\"white-space:pre\">	</span>14</p><p>inserted Main table:177<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>189<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>123<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>111<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>100<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>202<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>201<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>203<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>204<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span><span style=\"color: rgb(255, 0, 0);\">245</span><span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>302<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>301<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>303<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0<span class=\"Apple-tab-span\" style=\"white-space: pre;\">	</span>0</p><p><br/></p><p><span id=\"_baidu_bookmark_end_12\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_9\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_6\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_3\" style=\"display: none; line-height: 0px;\">‍</span></p>', ',技术,', '36', '0', '2015-11-07 16:17:47', '2015-11-07 16:31:44', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('29', '1', '计算比特币发行量总额', '', '', '0', '以下C代码用于计算比特币发行量总额\r\n```\r\n#include <stdio.h>\r\n#include <math.h>\r\n\r\nint main(){\r\n    long btc = 50 * pow(10, 8); // 初始，每个块奖励 50*10^8 聪 (1BTC = 10^8聪)\r\n    long total_btc = 0;\r\n    int interval = 210000; // 每隔 210000 块，比特币奖励减半\r\n    while(btc > 0){\r\n        total_btc += interval * btc;\r\n        btc /= 2;\r\n    }\r\n    printf(\"BTC总量:%ld聪\\n\", total_btc);\r\n}\r\n```\r\n运行输出结果 BTC总量:2099999997690000聪\r\n\r\n', ',比特币,技术,', '28', '0', '2016-02-22 15:06:17', '2016-09-09 23:33:00', '0', '/static/upload/defaultcover.png', '0', null);
INSERT INTO `tb_post` VALUES ('30', '1', '正态分布,python实现', '', '', '0', '<p style=\"text-indent:29px\"><span style=\"color:green\"># coding=utf-8</span></p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\"><strong><span style=\"color:blue\">import</span></strong> numpy <strong><span style=\"color:blue\">as</span></strong> np</p><p style=\"text-indent:29px\"><strong><span style=\"color:blue\">from</span></strong> scipy <strong><span style=\"color:blue\">import</span></strong> stats</p><p style=\"text-indent:29px\"><strong><span style=\"color:blue\">import</span></strong> matplotlib<strong><span style=\"color:navy\">.</span></strong>pyplot <strong><span style=\"color:blue\">as</span></strong> plt</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">n <strong><span style=\"color:navy\">=</span></strong> <span style=\"color:red\">10</span></p><p style=\"text-indent:29px\">p <strong><span style=\"color:navy\">=</span></strong> <span style=\"color:red\">0.3</span></p><p style=\"text-indent:29px\">k <strong><span style=\"color:navy\">=</span></strong> np<strong><span style=\"color:navy\">.</span></strong>arange<strong><span style=\"color:navy\">(</span></strong><span style=\"color:red\">0</span><strong><span style=\"color:navy\">,</span></strong><span style=\"color:red\">21</span><strong><span style=\"color:navy\">)</span></strong></p><p style=\"text-indent:29px\">binomial <strong><span style=\"color:navy\">=</span></strong> stats<strong><span style=\"color:navy\">.</span></strong>binom<strong><span style=\"color:navy\">.</span></strong>pmf<strong><span style=\"color:navy\">(</span></strong>k<strong><span style=\"color:navy\">,</span></strong> n<strong><span style=\"color:navy\">,</span></strong> p<strong><span style=\"color:navy\">)</span></strong></p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">plt<strong><span style=\"color:navy\">.</span></strong>plot<strong><span style=\"color:navy\">(</span></strong>k<strong><span style=\"color:navy\">,</span></strong> binomial<strong><span style=\"color:navy\">,</span></strong> <span style=\"color:gray\">&#39;o-&#39;</span><strong><span style=\"color:navy\">)</span></strong></p><p style=\"text-indent:29px\">plt<strong><span style=\"color:navy\">.</span></strong>title<strong><span style=\"color:navy\">(</span></strong><span style=\"color:gray\">&#39;Binomial: n=%i, p=%.2f&#39;</span> <strong><span style=\"color:navy\">%</span></strong> <strong><span style=\"color:navy\">(</span></strong>n<strong><span style=\"color:navy\">,</span></strong> p<strong><span style=\"color:navy\">),</span></strong> fontsize<strong><span style=\"color:navy\">=</span></strong><span style=\"color:red\">15</span><strong><span style=\"color:navy\">)</span></strong></p><p style=\"text-indent:29px\">plt<strong><span style=\"color:navy\">.</span></strong>xlabel<strong><span style=\"color:navy\">(</span></strong><span style=\"color:gray\">&#39;Number of successes&#39;</span><strong><span style=\"color:navy\">)</span></strong></p><p style=\"text-indent:29px\">plt<strong><span style=\"color:navy\">.</span></strong>ylabel<strong><span style=\"color:navy\">(</span></strong><span style=\"color:gray\">&#39;Probability of successes&#39;</span><strong><span style=\"color:navy\">,</span></strong> fontsize<strong><span style=\"color:navy\">=</span></strong><span style=\"color:red\">15</span><strong><span style=\"color:navy\">)</span></strong></p><p style=\"text-indent:29px\">plt<strong><span style=\"color:navy\">.</span></strong>show<strong><span style=\"color:navy\">()</span></strong></p><p><br/></p>', ',技术,', '18', '0', '2016-02-23 12:50:02', '2016-02-23 12:57:59', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('31', '1', '对”堆”的理解', '', '', '0', '<p>CSDN同步文章：http://blog.csdn.net/socho/article/details/51565498</p><p>堆是一种特殊的完全二叉树，至于什么是完全二叉树自己搜吧。这里就不讲了，看图：&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style=\"font-size: 14px; line-height: 21px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"font-size: 14px; line-height: 21px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"font-size: 14px; line-height: 21px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"font-size: 14px; line-height: 21px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"font-size: 14px; line-height: 21px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"font-size: 14px; line-height: 21px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"font-size: 14px; line-height: 21px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"font-size: 14px; line-height: 21px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"font-size: 14px; line-height: 21px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style=\"font-size: 14px; line-height: 21px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></p><p><span style=\"font-size: 14px; line-height: 21px;\"></span></p><p><br style=\"box-sizing: border-box;\"/><img src=\"http://img.blog.csdn.net/20160602130948483\" alt=\"堆的样例\" title=\"\" style=\"border: none; box-sizing: border-box; max-width: 100%;\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">如上，所有父结点都比子结点要小，符合这样特点的完全二叉树我们称为小顶堆。反之，如果所有父结点都比子结点要大，这样的完全二叉树称为大顶堆。那这一特性的实际意义是做什么呢？&nbsp;<br style=\"box-sizing: border-box;\"/>假如有12个数分别是80、7、35、24、19、50、11、2、16、25、67、97，要找出这12个数中最小的数，请问怎么办呢？最简单的方法就是将这12个数从头到尾依次扫一遍，用一个循环就可以解决。这种方法的时间复杂度是O(12)也就是O(N)，如下，灰色部分就是相关算法：&nbsp;<br style=\"box-sizing: border-box;\"/>如下，灰色部分就是相关算法：</p><pre class=\"brush:cpp;toolbar:false\">#include&nbsp;#include&nbsp;int&nbsp;main(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;A[]&nbsp;=&nbsp;{&nbsp;80,&nbsp;7,&nbsp;35,&nbsp;24,&nbsp;19,&nbsp;50,&nbsp;11,&nbsp;2,&nbsp;16,&nbsp;25,&nbsp;67,&nbsp;97};\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i&nbsp;=&nbsp;0,&nbsp;min&nbsp;=&nbsp;INT_MAX;&nbsp;//&nbsp;INT_MAX&nbsp;表示无穷大\r\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;sizeof(A)/sizeof(int);&nbsp;i++){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(A[i]&nbsp;&lt;&nbsp;min)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min&nbsp;=&nbsp;A[i];\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;%d\\n&quot;,&nbsp;min);\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">输出结果：2&nbsp;<br style=\"box-sizing: border-box;\"/>现在我们需要删除其中最小的数2，然后增加一个新数17，再次找这12个数中最小的一个数。请问该怎么办呢？按上一步的方法，扫描所有的数，找到新的最小的数，这个时间复杂度也是O(N)。假如现在有12次这样的操作（删除最小的数后并添加一个新数）。那么整个时间复杂度就是<span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-1\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 11.146em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 8.917em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.889em 1000.003em 3.203em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-2\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mn\" id=\"MathJax-Span-3\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">12</span><span class=\"mo\" id=\"MathJax-Span-4\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.231em; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">∗</span><span class=\"mi\" id=\"MathJax-Span-5\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.231em; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-6\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">(</span><span class=\"mn\" id=\"MathJax-Span-7\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">12</span><span class=\"mo\" id=\"MathJax-Span-8\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-9\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">=</span><span class=\"mi\" id=\"MathJax-Span-10\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-11\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">(</span><span class=\"mn\" id=\"MathJax-Span-12\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">144</span><span class=\"mo\" id=\"MathJax-Span-13\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.354em; overflow: hidden; width: 0px; height: 1.432em; color: rgb(255, 255, 255);\"></span></span></nobr></span>即<span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-14\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 3.889em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 3.089em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.774em 1000.003em 3.203em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-15\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-16\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-17\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-18\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 1.489em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.717em 1000.003em 2.746em -0.454em); top: -2.569em; left: 0.003em;\"><span class=\"mi\" id=\"MathJax-Span-19\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">N<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.06em;\"></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.574em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; top: -2.626em; left: 0.974em;\"><span class=\"mn\" id=\"MathJax-Span-20\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">2</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.231em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-21\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.354em; overflow: hidden; width: 0px; height: 1.575em; color: rgb(255, 255, 255);\"></span></span></nobr></span>。那有没有更好的方法呢？堆这个特殊的结构恰好能够很好地解决这个问题。&nbsp;<br style=\"box-sizing: border-box;\"/>首先我们先把这个12个数按照最小堆的要求放入一棵完全二叉树：&nbsp;<br style=\"box-sizing: border-box;\"/><img src=\"http://img.blog.csdn.net/20160602131113377\" alt=\"初始化堆\" title=\"\" style=\"border: none; box-sizing: border-box; max-width: 100%;\"/></p><blockquote style=\"box-sizing: border-box; margin: 0px 0px 1.1em; padding: 15px 20px; border-left-width: 10px; border-left-style: solid; border-left-color: rgba(128, 128, 128, 0.0745098); border-radius: 0px 5px 5px 0px; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgba(128, 128, 128, 0.0470588);\"><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.25;\"><strong style=\"box-sizing: border-box;\">注意：</strong>我们这里，堆在程序中的保存方式，是用一个线性数组来存储的，比如数组<strong style=\"box-sizing: border-box;\">A[N]</strong>。实际存储数据的时候，我们数据的排列起点是从A[1]开始的，A[0]没有使用，置空，主要是为了便于直观理解算法，降低复杂度。A[1]就是堆顶，A[i*2]就是其左孩子，A[i*2+1]就是其右孩子(i=1)。</p></blockquote><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">很显然最小的数就是堆顶A[1]位置的2。接下来，我们将堆顶的数替换为17。新数已经不符合最小堆的特性，我们需要将新增加的数调整到合适的位置。那如何调整呢？</p><h2 id=\"向下调整\" style=\"margin: 0.8em 0px; padding: 0px; box-sizing: border-box; font-weight: 100; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><a style=\"color: rgb(106, 57, 6); box-sizing: border-box;\" name=\"t1\"></a>向下调整</h2><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><img src=\"http://img.blog.csdn.net/20160602131322362\" alt=\"替换顶部为17\" title=\"\" style=\"border: none; box-sizing: border-box; max-width: 100%;\"/>&nbsp;<br style=\"box-sizing: border-box;\"/>我们需要将17与它的两个儿子7和24比较，并选择较小一个与它交换，交换之后如下。&nbsp;<br style=\"box-sizing: border-box;\"/><img src=\"http://img.blog.csdn.net/20160602131501206\" alt=\"向下调整1\" title=\"\" style=\"border: none; box-sizing: border-box; max-width: 100%;\"/>&nbsp;<br style=\"box-sizing: border-box;\"/>我们发现此时还是不符合最小堆的特性，因此还需要继续向下调整。于是继续将17与它的两个儿子11和67比较，并选择较小一个交换，交换之后如下。&nbsp;<br style=\"box-sizing: border-box;\"/><img src=\"http://img.blog.csdn.net/20160602131544896\" alt=\"向下调整2\" title=\"\" style=\"border: none; box-sizing: border-box; max-width: 100%;\"/>&nbsp;<br style=\"box-sizing: border-box;\"/>到此，还是不符合最小堆的特性，仍需要继续向下调整直到符合最小堆的特性为止。&nbsp;<br style=\"box-sizing: border-box;\"/><img src=\"http://img.blog.csdn.net/20160602131615771\" alt=\"向下调整3\" title=\"\" style=\"border: none; box-sizing: border-box; max-width: 100%;\"/>&nbsp;<br style=\"box-sizing: border-box;\"/>我们发现现在已经符合最小堆的特性了。综上所述，当新增加一个数被放置到堆顶时，如果此时不符合最小堆的特性，则将需要将这个数向下调整，直到找到合适的位置为止，使其重新符合最小堆的特性。&nbsp;<br style=\"box-sizing: border-box;\"/><img src=\"http://img.blog.csdn.net/20160602131704317\" alt=\"向下调整路径描绘\" title=\"\" style=\"border: none; box-sizing: border-box; max-width: 100%;\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">向下调整的代码如下，godown函数是调整的实现：</p><pre class=\"brush:cpp;toolbar:false\">#include&nbsp;#define&nbsp;N&nbsp;12\r\nvoid&nbsp;printHeap(int&nbsp;A[]){\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------%d-----------\\n&quot;,&nbsp;A[1]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----%d----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----%d----\\n&quot;,&nbsp;A[2],&nbsp;A[3]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;--%d--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---%d---&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---%d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%d\\n&quot;,&nbsp;A[4],&nbsp;A[5],&nbsp;A[6],&nbsp;A[7]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\&nbsp;&nbsp;&nbsp;/\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;%d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%d&nbsp;%d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%d&nbsp;%d\\n&quot;,&nbsp;A[8],&nbsp;A[9],&nbsp;A[10],&nbsp;A[11]&nbsp;,&nbsp;A[12]);\r\n}\r\nvoid&nbsp;swap(int&nbsp;A[],&nbsp;int&nbsp;t,&nbsp;int&nbsp;i){\r\n&nbsp;&nbsp;&nbsp;&nbsp;A[t]&nbsp;=&nbsp;A[t]&nbsp;^&nbsp;A[i];\r\n&nbsp;&nbsp;&nbsp;&nbsp;A[i]&nbsp;=&nbsp;A[t]&nbsp;^&nbsp;A[i];\r\n&nbsp;&nbsp;&nbsp;&nbsp;A[t]&nbsp;=&nbsp;A[i]&nbsp;^&nbsp;A[t];\r\n}\r\n/*&nbsp;向下调整。\r\n&nbsp;*&nbsp;@param&nbsp;A&nbsp;堆的线性存储方式，数组\r\n&nbsp;*&nbsp;@param&nbsp;n&nbsp;节点总数\r\n&nbsp;*&nbsp;@param&nbsp;i&nbsp;需要向下调整的节点编号\r\n&nbsp;*/\r\nvoid&nbsp;godown(int&nbsp;A[],&nbsp;int&nbsp;n,&nbsp;int&nbsp;i)&nbsp;//传入一个需要向下调整的结点编号i，这里传入1，即从堆的顶点开始向下调整&nbsp;\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;t,flag=0,count=0;//flag用来标记是否需要继续向下调整&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;//当i结点有儿子的时候（其实是至少有左儿子的情况下）并且有需要继续调整的时候循环窒执行\r\n&nbsp;&nbsp;&nbsp;&nbsp;while(&nbsp;i*2&nbsp;A[i*2]&nbsp;)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t=i*2;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t=i;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//如果他有右儿子的情况下，再对右儿子进行讨论&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(i*2+1&nbsp;&nbsp;A[i*2+1])\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t=i*2+1;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//如果发现最小的结点编号不是自己，说明子结点中有比父结点更小的&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(t!=i)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap(A,&nbsp;t,&nbsp;i);//交换\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i=t;//更新i为刚才与它交换的儿子结点的编号，便于接下来继续向下调整\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;\\n\\n第&nbsp;%d&nbsp;次调整堆：\\n&quot;,&nbsp;++count);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printHeap(A);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag=1;//则否说明当前的父结点已经比两个子结点都要小了，不需要在进行调整了,退出\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}\r\n&nbsp;\r\nint&nbsp;main(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;A[N+1]&nbsp;=&nbsp;{&nbsp;0,&nbsp;2,&nbsp;7,&nbsp;24,&nbsp;11,&nbsp;67,&nbsp;35,&nbsp;25,&nbsp;16,&nbsp;19,&nbsp;97,&nbsp;80,&nbsp;50};&nbsp;//&nbsp;这里为了直接展示调整堆算法，直接给出已经建好堆的数组，免去建堆这一步，A[0]是不使用的，堆从A[1]开始。\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;初始化堆:\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printHeap(A);\r\n&nbsp;&nbsp;&nbsp;&nbsp;A[1]&nbsp;=&nbsp;17;&nbsp;//&nbsp;测试，修改堆顶值\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;\\n\\n修改堆顶值为17:\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printHeap(A);\r\n&nbsp;&nbsp;&nbsp;&nbsp;godown(A,&nbsp;N,&nbsp;1);\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">我们刚才在对17进行调整的时候，竟然只进行了3次比较，就重新恢复了最小堆的特性。现在最小的数依然在堆顶为7。之前那种从头到尾扫描的方法需要12次比较，现在只需要3次就够了。现在每次删除最小的数并新增一个数，并求当前最小数的时间复杂度是O(3)，这恰好是<span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-46-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-22\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 5.431em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 4.346em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.889em 1000.003em 3.203em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-23\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-24\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-25\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-26\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">l</span><span class=\"mi\" id=\"MathJax-Span-27\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">o</span><span class=\"msubsup\" id=\"MathJax-Span-28\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0.974em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.946em 1000.003em 2.974em -0.511em); top: -2.569em; left: 0.003em;\"><span class=\"mi\" id=\"MathJax-Span-29\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">g<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.574em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; top: -1.997em; left: 0.517em;\"><span class=\"mn\" id=\"MathJax-Span-30\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">2</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.231em;\"></span></span></span></span><span class=\"mn\" id=\"MathJax-Span-31\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">12</span><span class=\"mo\" id=\"MathJax-Span-32\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.354em; overflow: hidden; width: 0px; height: 1.432em; color: rgb(255, 255, 255);\"></span></span></nobr></span>即<span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-47-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-33\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 5.26em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 4.174em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.889em 1000.003em 3.203em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-34\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-35\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-36\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-37\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">l</span><span class=\"mi\" id=\"MathJax-Span-38\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">o</span><span class=\"msubsup\" id=\"MathJax-Span-39\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0.974em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.946em 1000.003em 2.974em -0.511em); top: -2.569em; left: 0.003em;\"><span class=\"mi\" id=\"MathJax-Span-40\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">g<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.574em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; top: -1.997em; left: 0.517em;\"><span class=\"mn\" id=\"MathJax-Span-41\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">2</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.231em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-42\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">N<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.06em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-43\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.354em; overflow: hidden; width: 0px; height: 1.432em; color: rgb(255, 255, 255);\"></span></span></nobr></span>简写为<span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-48-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-44\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 4.689em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 3.717em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.889em 1000.003em 3.203em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-45\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-46\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-47\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-48\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">l</span><span class=\"mi\" id=\"MathJax-Span-49\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">o</span><span class=\"mi\" id=\"MathJax-Span-50\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">g<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-51\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">N<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.06em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-52\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.354em; overflow: hidden; width: 0px; height: 1.432em; color: rgb(255, 255, 255);\"></span></span></nobr></span>。假如现在有10000个数，进行1万次替换最小数的操作，使用原来扫描的方法计算机需要运行大约10000*10000=1亿次；而现在只需要<span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-49-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-53\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 5.031em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 4.003em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.946em 1000.003em 3.203em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-54\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-55\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">N<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.06em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-56\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.231em; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">∗</span><span class=\"mi\" id=\"MathJax-Span-57\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.231em; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">l</span><span class=\"mi\" id=\"MathJax-Span-58\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">o</span><span class=\"mi\" id=\"MathJax-Span-59\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">g<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-60\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">N<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.06em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.354em; overflow: hidden; width: 0px; height: 1.289em; color: rgb(255, 255, 255);\"></span></span></nobr></span>次(N=10000)，即14*10000次=14万次(214=16384，所以<span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-50-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-61\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 4.746em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 3.774em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.946em 1000.003em 3.203em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-62\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-63\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">l</span><span class=\"mi\" id=\"MathJax-Span-64\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">o</span><span class=\"mi\" id=\"MathJax-Span-65\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">g<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mn\" id=\"MathJax-Span-66\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">10000</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.354em; overflow: hidden; width: 0px; height: 1.289em; color: rgb(255, 255, 255);\"></span></span></nobr></span>的对数值大概是14)。从亿到几万的量级跨度，可是跌了不少啊，那么算下节省了 (1亿次/14万次) 约是7百多倍的计算量，这可是巨大的优化啊。&nbsp;<br style=\"box-sizing: border-box;\"/>看下上面程序的运行结果：&nbsp;<br style=\"box-sizing: border-box;\"/><img src=\"http://img.blog.csdn.net/20160602130416944\" alt=\"向下调整运行结果\" title=\"\" style=\"border: none; box-sizing: border-box; max-width: 100%;\"/></p><h2 id=\"向上调整\" style=\"margin: 0.8em 0px; padding: 0px; box-sizing: border-box; font-weight: 100; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><a style=\"color: rgb(106, 57, 6); box-sizing: border-box;\" name=\"t2\"></a>向上调整</h2><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">说到这里，如果只是想新增一个值，而不是替换或者删除最小值又该如何操作呢？即如何在原有的堆上直接插入一个新元素呢？只需要直接将新元素插入到末尾，再根据情况判断新元素是否需要上移，直到满足堆的特性为止。如果堆的大小为N（即有N个元素），那么插入一个新元素所需要的时间也是<span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-52-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-67\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 4.689em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 3.717em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.889em 1000.003em 3.203em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-68\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-69\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-70\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-71\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">l</span><span class=\"mi\" id=\"MathJax-Span-72\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">o</span><span class=\"mi\" id=\"MathJax-Span-73\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">g<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-74\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">N<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.06em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-75\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.354em; overflow: hidden; width: 0px; height: 1.432em; color: rgb(255, 255, 255);\"></span></span></nobr></span>。例如我们现在要新增一个数15。&nbsp;<br style=\"box-sizing: border-box;\"/><img src=\"http://img.blog.csdn.net/20160602132345422\" alt=\"向上调整路径图\" title=\"\" style=\"border: none; box-sizing: border-box; max-width: 100%;\"/>&nbsp;<br style=\"box-sizing: border-box;\"/>先将15与它的父结点35比较，发现比父结点小，为了维护最小堆的特性，需要与父结点的值进行交换。交换之后发现还是要比它此时的父结点24小，因此需要再次与父结点交换。至此又重新满足了最小堆的特性。向上调整完毕后如下。&nbsp;<br style=\"box-sizing: border-box;\"/><img src=\"http://img.blog.csdn.net/20160602132431205\" alt=\"向上调整结果图\" title=\"\" style=\"border: none; box-sizing: border-box; max-width: 100%;\"/></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">向上调整的代码goup函数如下。：</p><pre class=\"brush:cpp;toolbar:false\">#include&nbsp;#define&nbsp;N&nbsp;13\r\nvoid&nbsp;printHeap(int&nbsp;A[]){\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------%d-----------\\n&quot;,&nbsp;A[1]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----%d-----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----%d----\\n&quot;,&nbsp;A[2],&nbsp;A[3]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;--%d--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---%d---&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---%d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%d\\n&quot;,&nbsp;A[4],&nbsp;A[5],&nbsp;A[6],&nbsp;A[7]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\&nbsp;&nbsp;&nbsp;/\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;%d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%d&nbsp;%d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%d&nbsp;%d\\n&quot;,&nbsp;A[8],&nbsp;A[9],&nbsp;A[10],&nbsp;A[11]&nbsp;,&nbsp;A[12]);\r\n}\r\nvoid&nbsp;printHeap1(int&nbsp;A[]){\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-----------%d-----------\\n&quot;,&nbsp;A[1]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----%d-----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----%d----\\n&quot;,&nbsp;A[2],&nbsp;A[3]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;&nbsp;--%d--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---%d---&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---%d---&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%d\\n&quot;,&nbsp;A[4],&nbsp;A[5],&nbsp;A[6],&nbsp;A[7]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\&nbsp;&nbsp;&nbsp;/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\\\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;%d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%d&nbsp;%d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%d&nbsp;%d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%d\\n&quot;,&nbsp;A[8],&nbsp;A[9],&nbsp;A[10],&nbsp;A[11]&nbsp;,&nbsp;A[12],&nbsp;A[13]);\r\n}\r\nvoid&nbsp;swap(int&nbsp;A[],&nbsp;int&nbsp;t,&nbsp;int&nbsp;i){\r\n&nbsp;&nbsp;&nbsp;&nbsp;A[t]&nbsp;=&nbsp;A[t]&nbsp;^&nbsp;A[i];\r\n&nbsp;&nbsp;&nbsp;&nbsp;A[i]&nbsp;=&nbsp;A[t]&nbsp;^&nbsp;A[i];\r\n&nbsp;&nbsp;&nbsp;&nbsp;A[t]&nbsp;=&nbsp;A[i]&nbsp;^&nbsp;A[t];\r\n}\r\n/*&nbsp;向上调整。\r\n&nbsp;*&nbsp;@param&nbsp;A&nbsp;堆的线性存储方式，数组\r\n&nbsp;*&nbsp;@param&nbsp;n&nbsp;节点总数\r\n&nbsp;*&nbsp;@param&nbsp;i&nbsp;需要向上调整的节点编号\r\n&nbsp;*/\r\nvoid&nbsp;goup(int&nbsp;A[],&nbsp;int&nbsp;n,&nbsp;int&nbsp;i)&nbsp;//传入一个需要向上调整的结点编号i\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;flag=0,&nbsp;count&nbsp;=&nbsp;0;&nbsp;//&nbsp;flag用来标记是否需要继续向上调整\r\n&nbsp;&nbsp;&nbsp;&nbsp;if(1&nbsp;==&nbsp;i)&nbsp;&nbsp;return;&nbsp;//如果是堆顶，就返回，不需要调整了&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;//不在堆顶&nbsp;并且&nbsp;当前结点i的值比父结点小的时候继续向上调整&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;while(i!=1&nbsp;&amp;&amp;&nbsp;flag==0)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//判断是否比父结点的小&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(A[i]&lt;A[i/2])&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;swap(A,&nbsp;i,&nbsp;i/2);//交换和父节点的位置\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;\\n\\n第&nbsp;%d&nbsp;次调整堆：\\n&quot;,&nbsp;++count);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printHeap1(A);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag=1;//表示已经不需要调整了，当前结点的值比父结点的值要大&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i=i/2;&nbsp;//更新编号i为它父结点的编号，从而便于下一次继续向上调整&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}\r\n&nbsp;\r\n&nbsp;\r\nint&nbsp;main(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;A[N+1]&nbsp;=&nbsp;{&nbsp;0,&nbsp;2,&nbsp;7,&nbsp;24,&nbsp;11,&nbsp;67,&nbsp;35,&nbsp;25,&nbsp;16,&nbsp;19,&nbsp;97,&nbsp;80,&nbsp;50};&nbsp;//&nbsp;这里为了直接展示调整堆算法，直接给出已经建好堆的数组，免去建堆这一步，A[0]是不使用的，堆从A[1]开始。\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;初始化堆:\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printHeap(A);\r\n&nbsp;&nbsp;&nbsp;&nbsp;A[13]&nbsp;=&nbsp;15;&nbsp;//&nbsp;测试，堆尾增加值\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;\\n\\n堆尾增加一个15:\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printHeap1(A);\r\n&nbsp;&nbsp;&nbsp;&nbsp;goup(A,&nbsp;N,&nbsp;13);\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">运行结果：&nbsp;<br style=\"box-sizing: border-box;\"/><img src=\"http://img.blog.csdn.net/20160602130243738\" alt=\"向上调整运行结果\" title=\"\" style=\"border: none; box-sizing: border-box; max-width: 100%;\"/></p><hr style=\"margin: 2em 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-top-style: solid; border-top-color: rgba(128, 128, 128, 0.0980392); color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><blockquote style=\"box-sizing: border-box; margin: 0px 0px 1.1em; padding: 15px 20px; border-left-width: 10px; border-left-style: solid; border-left-color: rgba(128, 128, 128, 0.0745098); border-radius: 0px 5px 5px 0px; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgba(128, 128, 128, 0.0470588);\"><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.25;\">始于2009-05-26，西理工科协；更新至2016-06-02，杭州。</p></blockquote><p><span style=\"font-size: 14px; line-height: 21px;\"><br/></span><br/></p>', ',技术,', '40', '0', '2016-06-03 12:13:15', '2016-06-03 14:13:18', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('32', '1', 'c语言实现回调函数', '', '', '0', '<p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">CSDN同步文章：<a href=\"http://blog.csdn.net/socho/article/details/51583112\" _src=\"http://blog.csdn.net/socho/article/details/51583112\">http://blog.csdn.net/socho/article/details/51583112</a></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">callback.c</p><p>/*</p><p>&nbsp;* @file c语言实现回调函数</p><p>&nbsp;* @detial 在java等更高级的语言中往往已经给我们封装好了回调函数的调用方式，直接用就可以了。</p><p>&nbsp;* 而C语言中并没有这种直接可以操作的回调方式，我们用函数指针来实现回调原理。</p><p>&nbsp;*/</p><p>#include<stdio.h></stdio.h></p><p><br/></p><p>// 将函数名作为指针的格式为：int (*ptr)(char *p) 即：返回值(指针名)(参数列表)</p><p>typedef int (*callback)(char *str); // 回调函数的名称为 callback，参数是char *p</p><p><br/></p><p>// functionA的格式符合 callback 的格式，因此可以看作是一个 callback类型</p><p>int functionA(char *str)</p><p>{</p><p>&nbsp; &nbsp; printf(&quot;回调 functionA(char *str) 函数:%s!\\n&quot;, str);</p><p>&nbsp; &nbsp; return 0;</p><p>}</p><p><br/></p><p>// functionB的格式符合 callback 的格式，因此也可以看作是一个 callback类型</p><p>int functionB(char *str)</p><p>{</p><p>&nbsp; &nbsp; printf(&quot;回调 functionB(char *str) 函数:%s!\\n&quot;, str);</p><p>&nbsp; &nbsp; return 0;</p><p>}</p><p><br/></p><p><br/></p><p><br/></p><p>// 调用回调函数，方式一：通过命名方式</p><p>int test1(callback p_callback, char *str)</p><p>{</p><p>&nbsp; &nbsp; printf(&quot;test1:\\n不调用回调函数打印:%s!\\n&quot;, str);</p><p>&nbsp; &nbsp; p_callback(str);</p><p>&nbsp; &nbsp; return 0;</p><p>}</p><p><br/></p><p>// 调用回调函数，方式二：直接通过函数指针</p><p>int test2(int (*ptr)(), char *str)</p><p>{</p><p>&nbsp; &nbsp; printf(&quot;test2:\\n不调用回调函数打印:%s!\\n&quot;, str);</p><p>&nbsp; &nbsp; (*ptr)(str);</p><p>}</p><p><br/></p><p>int main()</p><p>{</p><p>&nbsp; &nbsp; char *str = &quot;hello world!&quot;;</p><p><br/></p><p>&nbsp; &nbsp; test1(functionA, str);</p><p>&nbsp; &nbsp; test1(functionB, str);</p><p>&nbsp; &nbsp; test2(functionA, str);</p><p>&nbsp; &nbsp; test2(functionB, str);</p><p>&nbsp; &nbsp;&nbsp;</p><p><span class=\"Apple-tab-span\" style=\"white-space:pre\"></span>printf(&quot;test3:\\n&quot;);</p><p>&nbsp; &nbsp; callback test3 = functionB;</p><p>&nbsp; &nbsp; test3(str);</p><p><br/></p><p>&nbsp; &nbsp; return 0;</p><p>}</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">运行结果&nbsp;<br style=\"box-sizing: border-box;\"/>[root@centos6 data]# gcc callback.c&nbsp;<br style=\"box-sizing: border-box;\"/>[root@centos6 data]# ./a.out&nbsp;<br style=\"box-sizing: border-box;\"/>test1:&nbsp;<br style=\"box-sizing: border-box;\"/>不调用回调函数打印:hello world!!&nbsp;<br style=\"box-sizing: border-box;\"/>回调 functionA(char *str) 函数:hello world!!&nbsp;<br style=\"box-sizing: border-box;\"/>test1:&nbsp;<br style=\"box-sizing: border-box;\"/>不调用回调函数打印:hello world!!&nbsp;<br style=\"box-sizing: border-box;\"/>回调 functionB(char *str) 函数:hello world!!&nbsp;<br style=\"box-sizing: border-box;\"/>test2:&nbsp;<br style=\"box-sizing: border-box;\"/>不调用回调函数打印:hello world!!&nbsp;<br style=\"box-sizing: border-box;\"/>回调 functionA(char *str) 函数:hello world!!&nbsp;<br style=\"box-sizing: border-box;\"/>test2:&nbsp;<br style=\"box-sizing: border-box;\"/>不调用回调函数打印:hello world!!&nbsp;<br style=\"box-sizing: border-box;\"/>回调 functionB(char *str) 函数:hello world!!&nbsp;<br style=\"box-sizing: border-box;\"/>test3:&nbsp;<br style=\"box-sizing: border-box;\"/>回调 functionB(char *str) 函数:hello world!!</p><hr style=\"margin: 2em 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-top-style: solid; border-top-color: rgba(128, 128, 128, 0.0980392); color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><blockquote style=\"box-sizing: border-box; margin: 0px 0px 1.1em; padding: 15px 20px; border-left-width: 10px; border-left-style: solid; border-left-color: rgba(128, 128, 128, 0.0745098); border-radius: 0px 5px 5px 0px; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgba(128, 128, 128, 0.0470588);\"><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.25;\">始于2012-10-05，Tencent；更新至2016-06-04，杭州。</p></blockquote><p><br/></p>', ',技术,', '30', '0', '2016-06-04 10:23:15', '2016-06-04 15:12:03', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('33', '1', '冒泡排序', '', '', '0', '<span id=\"_baidu_bookmark_start_3\" style=\"display: none; line-height: 0px;\">‍</span><p>CSDN同步文章：http://blog.csdn.net/socho/article/details/51584187<span id=\"_baidu_bookmark_start_2\" style=\"display: none; line-height: 0px;\">‍</span></p><span id=\"_baidu_bookmark_end_4\" style=\"display: none; line-height: 0px;\">‍</span><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">冒泡排序（Bubble Sort）。&nbsp;<br style=\"box-sizing: border-box;\"/>[1]&nbsp;<br style=\"box-sizing: border-box;\"/><strong style=\"box-sizing: border-box;\">时间复杂度</strong>&nbsp;<br style=\"box-sizing: border-box;\"/>若文件的初始状态是正序的，一趟扫描即可完成排序。所需的关键字比较次数C和记录移动次数M均达到最小值：<span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-1\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 13.26em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 10.574em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.946em 1000.003em 3.146em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-2\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"msubsup\" id=\"MathJax-Span-3\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 2.174em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.717em 1000.003em 2.746em -0.454em); top: -2.569em; left: 0.003em;\"><span class=\"mi\" id=\"MathJax-Span-4\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">C<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.06em;\"></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.574em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; top: -1.883em; left: 0.746em;\"><span class=\"texatom\" id=\"MathJax-Span-5\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mrow\" id=\"MathJax-Span-6\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-7\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-8\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-9\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">n</span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.06em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-10\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">=</span><span class=\"mi\" id=\"MathJax-Span-11\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-12\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.231em; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">−</span><span class=\"mn\" id=\"MathJax-Span-13\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.231em; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-14\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-15\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.174em; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 2.403em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.717em 1000.003em 2.746em -0.454em); top: -2.569em; left: 0.003em;\"><span class=\"mi\" id=\"MathJax-Span-16\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">M<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.06em;\"></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.574em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; top: -1.883em; left: 1.031em;\"><span class=\"texatom\" id=\"MathJax-Span-17\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mrow\" id=\"MathJax-Span-18\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-19\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-20\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">i</span><span class=\"mi\" id=\"MathJax-Span-21\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">n</span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.06em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-22\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">=</span><span class=\"mn\" id=\"MathJax-Span-23\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">0</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.282em; overflow: hidden; width: 0px; height: 1.289em; color: rgb(255, 255, 255);\"></span></span></nobr></span>。所以，冒泡排序最好的时间复杂度为<span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-24\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 2.746em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 2.174em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.889em 1000.003em 3.203em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-25\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-26\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-27\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-28\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-29\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.354em; overflow: hidden; width: 0px; height: 1.432em; color: rgb(255, 255, 255);\"></span></span></nobr></span>。若初始文件是反序的，需要进行n - 1趟排序。每趟排序要进行n - i次关键字的比较(1≤i≤n-1)，且每次比较都必须移动记录三次来达到交换记录位置。在这种情况下，比较和移动次数均达到最大值：&nbsp;<br style=\"box-sizing: border-box;\"/><span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-30\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 12.974em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 10.346em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.489em 1000.003em 3.374em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-31\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"msubsup\" id=\"MathJax-Span-32\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 2.289em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.717em 1000.003em 2.746em -0.454em); top: -2.569em; left: 0.003em;\"><span class=\"mi\" id=\"MathJax-Span-33\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">C<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.06em;\"></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.574em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; top: -1.883em; left: 0.746em;\"><span class=\"texatom\" id=\"MathJax-Span-34\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mrow\" id=\"MathJax-Span-35\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-36\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-37\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-38\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">x</span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.06em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-39\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-40\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px 0.117em; vertical-align: 0px; width: 2.46em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px 0px 0px -1.14em; vertical-align: 0px; clip: rect(1.546em 1000.003em 2.574em -0.511em); top: -2.797em; left: 21.515625px;\"><span class=\"mrow\" id=\"MathJax-Span-41\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-42\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-43\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-44\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-45\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">−</span><span class=\"mn\" id=\"MathJax-Span-46\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-47\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.231em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px 0px 0px -0.169em; vertical-align: 0px; clip: rect(1.603em 1000.003em 2.403em -0.454em); top: -1.826em; left: 21.515625px;\"><span class=\"mn\" id=\"MathJax-Span-48\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">2</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.231em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(0.86em 1000.003em 1.26em -0.511em); top: -1.311em; left: 0.003em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 2.46em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: 0.003em; overflow: hidden; width: 0px; height: 1.25px;\"></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 1.089em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-49\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">=</span><span class=\"mi\" id=\"MathJax-Span-50\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-51\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-52\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 1.089em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.946em 1000.003em 2.746em -0.511em); top: -2.569em; left: 0.003em;\"><span class=\"mi\" id=\"MathJax-Span-53\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">n</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.574em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; top: -2.569em; left: 0.631em;\"><span class=\"mn\" id=\"MathJax-Span-54\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">2</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.231em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-55\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.568em; overflow: hidden; width: 0px; height: 2.004em; color: rgb(255, 255, 255);\"></span></span></nobr></span>&nbsp;<br style=\"box-sizing: border-box;\"/><span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-56\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 13.66em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 10.917em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.489em 1000.003em 3.374em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-57\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"msubsup\" id=\"MathJax-Span-58\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 2.517em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.717em 1000.003em 2.746em -0.454em); top: -2.569em; left: 0.003em;\"><span class=\"mi\" id=\"MathJax-Span-59\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">M<span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; overflow: hidden; height: 1px; width: 0.06em;\"></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.574em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; top: -1.883em; left: 1.031em;\"><span class=\"texatom\" id=\"MathJax-Span-60\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mrow\" id=\"MathJax-Span-61\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-62\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">m</span><span class=\"mi\" id=\"MathJax-Span-63\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">a</span><span class=\"mi\" id=\"MathJax-Span-64\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">x</span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.06em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-65\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-66\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px 0.117em; vertical-align: 0px; width: 2.803em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px 0px 0px -1.311em; vertical-align: 0px; clip: rect(1.546em 1000.003em 2.574em -0.454em); top: -2.797em; left: 24.515625px;\"><span class=\"mrow\" id=\"MathJax-Span-67\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mn\" id=\"MathJax-Span-68\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">3</span><span class=\"mi\" id=\"MathJax-Span-69\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-70\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-71\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-72\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">−</span><span class=\"mn\" id=\"MathJax-Span-73\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-74\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.231em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px 0px 0px -0.169em; vertical-align: 0px; clip: rect(1.603em 1000.003em 2.403em -0.454em); top: -1.826em; left: 24.515625px;\"><span class=\"mn\" id=\"MathJax-Span-75\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">2</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.231em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(0.86em 1000.003em 1.26em -0.511em); top: -1.311em; left: 0.003em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 2.803em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: 0.003em; overflow: hidden; width: 0px; height: 1.25px;\"></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 1.089em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-76\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">=</span><span class=\"mi\" id=\"MathJax-Span-77\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px 0px 0px 0.289em; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-78\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-79\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 1.089em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.946em 1000.003em 2.746em -0.511em); top: -2.569em; left: 0.003em;\"><span class=\"mi\" id=\"MathJax-Span-80\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">n</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.574em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; top: -2.569em; left: 0.631em;\"><span class=\"mn\" id=\"MathJax-Span-81\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">2</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.231em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-82\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.568em; overflow: hidden; width: 0px; height: 2.004em; color: rgb(255, 255, 255);\"></span></span></nobr></span>&nbsp;<br style=\"box-sizing: border-box;\"/>冒泡排序的最坏时间复杂度为<span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-83\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 3.374em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 2.689em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.774em 1000.003em 3.203em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-84\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-85\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-86\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-87\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 1.089em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.946em 1000.003em 2.746em -0.511em); top: -2.569em; left: 0.003em;\"><span class=\"mi\" id=\"MathJax-Span-88\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">n</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.574em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; top: -2.569em; left: 0.631em;\"><span class=\"mn\" id=\"MathJax-Span-89\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">2</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.231em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-90\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.354em; overflow: hidden; width: 0px; height: 1.504em; color: rgb(255, 255, 255);\"></span></span></nobr></span>&nbsp;<br style=\"box-sizing: border-box;\"/>综上，因此冒泡排序总的平均时间复杂度为<span class=\"MathJax_Preview\" style=\"color: rgb(136, 136, 136); box-sizing: border-box;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" role=\"textbox\" aria-readonly=\"true\" style=\"display: inline; line-height: normal; word-spacing: normal; word-wrap: normal; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; box-sizing: border-box;\"><nobr style=\"transition: none; box-sizing: border-box; border: 0px; padding: 0px; margin: 0px; max-width: none; max-height: none; min-width: 0px; min-height: 0px; vertical-align: 0px;\"><span class=\"math\" id=\"MathJax-Span-91\" style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 3.374em;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 2.689em; height: 0px; font-size: 17.5px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.774em 1000.003em 3.203em -0.454em); top: -2.797em; left: 0.003em;\"><span class=\"mrow\" id=\"MathJax-Span-92\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span class=\"mi\" id=\"MathJax-Span-93\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-94\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-95\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px;\"><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: relative; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 1.089em; height: 0px;\"><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; clip: rect(1.946em 1000.003em 2.746em -0.511em); top: -2.569em; left: 0.003em;\"><span class=\"mi\" id=\"MathJax-Span-96\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Math-italic;\">n</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.574em;\"></span></span><span style=\"transition: none; box-sizing: border-box; position: absolute; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; top: -2.569em; left: 0.631em;\"><span class=\"mn\" id=\"MathJax-Span-97\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-size: 12.3725004196167px; font-family: MathJax_Main;\">2</span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.231em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-98\" style=\"transition: none; box-sizing: border-box; display: inline; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; font-family: MathJax_Main;\">)</span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border: 0px; padding: 0px; margin: 0px; vertical-align: 0px; width: 0px; height: 2.803em;\"></span></span></span><span style=\"transition: none; box-sizing: border-box; display: inline-block; position: static; border-width: 0px 0px 0px 0.004em; border-left-style: solid; border-color: initial; padding: 0px; margin: 0px; vertical-align: -0.354em; overflow: hidden; width: 0px; height: 1.504em; color: rgb(255, 255, 255);\"></span></span></nobr></span>&nbsp;<br style=\"box-sizing: border-box;\"/><strong style=\"box-sizing: border-box;\">算法稳定性</strong>&nbsp;<br style=\"box-sizing: border-box;\"/>冒泡排序就是把小的元素往前调或者把大的元素往后调。比较是相邻的两个元素比较，交换也发生在这两个元素之间。所以，如果两个元素相等，不用交换；如果两个相等的元素没有相邻，那么即使通过前面的两两交换把两个相邻起来，这时候也不会交换，所以相同元素的前后顺序并没有改变，所以冒泡排序是一种稳定排序算法。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">C语言实现</p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">#include</span> <span style=\"font-size:14px;color:#A31515;background:white;background: white\"><stdio.h></stdio.h></span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">#define</span><span style=\"font-size: 14px;background: white\"> SIZE 9</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">void</span><span style=\"font-size: 14px;background: white\"> printArr(</span><span style=\"font-size:14px;color:blue;background: white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> arr[], </span><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> n)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">{</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> i;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\"> (i = 0; i &lt; n; i++)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;%d &quot;</span><span style=\"font-size: 14px;background: white\">, arr[i]);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">/*</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">交换</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">void</span><span style=\"font-size: 14px;background: white\"> swap(</span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> arr[], </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> i, </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> j)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">{</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; arr[i] = arr[i] ^ arr[j];</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; arr[j] = arr[i] ^ arr[j];</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; arr[i] = arr[j] ^ arr[i];</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">/*</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* @param arr </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">待排序的数组</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* @param n </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">数组大小</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">void</span><span style=\"font-size: 14px;background: white\"> bubble_sort(</span><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> arr[], </span><span style=\"font-size: 14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> n)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">{</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> i, j;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\"> (j = 0; j &lt; n - 1; j++) </span><span style=\"font-size:14px;color:green;background:white;background:white\">// </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">针对所有的元素重复向后扫描的步骤，除了最后一个。</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\"> (i = 0; i &lt; n - 1 - j; i++) </span><span style=\"font-size:14px;color:green;background:white;background:white\">// </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">对每一对相邻元素作比较，从开始第一对到结尾</span><span style=\"font-size:14px;color:green;background:white;background: white\"> n - 1 - j </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">的最后一对。将最大的数冒泡漂移到最后，所以最后的元素就是是最大的数。</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\">(arr[i] &gt; arr[i + 1]) </span><span style=\"font-size:14px;color:green;background:white;background:white\">// </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">比较相邻的元素。如果第一个比第二个大，就交换他们两个。</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; swap(arr, i, i+1);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">// </span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">输出日志</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">第</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">%d</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">次扫描，将最大的数</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">%d</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">冒泡到位置</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">arr[%d]</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">，共对比</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">%d</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">次</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">:\\n&quot;</span><span style=\"font-size: 14px;background: white\">, j+1, arr[n-1-j], n-1-j, n-1-j);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printArr(arr, n);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;\\n\\n&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> main()</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">{</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> number[SIZE] = {101, -1, 16, 87, 84, 0, 25, 11, 2};</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> i;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">原序列</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">:\\n&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printArr(number, SIZE);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;\\n\\n&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; bubble_sort(number, SIZE);</span></p><p><span style=\"font-size: 14px;line-height: 150%;font-family: &#39;Times New Roman&#39;, serif;background: white\">}</span></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">运行结果&nbsp;<br style=\"box-sizing: border-box;\"/>[root@centos6 data]# gcc test.c&nbsp;<br style=\"box-sizing: border-box;\"/>[root@centos6 data]# ./a.out&nbsp;<br style=\"box-sizing: border-box;\"/>原序列:&nbsp;<br style=\"box-sizing: border-box;\"/>101 -1 16 87 84 0 25 11 2</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">第1次扫描，将最大的数101冒泡到位置arr[8]，共对比8次:&nbsp;<br style=\"box-sizing: border-box;\"/>-1 16 87 84 0 25 11 2&nbsp;<strong style=\"box-sizing: border-box;\">101</strong></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">第2次扫描，将最大的数87冒泡到位置arr[7]，共对比7次:&nbsp;<br style=\"box-sizing: border-box;\"/>-1 16 84 0 25 11 2&nbsp;<strong style=\"box-sizing: border-box;\">87 101</strong></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">第3次扫描，将最大的数84冒泡到位置arr[6]，共对比6次:&nbsp;<br style=\"box-sizing: border-box;\"/>-1 16 0 25 11 2&nbsp;<strong style=\"box-sizing: border-box;\">84 87 101</strong></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">第4次扫描，将最大的数25冒泡到位置arr[5]，共对比5次:&nbsp;<br style=\"box-sizing: border-box;\"/>-1 0 16 11 2&nbsp;<strong style=\"box-sizing: border-box;\">25 84 87 101</strong></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">第5次扫描，将最大的数16冒泡到位置arr[4]，共对比4次:&nbsp;<br style=\"box-sizing: border-box;\"/>-1 0 11 2&nbsp;<strong style=\"box-sizing: border-box;\">16 25 84 87 101</strong></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">第6次扫描，将最大的数11冒泡到位置arr[3]，共对比3次:&nbsp;<br style=\"box-sizing: border-box;\"/>-1 0 2&nbsp;<strong style=\"box-sizing: border-box;\">11 16 25 84 87 101</strong></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">第7次扫描，将最大的数2冒泡到位置arr[2]，共对比2次:&nbsp;<br style=\"box-sizing: border-box;\"/>-1 0&nbsp;<strong style=\"box-sizing: border-box;\">2 11 16 25 84 87 101</strong></p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">第8次扫描，将最大的数0冒泡到位置arr[1]，共对比1次:&nbsp;<br style=\"box-sizing: border-box;\"/>-1&nbsp;<strong style=\"box-sizing: border-box;\">0 2 11 16 25 84 87 101</strong></p><hr style=\"margin: 2em 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-top-style: solid; border-top-color: rgba(128, 128, 128, 0.0980392); color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><blockquote style=\"box-sizing: border-box; margin: 0px 0px 1.1em; padding: 15px 20px; border-left-width: 10px; border-left-style: solid; border-left-color: rgba(128, 128, 128, 0.0745098); border-radius: 0px 5px 5px 0px; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgba(128, 128, 128, 0.0470588);\"><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.25;\">冒泡排序(1) ．数据结构．2014-03-20[引用日期2008-09-26]&nbsp;<br style=\"box-sizing: border-box;\"/>始于2008-09-26，西理工；更新至2016-06-04，杭州。</p></blockquote><p><br/></p>', ',技术,', '16', '0', '2016-06-04 15:12:38', '2016-06-04 18:28:55', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('34', '1', '索引查找', '', '', '0', '<span id=\"_baidu_bookmark_start_2\" style=\"display: none; line-height: 0px;\">‍</span><p style=\"text-indent: 0em;\"><span style=\"font-family:宋体;background:white\"><span id=\"_baidu_bookmark_start_1\" style=\"display: none; line-height: 0px;\">‍</span>CSDN同步文章：http://blog.csdn.net/socho/article/details/51585522</span></p><span id=\"_baidu_bookmark_end_3\" style=\"display: none; line-height: 0px;\">‍</span><p style=\"text-indent:29px\"><span style=\"font-family:宋体;background:white\">索引查找是在索引表和主表上进行的查找，主表是线性表。先按照给定的哈希算法</span><span style=\"background:white\">(</span><span style=\"font-family:宋体;background:white\">比如</span><span style=\"background:white\">value%100)</span><span style=\"font-family: 宋体;background:white\">对每一个</span><span style=\"background:white\">value</span><span style=\"font-family:宋体;background:white\">做哈希运算，将</span><span style=\"background:white\">value</span><span style=\"font-family:宋体;background:white\">映射到不同的数据段中</span><span style=\"background:white\">(</span><span style=\"font-family:宋体;background:white\">以模</span><span style=\"background:white\">100</span><span style=\"font-family:宋体;background:white\">为单位</span><span style=\"background:white\">)</span><span style=\"font-family:宋体;background:white\">，这样每隔</span><span style=\"background:white\">100</span><span style=\"font-family:宋体;background:white\">个数段的区间就被一个哈希值做的索引映射到，以这种方式创建主表，同时创建一个索引表，记录每个</span><span style=\"background:white\">100</span><span style=\"font-family:宋体;background:white\">个数区间的索引编号、起始位置、有效数据长度。在查找数据的时候，只要以同样的哈希算法先计算哈希值，直接按该值跳到对应的数据区间，这直接就将查找空间缩小了，然后在这个区间内使用常用的顺序查找、二分查找等方式找到要找的值的位置。</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">#include</span> <span style=\"font-size:14px;color:#A31515;background:white;background: white\"><stdio.h></stdio.h></span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">#define</span><span style=\"font-size: 14px;background: white\"> N 100 </span><span style=\"font-size:14px;color:green;background:white;background: white\">// </span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">主表最大长度</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">#define</span><span style=\"font-size: 14px;background: white\"> M 30 </span><span style=\"font-size:14px;color:green;background:white;background: white\">// </span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">索引表最大长度</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> ROW_WIDTH = 10;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> index_cur_len = 0; </span><span style=\"font-size:14px;color:green;background:white;background:white\">// </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">索引表当前有效索引长度</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> main_len = 0; </span><span style=\"font-size:14px;color:green;background:white;background:white\">// </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">主表长度</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">/**</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">计算索引编号的哈希函数</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">#define</span><span style=\"font-size: 14px;background: white\"> hashindex(key) key / 100</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">/**</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">索引项</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">typedef</span> <span style=\"font-size:14px;color:blue;background:white;background: white\">struct</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">{</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> index; </span><span style=\"font-size:14px;color:green;background:white;background: white\">// </span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">索引编号，按照间隔固定的每行长度</span><span style=\"font-size:14px;color:green;background:white;background: white\">index_width</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">个数据划分为一个索引段。</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> start; </span><span style=\"font-size:14px;color:green;background:white;background: white\">// </span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">索引起始位置，以此为基准搜索本行内数据，</span><span style=\"font-size:14px;color:green;background:white;background: white\">start = (index - 1) * ROW_WIDTH</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">；</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> length; </span><span style=\"font-size:14px;color:green;background:white;background:white\">// </span><span style=\"font-size: 14px;font-family:宋体;color:green;background:white;background:white\">有效数据长度</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">} IndexUnit;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">/**</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">主表</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> main_table[N] = {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">/*&nbsp; 177,189,100,123,111,0,0,0,0,0, // </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">主表固定的每行长度</span><span style=\"font-size:14px;color:green;background:white;background:white\"> ROW_WIDTH = 10</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">，后面为</span><span style=\"font-size:14px;color:green;background:white;background:white\">0</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">的代表无效数据</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;&nbsp;&nbsp; 201,202,203,204,&nbsp; 0,0,0,0,0,0,</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;&nbsp;&nbsp; 301,302,303,&nbsp; 0,&nbsp; 0,0,0,0,0,0</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">*/</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">};</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">/**</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">索引表</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">IndexUnit index_table[M] = {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">/*&nbsp; {1, 0,5}, // </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">第一行：第一列索引编号</span><span style=\"font-size:14px;color:green;background:white;background:white\">1</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">；第二列索引起始位置</span><span style=\"font-size:14px;color:green;background:white;background: white\"> 0 = (1 - 1) * 10</span><span style=\"font-size: 14px;font-family:宋体;color:green;background:white;background:white\">；第三列有效数据长度是</span><span style=\"font-size:14px;color:green;background:white;background:white\">5</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">个；</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;&nbsp;&nbsp; {2,10,4}, // </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">第二行：第一列索引编号</span><span style=\"font-size:14px;color:green;background:white;background:white\">2</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">；第二列索引起始位置</span><span style=\"font-size:14px;color:green;background:white;background: white\">10 = (2 - 1) * 10</span><span style=\"font-size: 14px;font-family:宋体;color:green;background:white;background:white\">；第三列有效数据长度是</span><span style=\"font-size:14px;color:green;background:white;background:white\">4</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">个；</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;&nbsp;&nbsp; {3,20,3}&nbsp; // </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">第三行：第一列索引编号</span><span style=\"font-size:14px;color:green;background:white;background:white\">3</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">；第二列索引起始位置</span><span style=\"font-size:14px;color:green;background:white;background:white\">20 = (3 - 1) * 10</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">；第三列有效数据长度是</span><span style=\"font-size:14px;color:green;background:white;background:white\">3</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">个；</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">*/</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">};</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">void</span><span style=\"font-size: 14px;background: white\"> create_index(</span><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> *data, </span><span style=\"font-size: 14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> length){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> i = 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> j = 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">// </span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">初始化索引表</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\"> (i = 0; i &lt; M; i++){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index_table[i].index = i + 1;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index_table[i].start = i * ROW_WIDTH;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index_table[i].length = 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">// </span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">将数据写入主表和索引表</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\"> (i = 0; i &lt; length; i++){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; j = hashindex(data[i]);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\">(j &gt; index_cur_len) </span><span style=\"font-size:14px;color:green;background:white;background:white\">//</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">记录下当前有效索引长度</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index_cur_len = j;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; main_table[index_table[j-1].start + index_table[j-1].length++] = data[i];</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; main_len = index_cur_len * ROW_WIDTH;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">/**</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">索引查找算法</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* @param key </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">给定值</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* @return </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">给定值在表中的位置</span><span style=\"font-size:14px;color:green;background:white;background:white\">,</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">返回</span><span style=\"font-size:14px;color:green;background:white;background: white\">-1</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">表示索引表中不存在该索引项</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> index_search(</span><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> key)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">{</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> i = 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> j = 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> index = hashindex(key); </span><span style=\"font-size:14px;color:green;background:white;background:white\">// </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">求索引编号</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">//</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">遍历索引表</span><span style=\"font-size:14px;color:green;background:white;background: white\">,</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">找到对应的索引项</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\"> (i = 0; i &lt; index_cur_len; i++)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">//</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">找到索引项</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\"> (index_table[i].index == index)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">//</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">在源数据中顺序查找，也可以使用二分查找等其他更高效的查找方法，这里就不演示了，只说明下索引的基本原理。</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\"> (j = index_table[i].start; j &lt; index_table[i].start + index_table[i].length; j++)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\"> (main_table[j] == key)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background: white;background:white\">return</span><span style=\"font-size: 14px;background: white\"> j;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">break</span><span style=\"font-size: 14px;background: white\">;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">//</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">索引表中不存在该索引项</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">return</span><span style=\"font-size: 14px;background: white\"> -1;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">/**</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">插入数据</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* @param key </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">给定值</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;* @return 0,</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">插入成功</span><span style=\"font-size:14px;color:green;background:white;background:white\">,</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">返回</span><span style=\"font-size:14px;color:green;background:white;background: white\">-1</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">表示索引表中不存在该索引项</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">&nbsp;*/</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> insert(</span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> key)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">{</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> i = 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> index = hashindex(key); </span><span style=\"font-size:14px;color:green;background:white;background:white\">// </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">求索引编号</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">//</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">遍历索引表</span><span style=\"font-size:14px;color:green;background:white;background: white\">,</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">找到对应的索引项</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\"> (i = 0; i &lt; index_cur_len; i++)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\"> (index_table[i].index == index)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">//</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">依索引项将值插入到主表中，这里为了降低复杂度，只演示了在末尾追加数据。</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;main_table[index_table[i].start + index_table[i].length] = key;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">//</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">更新索引表</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; index_table[i].length++;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">return</span><span style=\"font-size: 14px;background: white\"> 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">//</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">索引表中不存在该索引项</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">return</span><span style=\"font-size: 14px;background: white\"> -1;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> main()</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">{</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> test[20] = {177,202,189,123,111,302,201,203,301,204,303,100};</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> testlen = 12;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> value = 245;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> i = 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;================= initial ===================\\n&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">原数据</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">:\\t&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\">(i = 0; i &lt; testlen; i++){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;%d\\t&quot;</span><span style=\"font-size: 14px;background: white\">, test[i]);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; create_index(test, testlen);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;\\n</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">主表</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">:&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\">(i = 0; i &lt; main_len; i++){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\">(0 == i % 10)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;\\n&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;%d\\t&quot;</span><span style=\"font-size: 14px;background: white\">, main_table[i]);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;\\n</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">索引表</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">:\\n&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\">(i = 0; i &lt; index_cur_len; i++){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;{index=%d, start=%d, length=%d}\\n&quot;</span><span style=\"font-size: 14px;background: white\">, index_table[i].index, index_table[i].start, index_table[i].length);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;\\n================= insert ===================\\n&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">插入数据</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">: %d\\n&quot;</span><span style=\"font-size: 14px;background: white\">, value);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">//</span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">插入成功</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\"> (0 == insert(value))</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">插入主表</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">:&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\">(i = 0; i &lt; main_len; i++){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\">(0 == i % 10)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">&quot;\\n&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;%d\\t&quot;</span><span style=\"font-size: 14px;background: white\">, main_table[i]);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;\\n</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">更新索引表</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">:\\n&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\">(i = 0; i &lt; index_cur_len; i++){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;{index=%d, start=%d, length=%d}\\n&quot;</span><span style=\"font-size: 14px;background: white\">, index_table[i].index, index_table[i].start, index_table[i].length);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;\\n</span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">通过索引算法查找</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\"> %d </span><span style=\"font-size:14px;font-family:宋体;color:#A31515;background:white;background:white\">，在主表中的位置是</span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">:main_table[%d]\\n&quot;</span><span style=\"font-size: 14px;background: white\">, value, index_search(value));</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">return</span><span style=\"font-size: 14px;background: white\"> 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">运行结果：</span></p><p style=\"text-indent:29px\">[root@centos6 data]# gcc test.c</p><p style=\"text-indent:29px\">[root@centos6 data]# ./a.out</p><p style=\"text-indent:29px\">================= initial ===================</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">原数据</span>: 177&nbsp;&nbsp;&nbsp;&nbsp; 202&nbsp;&nbsp;&nbsp;&nbsp; 189&nbsp;&nbsp;&nbsp;&nbsp; 123&nbsp;&nbsp;&nbsp;&nbsp; 111&nbsp;&nbsp;&nbsp;&nbsp; 302&nbsp;&nbsp;&nbsp;&nbsp; 201&nbsp;&nbsp;&nbsp;&nbsp; 203&nbsp;&nbsp;&nbsp;&nbsp; 301&nbsp;&nbsp;&nbsp;&nbsp; 204&nbsp;&nbsp;&nbsp;&nbsp; 303&nbsp;&nbsp;&nbsp;&nbsp; 100</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">主表</span>:</p><p style=\"text-indent:29px\">177&nbsp;&nbsp;&nbsp;&nbsp; 189&nbsp;&nbsp;&nbsp;&nbsp; 123&nbsp;&nbsp;&nbsp;&nbsp; 111&nbsp;&nbsp;&nbsp;&nbsp; 100&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</p><p style=\"text-indent:29px\">202&nbsp;&nbsp;&nbsp;&nbsp; 201&nbsp;&nbsp;&nbsp;&nbsp; 203&nbsp;&nbsp;&nbsp;&nbsp; 204&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</p><p style=\"text-indent:29px\">302&nbsp;&nbsp;&nbsp;&nbsp; 301&nbsp;&nbsp;&nbsp;&nbsp; 303&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">索引表</span>:</p><p style=\"text-indent:29px\">{index=1, start=0, length=5}</p><p style=\"text-indent:29px\">{index=2, start=10, length=4}</p><p style=\"text-indent:29px\">{index=3, start=20, length=3}</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\">================= insert ===================</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">插入数据</span>: 245</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">插入主表</span>:</p><p style=\"text-indent:29px\">177&nbsp;&nbsp;&nbsp;&nbsp; 189&nbsp;&nbsp;&nbsp;&nbsp; 123&nbsp;&nbsp;&nbsp;&nbsp; 111&nbsp;&nbsp;&nbsp;&nbsp; 100&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</p><p style=\"text-indent:29px\">202&nbsp;&nbsp;&nbsp;&nbsp; 201&nbsp;&nbsp;&nbsp;&nbsp; 203&nbsp;&nbsp;&nbsp;&nbsp; 204&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:red\">245</span>&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</p><p style=\"text-indent:29px\">302&nbsp;&nbsp;&nbsp;&nbsp; 301 &nbsp;&nbsp;&nbsp;&nbsp;303&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">更新索引表</span>:</p><p style=\"text-indent:29px\">{index=1, start=0, length=5}</p><p style=\"text-indent:29px\">{index=2, start=10, length=<span style=\"color:red\">5</span>}</p><p style=\"text-indent:29px\">{index=3, start=20, length=3}</p><p style=\"text-indent:29px\">&nbsp;</p><p style=\"text-indent:29px\"><span style=\"font-family:宋体\">通过索引算法查找</span> 245 <span style=\"font-family:宋体\">，在主表中的位置是</span>:main_table[14]</p><p style=\"text-indent:28px\"><span style=\"font-size:14px;line-height:150%;font-family:宋体;color:#362E2B\">始于</span><span style=\"font-size:14px;line-height:150%;font-family:&#39;microsoft yahei&#39;,&#39;serif&#39;;color:#362E2B\">2012-05-13</span><span style=\"font-size:14px;line-height:150%;font-family:宋体;color:#362E2B\">，</span><span style=\"font-size: 14px;line-height:150%;font-family:&#39;microsoft yahei&#39;,&#39;serif&#39;;color:#362E2B\">Tencent</span><span style=\"font-size:14px;line-height:150%;font-family:宋体;color:#362E2B\">；更新至</span><span style=\"font-size:14px;line-height:150%;font-family:&#39;microsoft yahei&#39;,&#39;serif&#39;;color:#362E2B\">2016-06-04</span><span style=\"font-size:14px;line-height:150%;font-family:宋体;color:#362E2B\">，杭州。</span></p><p><br/></p>', ',技术,', '21', '0', '2016-06-04 18:25:30', '2016-06-04 18:28:04', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('35', '1', 'linux下如何让程序无法重复启动', '', '', '0', '<p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">同步CSDN文章：http://blog.csdn.net/socho/article/details/51586517</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">通常情况下一个程序可以被多次执行，也就存在多个相同的进程。有时候我们有些全局资源只允许单进程访问，为了不让进程多起，要实现进程在一台机器上只能有一个实例的方法。&nbsp;<br style=\"box-sizing: border-box;\"/>经查找，可以使用flock的方式，建一个lock file，让程序执行前先检查是否有执行中的实例，即对文件加锁。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">single_program.c</p><pre class=\"brush:cpp;toolbar:false\">#include&nbsp;&lt;stdio.h&gt;\r\n#include&nbsp;&lt;stdlib.h&gt;\r\n#include&nbsp;&lt;string.h&gt;\r\n#include&nbsp;&lt;sys/file.h&gt;\r\n#include&nbsp;&lt;sys/stat.h&gt;\r\n#include&nbsp;&lt;sys/types.h&gt;\r\n#include&nbsp;&lt;errno.h&gt;\r\n#include&nbsp;&lt;unistd.h&gt;\r\n\r\nint&nbsp;main()\r\n{\r\n	int&nbsp;lock_file&nbsp;=&nbsp;open(&quot;/tmp/single_proc.lock&quot;,&nbsp;O_CREAT|O_RDWR,&nbsp;0666);\r\n	int&nbsp;rc&nbsp;=&nbsp;flock(lock_file,&nbsp;LOCK_EX|LOCK_NB);\r\n	if&nbsp;(rc)\r\n	{\r\n		if&nbsp;(EWOULDBLOCK&nbsp;==&nbsp;errno)\r\n		{\r\n			printf(&quot;该实例已经运行，退出!\\n&quot;);\r\n		}\r\n	}\r\n	else\r\n	{\r\n		char&nbsp;buffer[64];\r\n		sprintf(buffer,&nbsp;&quot;pid:%d\\n&quot;,&nbsp;getpid());\r\n		write(lock_file,&nbsp;buffer,&nbsp;strlen(buffer));\r\n		printf(&quot;已启动新实例，输入任何字符退出...\\n&quot;);\r\n\r\n		scanf(&quot;%s&quot;,buffer);\r\n		printf(&quot;Exit\\n&quot;,buffer);\r\n		close(lock_file);&nbsp;//&nbsp;不要忘记释放文件指针\r\n	}\r\n	exit(0);\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">运行结果&nbsp;<br style=\"box-sizing: border-box;\"/>[root@centos6 data]# gcc single_program.c -o single_program&nbsp;<br style=\"box-sizing: border-box;\"/>[root@centos6 data]# ./single_program&nbsp;<br style=\"box-sizing: border-box;\"/>已启动新实例，输入任何字符退出…</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">以上程序会阻塞等待，然后新开一个终端，同样执行该程序&nbsp;<br style=\"box-sizing: border-box;\"/>[root@centos6 data]# ./single_program&nbsp;<br style=\"box-sizing: border-box;\"/>该实例已经运行，退出!&nbsp;<br style=\"box-sizing: border-box;\"/>[root@centos6 data]#&nbsp;<br style=\"box-sizing: border-box;\"/>可以看到程序一启动就退出了。查看锁文件&nbsp;<br style=\"box-sizing: border-box;\"/>[root@centos6 data]# cat /tmp/single_proc.lock&nbsp;<br style=\"box-sizing: border-box;\"/>pid:7162&nbsp;<br style=\"box-sizing: border-box;\"/>表明现在已经加了一个全局的锁文件，无法在启动新进程了。查看已经启动的进程&nbsp;<br style=\"box-sizing: border-box;\"/>[root@centos6 data]# ps -ef|grep -v grep|grep single_program&nbsp;<br style=\"box-sizing: border-box;\"/>root 7162 6521 0 22:13 pts/0 00:00:00 ./single_program&nbsp;<br style=\"box-sizing: border-box;\"/>确实只有一个进程，这样的方式我们可以用在一些只允许一台机器上启动单进程的特殊场景。</p><hr style=\"margin: 2em 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-top-style: solid; border-top-color: rgba(128, 128, 128, 0.0980392); color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><blockquote style=\"box-sizing: border-box; margin: 0px 0px 1.1em; padding: 15px 20px; border-left-width: 10px; border-left-style: solid; border-left-color: rgba(128, 128, 128, 0.0745098); border-radius: 0px 5px 5px 0px; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgba(128, 128, 128, 0.0470588);\"><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.25;\">始于2011-12-03，Tencent；更新至2016-06-04，杭州。</p></blockquote><p><br/></p>', ',技术,', '23', '0', '2016-06-04 22:28:48', '2016-06-04 22:34:35', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('36', '1', '排列组合 C语言实现', '', '', '0', '<p>CSDN同步文章：<a href=\"http://blog.csdn.net/socho/article/details/51586749\" _src=\"http://blog.csdn.net/socho/article/details/51586749\">http://blog.csdn.net/socho/article/details/51586749</a> </p><pre class=\"brush:cpp;toolbar:false\">#include&nbsp;&lt;stdio.h&gt;\r\n#include&nbsp;&lt;stdlib.h&gt;\r\nint&nbsp;array[]&nbsp;=&nbsp;{1,2,3,4};\r\n#define&nbsp;N&nbsp;&nbsp;4\r\n#define&nbsp;M&nbsp;&nbsp;3\r\nint&nbsp;results[N]&nbsp;=&nbsp;{0};&nbsp;//保存已经找到的结果前缀数组\r\nint&nbsp;results_end&nbsp;=&nbsp;0;&nbsp;//结果前缀数组有效数据下标\r\nint&nbsp;is_used[N]&nbsp;=&nbsp;{0};&nbsp;//是否已经排列过了的标志\r\n/**\r\n&nbsp;*&nbsp;排列\r\n&nbsp;*&nbsp;@param&nbsp;deep&nbsp;递归深度\r\n&nbsp;*&nbsp;@param&nbsp;n&nbsp;数组最大长度\r\n&nbsp;*/\r\nvoid&nbsp;perm(int&nbsp;deep,&nbsp;int&nbsp;n)\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i;\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(deep&nbsp;&gt;&nbsp;n)&nbsp;//&nbsp;越界递归结束\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(deep&nbsp;==&nbsp;n)&nbsp;//&nbsp;找到结果，打印，递归结束\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;n;&nbsp;i++)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;%d&quot;,&nbsp;results[i]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;\\t&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;n;&nbsp;i++)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(is_used[i]&nbsp;==&nbsp;0)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_used[i]&nbsp;=&nbsp;1;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results[deep]&nbsp;=&nbsp;array[i];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perm(deep+1,&nbsp;n);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_used[i]&nbsp;=&nbsp;0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}\r\n/**\r\n&nbsp;*&nbsp;组合\r\n&nbsp;*&nbsp;@param&nbsp;deep&nbsp;递归深度\r\n&nbsp;*&nbsp;@param&nbsp;n&nbsp;数组最大长度\r\n&nbsp;*&nbsp;@param&nbsp;m&nbsp;要查找的组合的长度\r\n&nbsp;*/\r\nvoid&nbsp;comb(int&nbsp;deep,&nbsp;int&nbsp;n,&nbsp;int&nbsp;m)\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i&nbsp;=&nbsp;0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(deep&nbsp;&gt;&nbsp;n)&nbsp;//&nbsp;越界递归结束\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(results_end&nbsp;==&nbsp;m)&nbsp;//&nbsp;找到结果，打印，递归结束\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;m;&nbsp;i++)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;%d&quot;,&nbsp;results[i]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;\\t&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;results[results_end++]&nbsp;=&nbsp;array[deep];\r\n&nbsp;&nbsp;&nbsp;&nbsp;comb(deep+1,&nbsp;n,&nbsp;m);&nbsp;//向下一级递归\r\n&nbsp;&nbsp;&nbsp;&nbsp;results_end--;\r\n&nbsp;&nbsp;&nbsp;&nbsp;comb(deep+1,&nbsp;n,&nbsp;m);&nbsp;//向下一级递归\r\n}\r\nint&nbsp;main()\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i&nbsp;=&nbsp;0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;全排列:\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;perm(0,&nbsp;N);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;\\n1~%d的所有组合:\\n&quot;,&nbsp;N);\r\n&nbsp;&nbsp;&nbsp;&nbsp;for(i=1;&nbsp;i&lt;=N;&nbsp;i++){\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comb(0,&nbsp;N,&nbsp;i);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">运行结果&nbsp;<br style=\"box-sizing: border-box;\"/>[root@centos6 data]# gcc test.c&nbsp;<br style=\"box-sizing: border-box;\"/>[root@centos6 data]# ./a.out&nbsp;<br style=\"box-sizing: border-box;\"/>全排列:&nbsp;<br style=\"box-sizing: border-box;\"/>1234 1243 1324 1342 1423 1432 2134 2143 2314 2341 2413 2431 3124 3142 3214 3241 3412 3421 4123 4132 4213 4231 4312 4321&nbsp;<br style=\"box-sizing: border-box;\"/>1~4的所有组合:&nbsp;<br style=\"box-sizing: border-box;\"/>1 2 3 4 12 13 14 23 24 34 123 124 134 234 1234</p><hr style=\"margin: 2em 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-top-style: solid; border-top-color: rgba(128, 128, 128, 0.0980392); color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><blockquote style=\"box-sizing: border-box; margin: 0px 0px 1.1em; padding: 15px 20px; border-left-width: 10px; border-left-style: solid; border-left-color: rgba(128, 128, 128, 0.0745098); border-radius: 0px 5px 5px 0px; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgba(128, 128, 128, 0.0470588);\"><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.25;\">始于2010-12-30，Tencent；更新至2016-06-02，杭州。</p></blockquote><p><br/></p>', ',技术,', '33', '0', '2016-06-04 23:32:31', '2016-06-04 23:33:59', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('37', '1', '快速排序', '', '', '0', '<p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">CSDN同步文章：http://blog.csdn.net/socho/article/details/51591293</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">C语言实现</span></p><pre class=\"brush:cpp;toolbar:false\">#include&nbsp;&lt;stdio.h&gt;\r\n#define&nbsp;N&nbsp;9\r\nint&nbsp;A[N]&nbsp;=&nbsp;{&nbsp;10,&nbsp;-3&nbsp;,&nbsp;28,&nbsp;76,&nbsp;37,&nbsp;55,&nbsp;-1,&nbsp;99,&nbsp;11};\r\nvoid&nbsp;printArr()\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i;\r\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;N;&nbsp;i++)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;%d&nbsp;&quot;,&nbsp;A[i]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;\\n&quot;);\r\n}\r\nvoid&nbsp;quick_sort(int&nbsp;a[],int&nbsp;numsize)&nbsp;//a是整形数组，numsize是元素个数&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i&nbsp;=&nbsp;0,&nbsp;j&nbsp;=&nbsp;numsize-1;\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;val&nbsp;=&nbsp;a[0];//指定参考值val大小\r\n&nbsp;&nbsp;&nbsp;&nbsp;if(numsize&gt;1)//确保数组长度至少为2，否则无需排序&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(i&lt;j)//循环结束条件\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(&nbsp;;&nbsp;i&nbsp;&lt;&nbsp;j;&nbsp;j--)&nbsp;//从后向前搜索比val小的元素，找到后填到a[i]中并跳出循环&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(a[j]&lt;val)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a[i]=a[j];\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;参考值%d，前&nbsp;%d的元素|&nbsp;&quot;,&nbsp;val,&nbsp;val);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printArr();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a[i]=val;&nbsp;//将保存在val中的数放到a[i]中\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;参考值%d，整理结果\\t\\t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&quot;,&nbsp;val);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printArr();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quick_sort(a,i);&nbsp;//递归，对前i个数排序&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quick_sort(a+i+1,numsize-1-i);&nbsp;//对i+1到numsize这numsize-1-i个数排序&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;\r\n}\r\nint&nbsp;main()\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;原数列|&nbsp;&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printArr();\r\n&nbsp;&nbsp;&nbsp;&nbsp;quick_sort(A,&nbsp;N);\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;\r\n}</pre><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">运行结果&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">[root@centos6 data]# gcc test.c&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">[root@centos6 data]# ./a.out&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">原数列| 10 -3 28 76 37 55 -1 99 11&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">参考值10，前 &lt;– 后 找a[j–]&lt;10的元素| -1 -3 28 76 37 55 -1 99 11&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">参考值10，前 –&gt; 后 找a[i++]&gt;10的元素| -1 -3 28 76 37 55 28 99 11&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">参考值10，整理结果 | -1 -3 10 76 37 55 28 99 11&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">参考值-1，前 &lt;– 后 找a[j–]&lt;-1的元素 | -3 -3 10 76 37 55 28 99 11&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">参考值-1，整理结果 | -3 -1 10 76 37 55 28 99 11&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">参考值76，前 &lt;– 后 找a[j–]&lt;76的元素 | -3 -1 10 11 37 55 28 99 11&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">参考值76，前 –&gt; 后 找a[i++]&gt;76的元素| -3 -1 10 11 37 55 28 99 99&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">参考值76，整理结果 | -3 -1 10 11 37 55 28 76 99&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">参考值11，整理结果 | -3 -1 10 11 37 55 28 76 99&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">参考值37，前 &lt;– 后 找a[j–]&lt;37的元素| -3 -1 10 11 28 55 28 76 99&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">参考值37，前 –&gt; 后 找a[i++]&gt;37的</span></span><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">元素| -3 -</span><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">1 10 11 28 55 55 76 99&nbsp;</span><br style=\"box-sizing: border-box; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">参考值37，整理结果 | -3 -1 10 11 28 37 55 76 99</span></span></p><p><strong>结果分析</strong></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">假设有两个指针，i指向开始，j指向结束。i从前向后运动做比较，j从后向前运动做比较，当两者交集的时候，比较结束。&nbsp;</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">1.参考值10</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">这是最开始的情况，将数组第一个元素A[0]作为参考值，另找一变量保存该值，i=0</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 0, 0);\">10</span><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\"> -3 28 76 37 55 -1 99 11</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">1&gt;后--&gt;前</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">然后，先从后往前找小于10的数，j递减，i=0,j=8</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td><span style=\"color:red\">i</span></td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td><span style=\"color:red\">j</span></td></tr><tr><td>A[N]</td><td bgcolor=\"red\">10</td><td>-3</td><td>28</td><td>76</td><td>37</td><td>55</td><td>-1</td><td>99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span id=\"_baidu_bookmark_start_17\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_19\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_21\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_23\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_25\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_27\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">11比10大，不符合条件，略过，继续向前找，i=0,j=7</span><span id=\"_baidu_bookmark_end_28\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_26\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_24\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_22\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_20\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_18\" style=\"display: none; line-height: 0px;\">‍</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td><span style=\"color:red\">i</span></td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td><span style=\"color:red\">j</span></td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"red\">10</td><td>-3</td><td>28</td><td>76</td><td>37</td><td>55</td><td>-1</td><td bgcolor=\"#7FFFD4\">99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span id=\"_baidu_bookmark_start_1\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_3\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_5\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_7\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_9\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_11\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_13\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_start_15\" style=\"display: none; line-height: 0px;\">‍</span><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">99比10大，不符合条件，略过，继续向前找，i=0,j=6</span><span id=\"_baidu_bookmark_end_16\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_14\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_12\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_10\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_8\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_6\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_4\" style=\"display: none; line-height: 0px;\">‍</span><span id=\"_baidu_bookmark_end_2\" style=\"display: none; line-height: 0px;\">‍</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td><span style=\"color:red\">i</span></td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td><span style=\"color:red\">j</span></td><td>7</td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"red\">10</td><td>-3</td><td>28</td><td>76</td><td>37</td><td>55</td><td bgcolor=\"#7FFFD4\">-1</td><td bgcolor=\"#7FFFD4\">99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">-1比10小，符合条件，将-1拷贝到参考值10的位置A[i]去，则此时A[j]位置的数据已经没有意义了，我们可以将它置0或者不管也行，将来会将别的值拷贝到此位置，i=0,j=6</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td><span style=\"color:red\">i</span></td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td width=\"0\"><span style=\"color:red\">j</span></td><td width=\"16\">7</td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"red\">-1</td><td>-3</td><td>28</td><td>76</td><td>37</td><td>55</td><td bgcolor=\"#7FFFD4\" width=\"16\"><span style=\"text-decoration: line-through;\">-1</span></td><td bgcolor=\"#7FFFD4\" width=\"16\">99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">停止当前方向查找，转向从前往后找。</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">2&gt;前--&gt;后</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">接上一步，这次以原来参考值所在位置A[0+1]，从前向后查找大于10的数，i递增，i=1,j=6</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td>0</td><td><span style=\"color:red\">i</span></td><td>2</td><td>3</td><td>4</td><td>5</td><td><span style=\"color:red\">j</span></td><td>7</td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"orange\">-1</td><td bgcolor=\"orange\">-3</td><td>28</td><td>76</td><td>37</td><td>55</td><td bgcolor=\"#7FFFD4\"><span style=\"text-decoration: line-through;\">-1</span></td><td bgcolor=\"#7FFFD4\">99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">-3比10小，不符合条件，略过，继续向后找，i=2,j=6</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td>0</td><td>1</td><td><span style=\"color:red\">i</span></td><td>3</td><td>4</td><td>5</td><td><span style=\"color:red\">j</span></td><td>7</td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"orange\">-1</td><td bgcolor=\"orange\">-3</td><td bgcolor=\"orange\">28</td><td>76</td><td>37</td><td>55</td><td bgcolor=\"#7FFFD4\"><span style=\"text-decoration: line-through;\">-1</span></td><td bgcolor=\"#7FFFD4\">99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">28比10大，符合条件，将28拷贝A[j]去，则此时A[i]位置的数据已经没有意义了，我们可以将它置0或者不管也行，将来会将别的值拷贝到此位置，i=2,j=6</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td>0</td><td>1</td><td><span style=\"color:red\">i</span></td><td>3</td><td>4</td><td>5</td><td><span style=\"color:red\">j</span></td><td>7</td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"orange\">-1</td><td bgcolor=\"orange\">-3</td><td bgcolor=\"orange\"><span style=\"text-decoration: line-through;\">28</span></td><td>76</td><td>37</td><td>55</td><td bgcolor=\"#7FFFD4\">28</td><td bgcolor=\"#7FFFD4\">99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">停止当前方向查找，此时发现i依然小于j，对参考值10的整理还没有结束。再转向从后往后前查找，直到i和j相遇为止。</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">3&gt;后--&gt;前</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">接上一步，这次从后往前找小于10的数，j递减，i=2,j=5</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td>0</td><td>1</td><td><span style=\"color:red\">i</span></td><td>3</td><td>4</td><td><span style=\"color:red\">j</span></td><td>6</td><td>7</td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"orange\">-1</td><td bgcolor=\"orange\">-3</td><td bgcolor=\"orange\"><span style=\"text-decoration: line-through;\">28</span></td><td>76</td><td>37</td><td bgcolor=\"#7FFFD4\">55</td><td bgcolor=\"#7FFFD4\">28</td><td bgcolor=\"#7FFFD4\">99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">55比10大，不符合条件，略过，继续向前找，i=2,j=4</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td>0</td><td>1</td><td><span style=\"color:red\">i</span></td><td>3</td><td><span style=\"color:red\">j</span></td><td>5</td><td>6</td><td>7</td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"orange\">-1</td><td bgcolor=\"orange\">-3</td><td bgcolor=\"orange\"><span style=\"text-decoration: line-through;\">28</span></td><td>76</td><td bgcolor=\"#7FFFD4\">37</td><td bgcolor=\"#7FFFD4\">55</td><td bgcolor=\"#7FFFD4\">28</td><td bgcolor=\"#7FFFD4\">99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">37比10大，不符合条件，略过，继续向前找，i=2,j=3</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td>0</td><td>1</td><td><span style=\"color:red\">i</span></td><td><span style=\"color:red\">j</span></td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"orange\">-1</td><td bgcolor=\"orange\">-3</td><td bgcolor=\"orange\"><span style=\"text-decoration: line-through;\">28</span></td><td bgcolor=\"#7FFFD4\">76</td><td bgcolor=\"#7FFFD4\">37</td><td bgcolor=\"#7FFFD4\">55</td><td bgcolor=\"#7FFFD4\">28</td><td bgcolor=\"#7FFFD4\">99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">76比10大，不符合条件，略过，继续向前找，i=2,j=2\r\n当i=2,j=2时，此时发现i和j相遇了，则停止查找。</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">4&gt;参考值归位</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">i和j已经相遇，将参考值10拷贝到A[i]的位置</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td>0</td><td>1</td><td style=\"word-break: break-all;\"><span style=\"color:red\">i=j</span></td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"orange\">-1</td><td bgcolor=\"orange\">-3</td><td bgcolor=\"red\">10</td><td bgcolor=\"#7FFFD4\">76</td><td bgcolor=\"#7FFFD4\">37</td><td bgcolor=\"#7FFFD4\">55</td><td bgcolor=\"#7FFFD4\">28</td><td bgcolor=\"#7FFFD4\">99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">至此，对参考值10的整理已经结束，可以看到10的左侧都是小于10的数，10的右侧都是大于10的数。\r\n这这是完成了第一轮整理，接下来，还要分两部分递归，将10的左侧{A[0]~A[1]}和10的右侧{A[3]~A[8]}作为子集，分别按以上相同的步骤递归调用函数整理。&nbsp;</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">2.参考值-1\r\n整理过程就不写了，与参考值10的过程一样，这里直接给出整理完成的结果</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"orange\">-3</td><td bgcolor=\"red\">-1</td><td bgcolor=\"#7FFFD4\">10</td><td bgcolor=\"#7FFFD4\">76</td><td bgcolor=\"#7FFFD4\">37</td><td bgcolor=\"#7FFFD4\">55</td><td bgcolor=\"#7FFFD4\">28</td><td bgcolor=\"#7FFFD4\">99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">3.参考值76</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"orange\">-3</td><td bgcolor=\"orange\">-1</td><td bgcolor=\"orange\">10</td><td bgcolor=\"red\">76</td><td bgcolor=\"#7FFFD4\">37</td><td bgcolor=\"#7FFFD4\">55</td><td bgcolor=\"#7FFFD4\">28</td><td bgcolor=\"#7FFFD4\">99</td><td bgcolor=\"#7FFFD4\">11</td></tr></tbody></table><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">4.参考值11\r\n这个没有可移动的，跳过</span></p><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">5.参考值37</span></p><table border=\"1px;\"><tbody><tr class=\"firstRow\"><td>下标</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td></tr><tr><td>A[N]</td><td bgcolor=\"orange\">-3</td><td bgcolor=\"orange\">-1</td><td bgcolor=\"orange\">10</td><td bgcolor=\"orange\">11</td><td bgcolor=\"orange\">28</td><td bgcolor=\"red\">37</td><td bgcolor=\"#7FFFD4\">55</td><td bgcolor=\"#7FFFD4\">76</td><td bgcolor=\"#7FFFD4\">99</td></tr></tbody></table><p><span style=\"color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; background-color: rgb(255, 255, 255);\">至此整个排序结束，已经是有序队列！</span></p>', ',技术,', '85', '0', '2016-06-05 23:23:39', '2016-06-14 18:03:28', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('38', '1', 'C调用graphviz绘制堆', '', '', '0', '之前的博客[《对”堆”的理解》](http://blog.csdn.net/socho/article/details/51565498 \"《对”堆”的理解》\")中打印堆是在终端中，不是很直观，发现一个可以生成图片的利器graphviz，于是用c语言调用下，程序运行中生成图片，特别直观了。\r\n以上是用终端打印出来的，发现了一个绘图利器graphviz，可以把堆画出来。安装这个软件什么的就不讲了，自己百度，这里默认已经安装好了。所以，对以上代码更新\r\n```\r\n#include <stdio.h>\r\n#define N 12\r\nvoid printHeap(int A[], char *filename, int color_point){\r\n    ///// 这里是在终端打印节点 /////\r\n    printf(&quot;            -----------%d-----------\\n&quot;, A[1]);\r\n    printf(&quot;           /                       \\\\\\n&quot;);\r\n    printf(&quot;      ----%d----               ----%d----\\n&quot;, A[2], A[3]);\r\n    printf(&quot;     /          \\\\             /          \\\\\\n&quot;);\r\n    printf(&quot;  --%d--     ---%d---     ---%d          %d\\n&quot;, A[4], A[5], A[6], A[7]);\r\n    printf(&quot; /      \\\\   /        \\\\   /\\n&quot;);\r\n    printf(&quot;%d      %d %d        %d %d\\n&quot;, A[8], A[9], A[10], A[11] , A[12]);\r\n    ///// 以下是输出到heap_*.dot文件中，供用graphicvz生成png图片节点表示法用 /////\r\n    int i = 0;\r\n    FILE* fp = fopen(filename, &quot;w+&quot;); //dot -Tpng heap.dot -o heap.png\r\n    if( NULL == fp)\r\n    {\r\n        fprintf(stderr, &quot;打开文件描述符失败\\n&quot;);\r\n        return;\r\n    }\r\n    fprintf(fp, &quot;digraph {\\n&quot;);\r\n    for ( i = 1; i &lt;= N/2; i++)\r\n    {\r\n        if (i*2 &lt;= N)\r\n        {\r\n            fprintf(fp, &quot; %llu -&gt; %llu\\n&quot;, A[i], A[i*2]) ;\r\n        } else {\r\n            fprintf(fp, &quot; %llu -&gt; null [style = dotted]\\n&quot;, A[i]); // 设置null节点连接线的属性\r\n        }\r\n        if (i*2+1 &lt;= N){\r\n            fprintf(fp, &quot; %llu -&gt; %llu\\n&quot;, A[i], A[i*2+1]);\r\n        } else {\r\n            fprintf(fp, &quot; %llu -&gt; null [style = dotted]\\n&quot;, A[i]);\r\n        }\r\n    }\r\n    if (0 != color_point) // 需要染色的节点\r\n    {\r\n        fprintf(fp, &quot;;\\n %d [color = red]\\n&quot;, color_point);\r\n    }\r\n    fprintf(fp, &quot;;\\n null [style = dotted]}\\n&quot;); // 设置null节点的属性\r\n    fclose(fp);\r\n}\r\nvoid swap(int A[], int t, int i){\r\n    A[t] = A[t] ^ A[i];\r\n    A[i] = A[t] ^ A[i];\r\n    A[t] = A[i] ^ A[t];\r\n}\r\n/* 向下调整。\r\n * @param A 堆的线性存储方式，数组\r\n * @param n 节点总数\r\n * @param i 需要向下调整的节点编号\r\n */\r\nvoid godown(int A[], int n, int i) //传入一个需要向下调整的结点编号i，这里传入1，即从堆的顶点开始向下调整 \r\n{\r\n    int t,flag=0,count=0;//flag用来标记是否需要继续向下调整 \r\n    //当i结点有儿子的时候（其实是至少有左儿子的情况下）并且有需要继续调整的时候循环窒执行\r\n    while( i*2 A[i*2] )\r\n            t=i*2;\r\n        else\r\n            t=i; \r\n        //如果他有右儿子的情况下，再对右儿子进行讨论 \r\n        if(i*2+1  A[i*2+1])\r\n                t=i*2+1;\r\n        }\r\n        //如果发现最小的结点编号不是自己，说明子结点中有比父结点更小的  \r\n        if(t!=i)\r\n        {\r\n            swap(A, t, i);//交换\r\n            i=t;//更新i为刚才与它交换的儿子结点的编号，便于接下来继续向下调整\r\n            count++;\r\n            printf(&quot;\\n\\n第 %d 次调整堆：\\n&quot;, count);\r\n            char filename[10];\r\n            sprintf(filename, &quot;heap%d.dot&quot;, count);\r\n            printHeap(A, filename, 17);\r\n        }\r\n        else\r\n            flag=1;//则否说明当前的父结点已经比两个子结点都要小了，不需要在进行调整了,退出\r\n    }\r\n}\r\nint main(){\r\n    int A[N+1] = { 0, 2, 7, 24, 11, 67, 35, 25, 16, 19, 97, 80, 50}; // 这里为了直接展示调整堆算法，直接给出已经建好堆的数组，免去建堆这一步，A[0]是不使用的，堆从A[1]开始。\r\n    printf(&quot;初始化堆:\\n&quot;);\r\n    printHeap(A, &quot;heap.dot&quot;, 0);\r\n    A[1] = 17; // 测试，修改堆顶值\r\n    printf(\"\\n\\n修改堆顶值为17:\\n\");\r\n    printHeap(A, &quot;heap0.dot&quot;, 17);\r\n    godown(A, N, 1);\r\n    return 0;\r\n}\r\n```\r\n编译gcc heap.c -o heap \r\n然后执行./heap\r\n可以看到同之前一样也在打印出堆，不过这次多生成了一些东西，在当前目录下发现了heap.dot、heap0.dot、heap1.dot、heap2.dot、heap3.dot几个文件，然后在当前目录下写一个脚本dot.sh，编辑脚本，内容如下\r\n```\r\n#!/bin/sh\r\ndot -Tpng heap.dot -o heap.png\r\ndot -Tpng heap0.dot -o heap0.png\r\ndot -Tpng heap1.dot -o heap1.png\r\ndot -Tpng heap2.dot -o heap2.png\r\ndot -Tpng heap3.dot -o heap3.png\r\n```\r\ndot是graphviz的命令，记得要把这个燃尽安装上哦。\r\n然后，执行脚本./dot.sh\r\n然后就发现生成了heap.png、heap0.png、heap1.png、heap2.png、heap3.png，分别是上面终端打印出几种形态的图片版本，例如\r\n![heap.png](http://img.blog.csdn.net/20160608202823419)\r\n![heap0.png](http://img.blog.csdn.net/20160608202838778)\r\n![heap1.png](http://img.blog.csdn.net/20160608202854107)\r\n![heap2.png](http://img.blog.csdn.net/20160608202912889)\r\n![heap3.png](http://img.blog.csdn.net/20160608202925092)\r\n', ',技术,', '31', '0', '2016-06-12 16:44:41', '2016-08-13 16:05:06', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('39', '1', 'Golang实现基于时间轮算法的定时器', '', '', '0', '关于什么是时间轮算法，自己百度吧，这里列出我用go语言实现的时间轮算法，已经上线应用，稳定。\r\n```golang\r\npackage timer\r\nimport (\r\n    \"log\"\r\n    \"sync\"\r\n    \"time\"\r\n)\r\nconst wheel_cnt uint8 = 5                                                                   //时间轮数量5个\r\nvar element_cnt_per_wheel = [wheel_cnt]uint32{256, 64, 64, 64, 64}                          //每个时间轮的槽(元素)数量。在 256+64+64+64+64 = 512 个槽中，表示的范围为 2^32\r\nvar right_shift_per_wheel = [wheel_cnt]uint32{8, 6, 6, 6, 6}                                //当指针指向当前时间轮最后一位数，再走一位就需要向上进位。每个时间轮进位的时候，使用右移的方式，最快实现进位。这里是每个轮的进位二进制位数\r\nvar base_per_wheel = [wheel_cnt]uint32{1, 256, 256 * 64, 256 * 64 * 64, 256 * 64 * 64 * 64} //记录每个时间轮指针当前指向的位置\r\nvar mutex sync.Mutex                                                                        //加锁\r\nvar rwmutex sync.RWMutex\r\nvar newest [wheel_cnt]uint32                           //每个时间轮当前指针所指向的位置\r\nvar timewheels [5][]*Node                              //定义5个时间轮\r\nvar TimerMap map[string]*Node = make(map[string]*Node) //保存待执行的计时器，方便按链表节点指针地址直接删除定时器\r\ntype Timer struct {\r\n    Name        string            //定时器名称\r\n    Inteval     uint32            //时间间隔，即以插入该定时器的时间为起点，Inteval秒之后执行回调函数DoSomething()。例如进程插入该定时器的时间是2015-04-05 10:23:00，Inteval=5，则执行DoSomething()的时间就是2015-04-05 10:23:05。\r\n    DoSomething func(interface{}) //自定义事件处理函数，需要触发的事件\r\n    Args        interface{}       //上述函数的输入参数\r\n}\r\nfunc SetTimer(name string, inteval uint32, handler func(interface{}), args interface{}) {\r\n    if inteval &lt;= 0 {\r\n        return\r\n    }\r\n    var bucket_no uint8 = 0\r\n    var offset uint32 = inteval\r\n    var left uint32 = inteval\r\n    for offset &gt;= element_cnt_per_wheel[bucket_no] { //偏移量大于当前时间轮容量，则需要向高位进位\r\n        offset &gt;&gt;= right_shift_per_wheel[bucket_no] //计算高位的值。偏移量除以低位的进制。比如低位当前是256，则右移8个二进制位，就是除以256，得到的结果是高位的值。\r\n        var tmp uint32 = 1\r\n        if bucket_no == 0 {\r\n            tmp = 0\r\n        }\r\n        left -= base_per_wheel[bucket_no] * (element_cnt_per_wheel[bucket_no] - newest[bucket_no] - tmp)\r\n        bucket_no++\r\n    }\r\n    if offset &lt; 1 {\r\n        return\r\n    }\r\n    if inteval &lt; base_per_wheel[bucket_no]*offset {\r\n        return\r\n    }\r\n    left -= base_per_wheel[bucket_no] * (offset - 1)\r\n    pos := (newest[bucket_no] + offset) % element_cnt_per_wheel[bucket_no] //通过类似hash的方式，找到在时间轮上的插入位置\r\n    var node Node\r\n    node.SetData(Timer{name, left, handler, args})\r\n    rwmutex.RLock()\r\n    TimerMap[name] = timewheels[bucket_no][pos].InsertHead(node) //插入定时器\r\n    rwmutex.RUnlock()\r\n    //fmt.Println(\"pos \", bucket_no, pos, tmp)\r\n}\r\nfunc step() {\r\n    //var dolist list.List\r\n    {\r\n        rwmutex.RLock()\r\n        //遍历所有桶\r\n        var bucket_no uint8 = 0\r\n        for bucket_no = 0; bucket_no &lt; wheel_cnt; bucket_no++ {\r\n            newest[bucket_no] = (newest[bucket_no] + 1) % element_cnt_per_wheel[bucket_no] //当前指针递增1\r\n            //fmt.Println(newest)\r\n            var head *Node = timewheels[bucket_no][newest[bucket_no]] //返回当前指针指向的槽位置的表头\r\n            var firstElement *Node = head.Next()\r\n            for firstElement != nil { //链表不为空\r\n                if value, ok := firstElement.Data().(Timer); ok { //如果element里面确实存储了Timer类型的数值，那么ok返回true，否则返回false。\r\n                    inteval := value.Inteval\r\n                    doSomething := value.DoSomething\r\n                    args := value.Args\r\n                    if nil != doSomething { //有遇到函数为nil的情况，所以这里判断下非nil\r\n                        if 0 == bucket_no || 0 == inteval {\r\n                            //dolist.PushBack(value) //执行自定义处理函数\r\n                            go doSomething(args)\r\n                        } else {\r\n                            SetTimer(value.Name, inteval, doSomething, args) //重新插入计时器\r\n                        }\r\n                    }\r\n                    Delete(firstElement) //删除定时器\r\n                }\r\n                firstElement = head.Next() //重新定位到链表第一个元素头\r\n            }\r\n            if 0 != newest[bucket_no] { //指针不是0，还未转回到原点，跳出。如果回到原点，则说明转完了一圈，需要向高位进位1，则继续循环入高位步进一步。\r\n                break\r\n            }\r\n        }\r\n        rwmutex.RUnlock()\r\n    }\r\n}\r\nfunc Run() {\r\n    var i int = 0\r\n    for {\r\n        go step()\r\n        i++\r\n        log.Printf(\"第%ds\", i)\r\n        //间隔时间inteval=1s\r\n        time.Sleep(1 * time.Second)\r\n    }\r\n}\r\nfunc init() { //初始化\r\n    var bucket_no uint8 = 0\r\n    for bucket_no = 0; bucket_no &lt; wheel_cnt; bucket_no++ {\r\n        var i uint32 = 0\r\n        for ; i &lt; element_cnt_per_wheel[bucket_no]; i++ {\r\n            timewheels[bucket_no] = append(timewheels[bucket_no], new(Node))\r\n        }\r\n    }\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">测试下效果</p><pre class=\"brush:cpp;toolbar:false\">package main\r\nimport (\r\n    \"log\"\r\n    \"runtime\"\r\n    \"timer_server/timer\"\r\n)\r\nfunc callback1(args interface{}) {\r\n    //只执行一次的事件\r\n    if values, ok := args.([]string); ok {\r\n        var str1 string = values[0]\r\n        var str2 string = values[1]\r\n        log.Println(\"callback1(\" + str1 + \",\" + str2 + \")\")\r\n    } else {\r\n        log.Println(\"callback1()\")\r\n    }\r\n}\r\nfunc callback2(args interface{}) {\r\n    //每次在当前时间点之后5s插入一个定时器，这样就能形成每隔5秒调用一次callback2回调函数，可以用于周期性事件\r\n    timer.SetTimer(\"callback2\", 5, callback2, args)\r\n    log.Println(\"callback2\")\r\n}\r\nfunc main() {\r\n    // cpu多核\r\n    runtime.GOMAXPROCS(runtime.NumCPU())\r\n    // 定时器1，传入两个参数\r\n    timer.SetTimer(\"callback1\", 3, callback1, []string{\"hello\", \"world\"})\r\n    // 定时器2，不传参数\r\n    timer.SetTimer(\"callback2\", 6, callback2, nil)\r\n    // 移除定时器\r\n    //timer.Delete(timer.TimerMap[\"callback2\"])\r\n    //运行计时器\r\n    timer.Run()\r\n}\r\n```\r\n完整的代码在，https://github.com/socho1/timer_server，这里只列出主要的部分。 \r\n将代码下载到您本地GOPATH路径下，进入timer_server目录下，执行 \r\ngo build\r\n用以编译生成timer_server，没问题的话，运行\r\n./timer_server\r\n看到结果\r\n2015/04/13 13:06:43 第1s\r\n2015/04/13 13:06:44 第2s\r\n2015/04/13 13:06:45 第3s\r\n2015/04/13 13:06:45 callback1(hello,world)\r\n2015/04/13 13:06:46 第4s\r\n2015/04/13 13:06:47 第5s\r\n2015/04/13 13:06:48 第6s\r\n2015/04/13 13:06:48 callback2\r\n2015/04/13 13:06:49 第7s\r\n2015/04/13 13:06:50 第8s\r\n2015/04/13 13:06:51 第9s\r\n2015/04/13 13:06:52 第10s\r\n2015/04/13 13:06:53 第11s\r\n2015/04/13 13:06:53 callback2\r\n……\r\n结果显示第3秒的时候，调用了callback1回调函数，并且只调用了一次，以后不再调用了。 \r\n在第6s的时候，调用callback2，并且以后每隔5秒都会调用该函数，成了周期。 \r\n然后我们将\r\n//timer.Delete(timer.TimerMap[\"callback2\"])\r\n这行的注释去掉，看看运行结果 \r\n2015/04/13 13:09:31 第1s \r\n2015/04/13 13:09:32 第2s \r\n2015/04/13 13:09:33 第3s \r\n2015/04/13 13:09:34 callback1(hello,world) \r\n2015/04/13 13:09:35 第4s \r\n2015/04/13 13:09:36 第5s \r\n2015/04/13 13:09:37 第6s \r\n2015/04/13 13:09:38 第7s \r\n2015/04/13 13:09:39 第8s \r\n2015/04/13 13:09:40 第9s \r\n2015/04/13 13:09:41 第10s \r\n2015/04/13 13:09:42 第11s \r\n…… \r\n可以看到，callback2不再被调用了，因为把这个定时器跟删除了，根据它的名称callback2找到其位置删除的。\r\n****\r\n>始于2015-04-10，北京；更新至2016-06-13，杭州。\r\n', ',技术,', '64', '0', '2016-06-13 13:22:24', '2016-08-06 20:50:17', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('40', '1', '二分查找、折半查找', '', '', '0', '<p><span style=\"color: rgb(54, 46, 43); font-family: \" microsoft=\"\" line-height:=\"\" background-color:=\"\">二分查找也叫折半查找，原理不用写了，百度下，这里给出C语言版本</span><br/></p><pre class=\"brush:cpp;toolbar:false\">/*\r\n&nbsp;*&nbsp;@file&nbsp;search_binary.c\r\n&nbsp;*&nbsp;详情请看&nbsp;http://blog.csdn.net/socho/article/details/51684422\r\n&nbsp;*/\r\n#include&nbsp;&lt;stdio.h&gt;\r\n#define&nbsp;N&nbsp;10\r\nvoid&nbsp;printA(int&nbsp;A[],&nbsp;char&nbsp;n){\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i&nbsp;=&nbsp;0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;n;&nbsp;i++)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;%d&nbsp;&quot;,&nbsp;A[i]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;\\n&quot;);\r\n}\r\nvoid&nbsp;printSearch(int&nbsp;A[],&nbsp;char&nbsp;n,&nbsp;int&nbsp;count,&nbsp;int&nbsp;low,&nbsp;int&nbsp;high){\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i&nbsp;=&nbsp;0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;第%d次折半,low&nbsp;%d,high&nbsp;%d&nbsp;:&quot;,&nbsp;count,&nbsp;low,&nbsp;high);\r\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;n;&nbsp;i++)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(low&nbsp;==&nbsp;i)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;[&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;&nbsp;%d&nbsp;&quot;,&nbsp;A[i]);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(high&nbsp;==&nbsp;i)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;]&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;\\n&quot;);\r\n}\r\nint&nbsp;search_binary(int&nbsp;A[],&nbsp;int&nbsp;n,&nbsp;int&nbsp;Key)\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;//在有序表R[0..n-1]中进行二分查找，成功时返回结点的位置，失败时返回-1\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;low&nbsp;=&nbsp;0,&nbsp;high&nbsp;=&nbsp;n-1,&nbsp;mid&nbsp;=&nbsp;0,&nbsp;count&nbsp;=&nbsp;0;//置当前查找区间上、下界的初值\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(low&nbsp;&lt;=&nbsp;high)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//printf(&quot;第%d次查找&nbsp;low:%d&nbsp;mid:%d&nbsp;high:%d\\n&quot;,&nbsp;++count,&nbsp;low,&nbsp;mid,&nbsp;high);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Key&nbsp;==&nbsp;A[low])\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;low;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Key&nbsp;==&nbsp;A[high])\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;high;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//当前查找区间A[low..high]非空\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mid&nbsp;=&nbsp;low&nbsp;+&nbsp;((high-low)/2);&nbsp;//使用(low+high)/2会有整数溢出的问题\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//（问题会出现在当low+high的结果大于表达式结果类型所能表示的最大值时，\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//这样，产生溢出后再/2是不会产生正确结果的，而low+((high-low)/2)不存在这个问题\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Key&nbsp;==&nbsp;A[mid])\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mid;//查找成功返回\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(A[mid]&nbsp;&lt;&nbsp;Key)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;low&nbsp;=&nbsp;mid&nbsp;+&nbsp;1;//继续在A[mid+1..high]中查找\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;high&nbsp;=&nbsp;mid&nbsp;-&nbsp;1;//继续在A[low..mid-1]中查找\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printSearch(A,&nbsp;n,&nbsp;++count,&nbsp;low,&nbsp;high);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(low&gt;high)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;-1;//当low&gt;high时表示所查找区间内没有结果，查找失败\r\n}\r\nint&nbsp;main(){\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;A[N]&nbsp;=&nbsp;{&nbsp;-10,&nbsp;0,&nbsp;1,&nbsp;5,&nbsp;7,&nbsp;24,&nbsp;31,&nbsp;58,&nbsp;59,&nbsp;99};&nbsp;&nbsp;//已排序好\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;pos&nbsp;=&nbsp;0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;初始化:&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printA(A,&nbsp;N);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;查找1所在位置\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;search_binary(A,&nbsp;N,&nbsp;1);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;1所在位置是&nbsp;%d:\\n&quot;,&nbsp;pos);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;查找12所在位置\\n&quot;);\r\n&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;search_binary(A,&nbsp;N,&nbsp;12);\r\n&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;12所在位置是&nbsp;%d:\\n&quot;,&nbsp;pos);\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;\r\n}</pre><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">运行结果&nbsp;<br style=\"box-sizing: border-box;\"/>初始化:-10 0 1 5 7 24 31 58 59 99&nbsp;<br style=\"box-sizing: border-box;\"/>查找1所在位置&nbsp;<br style=\"box-sizing: border-box;\"/>第1次折半,low 0,high 3 :[ -10 0 1 5 ] 7 24 31 58 59 99&nbsp;<br style=\"box-sizing: border-box;\"/>第2次折半,low 2,high 3 : -10 0 [ 1 5 ] 7 24 31 58 59 99&nbsp;<br style=\"box-sizing: border-box;\"/>1所在位置是 2:&nbsp;<br style=\"box-sizing: border-box;\"/>查找12所在位置&nbsp;<br style=\"box-sizing: border-box;\"/>第1次折半,low 5,high 9 : -10 0 1 5 7 [ 24 31 58 59 99 ]&nbsp;<br style=\"box-sizing: border-box;\"/>第2次折半,low 5,high 6 : -10 0 1 5 7 [ 24 31 ] 58 59 99&nbsp;<br style=\"box-sizing: border-box;\"/>第3次折半,low 5,high 4 : -10 0 1 5 7 ][ 24 31 58 59 99&nbsp;<br style=\"box-sizing: border-box;\"/>12所在位置是 -1:</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\">可以看到，第一次查找1的时候，折半了两次，一次是调整到A[0]=-10和A[3]=5区间，第二次调整到A[2]=1和A[3]=5区间，然后再对比一次就找到了1的位置是2.&nbsp;<br style=\"box-sizing: border-box;\"/>同理找12的时候，进行了3次折半，最后没找到，返回位置-1的报错。</p><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 1.1em; color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"><span style=\"color: rgb(54, 46, 43); font-family: \" microsoft=\"\" font-size:=\"\" line-height:=\"\" background-color:=\"\">CSDN同步文章：http://blog.csdn.net/socho/article/details/51684422</span></p><hr style=\"margin: 2em 0px; border-right-width: 0px; border-bottom-width: 0px; border-left-width: 0px; border-top-style: solid; border-top-color: rgba(128, 128, 128, 0.0980392); color: rgb(54, 46, 43); font-family: &#39;microsoft yahei&#39;; font-size: 14px; line-height: 26px; white-space: normal; background-color: rgb(255, 255, 255);\"/><blockquote style=\"box-sizing: border-box; margin: 0px 0px 1.1em; padding: 15px 20px; border-left-width: 10px; border-left-style: solid; border-left-color: rgba(128, 128, 128, 0.0745098); border-radius: 0px 5px 5px 0px; color: rgb(54, 46, 43);\" microsoft=\"\" font-size:=\"\" line-height:=\"\" white-space:=\"\" background-color:=\"\"><p style=\"box-sizing: border-box; margin-top: 0px; margin-bottom: 0px; line-height: 1.25;\">始于2009-03-30，西理工；更新至2016-06-15，杭州。</p></blockquote>', ',技术,', '109', '0', '2016-06-15 18:31:01', '2016-06-20 21:10:02', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('41', '1', '修改FILE缓冲区大小，改进写日志性能', '', '', '0', '<p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;由于线上服务端程序，需要大量写入日志，将来入数据库库，以便做数据分析或者对账之用，可是发现日志打开后服务器变慢了，对外并发响应数量也减少了。于是分析了下日志写入函数fprintf。其写日志文件的顺序是：程序写入用户地址空间内核从用户地址空间缓冲区复制到内核文件缓冲区内核文件缓冲区满的情况下再放入内核io队列，等待写入到硬盘上。写文件其实不是直接写到硬盘，那样的话一堆程序都同时并发往硬盘上写，硬盘能累吐血。所以文件其实是先写到内存，满员后再写到硬盘，当然这是内核完成的，我们用户程序只要使用系统调用就行了。这样可以减少写硬盘的次数，一次批量多写些内容进去。&nbsp;</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;一个程序使用系统调用的次数会很大程度上影响系统的性能,因为在执行系统时，会从用户代码切换执行内核代码，然后返回用户代码。优化手段就是尽量减少系统调用次数。&nbsp;</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;以上这种缓存的思想是很OK的，那么我们的问题在哪里呢？我们的问题其实就是一次性写入的日志很大，通常会超过系统默认的用户地址空间文件缓冲区大小4096字节，刚好就是一个页的大小，应该是为了方便拷贝到内核而设的单位，我们往往一行日志就写了5000多字节，有的甚至1M字节。所以每次写一行日志都会触发系统调用。而我们的服务器程序写日志很频繁，每秒都有几次写这种大型日志的操作，写小日志的操作就更多了。当然可以分不同的文件写到多个日志文件中，缓解单个文件缓冲区的压力，不过这好像么有治本。&nbsp;</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;在服务器设计上的思想，我是尽可能的用空间换时间，因为用户很挑剔啊，时间上人家可不愿意多等几秒。当然不要无限制的滥用空间，内存和硬盘也很宝贵的。&nbsp;</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">我们的办法就是在写日志文件的时候，使用setvbuf函数设置自己的缓冲区，尽量在内存够用的情况下，设置大些。我设置了10*4096个字节，这样fprintf函数内部使用系统调用的频率就少了，减少了不少次从用户态拷贝小数据到内核态转换的时间开销，转为积累大数据，一次性拷贝，只一次系统调用就搞定。接下来看示例</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">1.调大缓冲区</span></p><pre class=\"brush:cpp;toolbar:false\"><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">/**<br/>&nbsp;* test1.c<br/>&nbsp;* gcc test1.c -o test1<br/>&nbsp;*/<br/>#include<stdio.h><br/>#include<sys stat.h=\"\"><br/>#include<sys time.h=\"\"><br/>#define BUF_SIZE 4096<br/>#define LOOP_CNT 1000000<br/>int main ()&nbsp;<br/>{<br/>&nbsp; &nbsp; int i = 0;<br/>&nbsp; &nbsp; struct timeval start, end; // 计时用的结构<br/>&nbsp; &nbsp; float timeuse; // 耗时，s为单位<br/>&nbsp; &nbsp; char test_fmt[4108];<br/>&nbsp; &nbsp; for(i = 0; i &lt; 4108; i++){<br/>&nbsp; &nbsp; &nbsp; &nbsp; test_fmt[i] = &#39;A&#39;;<br/>&nbsp; &nbsp; } // 总共4108字节。<br/>&nbsp; &nbsp; printf(&quot;循环%d条，数据总量%ld：\\n&quot;, LOOP_CNT, (long)LOOP_CNT* 4108);<br/>&nbsp; &nbsp;&nbsp;<br/>&nbsp; &nbsp; FILE *pFile;<br/>&nbsp; &nbsp; struct stat sysbuf;<br/>&nbsp; &nbsp; stat(&quot;1.txt&quot;, &amp;sysbuf);<br/>&nbsp; &nbsp; printf(&quot;系统默认文件缓冲区大小 = %d byte,总共%d块\\n&quot;, (int)sysbuf.st_blksize, (int)sysbuf.st_blocks);<br/>&nbsp; &nbsp; pFile=fopen (&quot;1.txt&quot;,&quot;w&quot;);<br/>&nbsp; &nbsp; gettimeofday(&amp;start,NULL); // 开始计时<br/>&nbsp; &nbsp; for (i = 0; i &lt; LOOP_CNT; i++){<br/>&nbsp; &nbsp; &nbsp; &nbsp; fprintf(pFile, test_fmt, i); // 每行128个A，总共4096个A，再加上末尾不到10个字节的i和换行。<br/>&nbsp; &nbsp; }<br/>&nbsp; &nbsp; fclose (pFile);<br/>&nbsp; &nbsp; gettimeofday(&amp;end,NULL); // 结束计时<br/>&nbsp; &nbsp; // 计算耗时<br/>&nbsp; &nbsp; timeuse = 1000000*(end.tv_sec - start.tv_sec) + end.tv_usec - start.tv_usec;&nbsp;<br/>&nbsp; &nbsp; timeuse /= 1000000;&nbsp;<br/>&nbsp; &nbsp; printf(&quot;默认缓冲区写文件，用时:%f\\n&quot;, timeuse);<br/>&nbsp; &nbsp;&nbsp;<br/>&nbsp; &nbsp; return 0;<br/>}<br/>/**<br/>&nbsp;* test2.c<br/>&nbsp;* gcc test2.c -o test2<br/>&nbsp;*/<br/>#include<stdio.h><br/>#include<sys stat.h=\"\"><br/>#include<sys time.h=\"\"><br/>#define BUF_SIZE 4096<br/>#define LOOP_CNT 1000000<br/>int main ()&nbsp;<br/>{<br/>&nbsp; &nbsp; int i = 0;<br/>&nbsp; &nbsp; struct timeval start, end; // 计时用的结构<br/>&nbsp; &nbsp; float timeuse; // 耗时，s为单位<br/>&nbsp; &nbsp; char test_fmt[4108];<br/>&nbsp; &nbsp; for(i = 0; i &lt; 4108; i++){<br/>&nbsp; &nbsp; &nbsp; &nbsp; test_fmt[i] = &#39;A&#39;;<br/>&nbsp; &nbsp; } // 总共4108字节。<br/>&nbsp; &nbsp; printf(&quot;循环%d条，数据总量%ld：\\n&quot;, LOOP_CNT, (long)LOOP_CNT* 4108);<br/>&nbsp; &nbsp;&nbsp;<br/>&nbsp; &nbsp; FILE *pFile1;<br/>&nbsp; &nbsp; pFile1=fopen (&quot;2.txt&quot;,&quot;w&quot;);&nbsp;<br/>&nbsp; &nbsp; char buf[BUF_SIZE];<br/>&nbsp; &nbsp; setvbuf ( pFile1 , buf, _IOFBF , BUF_SIZE );<br/>&nbsp; &nbsp; printf(&quot;自定义缓冲区 = %d byte\\n&quot;, BUF_SIZE);<br/>&nbsp; &nbsp; gettimeofday(&amp;start,NULL); // 开始计时<br/>&nbsp; &nbsp; for (i = 0; i &lt; LOOP_CNT; i++){<br/>&nbsp; &nbsp; &nbsp; &nbsp; fprintf(pFile1, test_fmt, i);<br/>&nbsp; &nbsp; }<br/>&nbsp; &nbsp; fclose (pFile1);<br/>&nbsp; &nbsp; gettimeofday(&amp;end,NULL); // 结束计时<br/>&nbsp; &nbsp; // 计算耗时<br/>&nbsp; &nbsp; timeuse = 1000000*(end.tv_sec - start.tv_sec) + end.tv_usec - start.tv_usec;&nbsp;<br/>&nbsp; &nbsp; timeuse /= 1000000;&nbsp;<br/>&nbsp; &nbsp; printf(&quot;自定义缓冲区写文件，用时:%f\\n&quot;, timeuse);<br/>&nbsp; &nbsp;&nbsp;<br/>&nbsp; &nbsp; return 0;<br/>}</sys></sys></stdio.h></sys></sys></stdio.h></span></pre><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;在一个5400转硬盘的虚拟机上，分别编译运行，查看结果，其中st_blocks代表该文件使用了多少个块。&nbsp;</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;一开始测试我犯了个严重的错误，就是将两段代码编译好的程序一起运行，或者两次运行间隔时间不长。后来通过在windows的资源管理器中查看实时磁盘IO，发现写入1.txt的程序虽然已经退出了，但是磁盘还在写入，说明这会是内核在往磁盘中写入呢。而我此时启动另一个测试程序对2.txt做写入操作，会响测试1.txt效果，应该等1.txt完全写入完成，磁盘io不再进行时候再启动对2.txt的操作。</span></p><pre class=\"brush:bash;toolbar:false\"><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">循环10000条，数据总量41080000：<br/>系统默认文件缓冲区大小 = 4096 byte,总共802344块<br/>默认缓冲区写文件，用时:0.468300<br/>循环10000条，数据总量41080000：<br/>自定义缓冲区 = 40960 byte<br/>自定义缓冲区写文件，用时:0.155844<br/>&nbsp;<br/>循环100000条，数据总量410800000：<br/>系统默认文件缓冲区大小 = 4096 byte,总共8023438块<br/>默认缓冲区写文件，用时:4.686463<br/>循环100000条，数据总量410800000：<br/>自定义缓冲区 = 40960 byte<br/>自定义缓冲区写文件，用时:1.543402<br/>&nbsp;<br/>循环1000000条，数据总量4108000000：<br/>系统默认文件缓冲区大小 = 4096 byte,总共2642816块<br/>默认缓冲区写文件，用时:47.181843<br/>循环1000000条，数据总量4108000000：<br/>自定义缓冲区 = 40960 byte<br/>自定义缓冲区写文件，用时:28.394735</span></pre><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;在写入100000条之前，还有着2倍多的速率差异。&nbsp;<br/></span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;等到写入次数达到1000000条的时候，两者的时间差缩小到了1倍以内，此时的日志文件4.16G。再加大测试的话，内核的IO队列该不够用。&nbsp;</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;在windows下查看了下虚拟机的写入速率，依然自定义缓存方式要快一些，以下是速率峰值时候的截图&nbsp;</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">（1）用系统默认缓存&nbsp;</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\"><img src=\"http://img.blog.csdn.net/20160707145428607\" alt=\"这里写图片描述\"/></span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">最高到74M/s&nbsp;</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">（2）自定义缓存峰值&nbsp;</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\"><img src=\"http://img.blog.csdn.net/20160707145439888\" alt=\"这里写图片描述\"/></span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">最高到115M/s&nbsp;</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;从每次测试的结果看，自定义缓冲区后，写入相同字节的内容，自定义缓冲区明显要比系统默认少一倍以上的时间。当然这是测试，实际项目可根据情况自行调节缓冲区大小。&nbsp;</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">不过这样做的坏处显而易见，断电就抓瞎了，大量的的缓存还没写到磁盘呢！</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">2.调等缓冲区</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;当然，我们还要测试下设置成和系统默认4096，也就是一个页大小的单位</span></p><pre class=\"brush:bash;toolbar:false\"><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">循环1000000条，数据总量4108000000：<br/>系统默认文件缓冲区大小 = 4096 byte,总共79633800块<br/>默认缓冲区写文件，用时:48.648003<br/>循环1000000条，数据总量4108000000：<br/>自定义缓冲区 = 4096 byte<br/>自定义缓冲区写文件，用时:49.252640</span></pre><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;用时几乎相当</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">3.调小缓冲区</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;再看看，缩小缓冲区的结果，设为1024字节<br/></span></p><pre class=\"brush:bash;toolbar:false\"><br/><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">循环1000000条，数据总量4108000000：<br/>系统默认文件缓冲区大小 = 4096 byte,总共8023438块<br/>默认缓冲区写文件，用时:49.945450<br/>循环1000000条，数据总量4108000000：<br/>自定义缓冲区 = 1024 byte<br/>自定义缓冲区写文件，用时:102.239960</span></pre><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;这次看到缓冲区缩小后，明显用时更多了，竟然超过1倍多的时间。</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">4.思考</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">&nbsp; &nbsp; &nbsp; &nbsp;FILE结构里本身带有一个缓冲。而内核在操作IO的时候会还有一个缓冲区，内核将缓冲区写到磁盘也不是直接写，而是放到其IO队列中等待写入。加大文件缓冲区，也只是加大了用户态的缓冲区，而内核态缓冲区是没有变的，所以当用户态缓冲区超过4096一个页大小的时候，它从用户地址空间拷贝到内核地址空间时候，应该是切分了好几页，分别加入内核IO的队列中，准备写入到磁盘上。</span></p><p><br/></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">CSDN同步文章http://blog.csdn.net/socho/article/details/51842943</span></p><p><span style=\"font-size: 18px; font-family: &quot;times new roman&quot;;\">创建于2014-03-04深圳腾讯，更新于2016-07-06杭州。</span></p><p><br/></p>', ',技术,', '58', '0', '2016-07-07 00:18:05', '2016-07-07 20:44:04', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('42', '1', 'KeepAlived+MySQL互为主从', '', '', '0', '<p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">解决Master单点问题，两台mysql互为主备，双向replication。当一master挂了，则将slave切换为master，继续工作。好，给定两台机器&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">主机A：192.168.1.201&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">主机B：192.168.1.202</span></p><p><span style=\"font-size: 36px;\"><strong><span style=\"font-family: 隶书, SimLi;\">一、互为主从</span></strong></span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 24px;\">1.配置</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">主机A上，vim /etc/my.cnf，添加：</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">[mysqld]</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">log-bin=mysql-bin</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">server-id=1 #服务id要和B不同</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">binlog_do_db=db1</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master-host = 192.168.1.202 #目标机器是B的地址</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master-user = user1</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master-password = pass1</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master-port = 3306</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master-connect-retry = 5</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">主机B上，vim /etc/my.cnf，添加：</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">[mysqld]</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">log-bin=mysql-bin</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">server-id=2 #服务id要和A不同</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">binlog_do_db=db1</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master-host = 192.168.1.201 #目标机器是A的地址</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master-user = user1</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master-password = pass1</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master-port = 3306</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master-connect-retry = 5</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">在A上开启binlog,创建复制帐号GRANT REPLICATION SLAVE,REPLICATION CLIENT ON *.* TO user1@&#39;%&#39; IDENTIFIED BY &#39;pass1&#39;;</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">在B上开启binlog,创建复制帐号GRANT REPLICATION SLAVE,REPLICATION CLIENT ON *.* TO user1@&#39;%&#39; IDENTIFIED BY &#39;pass1&#39;;</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">为了方便，我们将用户名和密码两台机器都设成一致的。</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">在A上</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">我们先在A上创建数据库db1，里面的表内容随便写点啥就行了：</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">CREATE DATABASE db1;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">USE db1;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">CREATE TABLE `tb_2` (</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; `id` int(11) NOT NULL AUTO_INCREMENT,</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; `name` varchar(64) DEFAULT NULL,</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; PRIMARY KEY (`id`)</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=utf8;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">INSERT INTO `tb_2` VALUES (&#39;1&#39;, &#39;Michael&#39;);</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">查看下信息</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; show variables like &#39;ser%&#39;;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| Variable_name | Value |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| server_id &nbsp; &nbsp; | 1 &nbsp; &nbsp; |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; show master status;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+------------------+----------+--------------+------------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| File &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Position | Binlog_Do_DB | Binlog_Ignore_DB |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+------------------+----------+--------------+------------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| mysql-bin.000001 | &nbsp; &nbsp; &nbsp;447 | db1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+------------------+----------+--------------+------------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">可以看到A要同步的是db1数据库，当前bin-log编号是000001，位置是447。&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">查看A的数据</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; select * from tb_2;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+---------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| id | name &nbsp; &nbsp;|</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+---------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;1 | Michael |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+---------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">A有一条数据。&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">在B上</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; show variables like &#39;ser%&#39;;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| Variable_name | Value |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| server_id &nbsp; &nbsp; | 2 &nbsp; &nbsp; |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; show master status;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+------------------+----------+--------------+------------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| File &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Position | Binlog_Do_DB | Binlog_Ignore_DB |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+------------------+----------+--------------+------------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| mysql-bin.000001 | &nbsp; &nbsp; &nbsp;106 | db1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+------------------+----------+--------------+------------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">查看B的数据</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; select * from tb_2;Empty set (0.00 sec)12</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">B还没有数据，目前未同步。位置是000001:106，一会从A上同步过来。</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 24px;\">2.开始同步</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">配置中已有replication的配置了，只要两个机器重启就行了，自动相互复制。&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">在A上</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">service mysqld restart1</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">在B上</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">service mysqld restart1</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">再在A上执行</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; show slave status\\G</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">*************************** 1. row ***************************</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Slave_IO_State: Waiting for master to send event</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Master_Host: 192.168.1.202</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Master_User: user1</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Master_Port: 3306</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Connect_Retry: 5</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Master_Log_File: mysql-bin.000008</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Read_Master_Log_Pos: 106</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Relay_Log_File: mysqld-relay-bin.000001</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Relay_Log_Pos: 251</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; Relay_Master_Log_File: mysql-bin.000008</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Slave_IO_Running: Yes</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Slave_SQL_Running: Yes</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Replicate_Do_DB:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Replicate_Ignore_DB:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Replicate_Do_Table:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp;Replicate_Ignore_Table:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; Replicate_Wild_Do_Table:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; Replicate_Wild_Ignore_Table:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Last_Errno: 0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Last_Error:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Skip_Counter: 0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Exec_Master_Log_Pos: 106</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Relay_Log_Space: 552</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Until_Condition: None</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Until_Log_File:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Until_Log_Pos: 0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Master_SSL_Allowed: No</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Master_SSL_CA_File:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Master_SSL_CA_Path:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Master_SSL_Cert:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Master_SSL_Cipher:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Master_SSL_Key:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; Seconds_Behind_Master: 0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Master_SSL_Verify_Server_Cert: No</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Last_IO_Errno: 0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Last_IO_Error:&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Last_SQL_Errno: 0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Last_SQL_Error:</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">A中的Slave_IO_Running 和 Slave_SQL_Running两个值都是YES，说明配置成功了。&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">B的配置就不贴了，也是配置成功的。&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">如果同步不成功：&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">用命令行的方式手动复制，比如在B上输入命令</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">change master tomaster_host=&#39;192.168.1.201&#39;,master_port=3306,</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master_user=&#39;user1&#39;,master_password=&#39;pass1&#39;;12345</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">然后使用start slave;开启从A向B的复制。&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">还有指定从某个地址开始复制的话，加两个参数</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master_log_file=&#39;mysql-bin.000001&#39;,master_log_pos=106;12</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">反过来，要从B同步到A，就要在A上执行</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">change master tomaster_host=&#39;192.168.1.202&#39;,master_port=3306,</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">master_user=&#39;user1&#39;,master_password=&#39;pass1&#39;;12345</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">同步好了之后，查看B的数据</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; select * from tb_2;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+---------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| id | name &nbsp; &nbsp;|</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+---------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;1 | Michael |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+---------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">好的，现在A和B数据一致了。</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">再看看A和B的状态&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">A机器</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; show master status;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+------------------+----------+--------------+------------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| File &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Position | Binlog_Do_DB | Binlog_Ignore_DB |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+------------------+----------+--------------+------------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| mysql-bin.000001 | &nbsp; &nbsp; &nbsp;447 | &nbsp; &nbsp;db1 &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+------------------+----------+--------------+------------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">B机器</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; show master status;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+------------------+----------+--------------+------------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| File &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | Position | Binlog_Do_DB | Binlog_Ignore_DB |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+------------------+----------+--------------+------------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| mysql-bin.000001 | &nbsp; &nbsp; &nbsp;106 | &nbsp; &nbsp;db1 &nbsp; &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+------------------+----------+--------------+------------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">B的bin-log位置没有变，还是000001:106，但是数据确实已经到了。</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 24px;\">3.在A和B上操作</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">1.先把A当作Master，在A上操作数据&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">从A上删除数据</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; delete from tb_2 where name=&#39;Michael&#39;;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Query OK, 1 row affected (0.00 sec)12</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">此时A的bin-log位置是000001:546，而到B查看数据</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; select * from tb_2;Empty set (0.00 sec)12</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">确实已经同步删除了，不过B的bin-log位置依然是000001:106&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">2.再把B当作Master，在B上操作数据</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">INSERT INTO `tb_2`(name) VALUES (&#39;Michael&#39;);</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Query OK, 1 row affected (0.00 sec)12</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">成功后，到A上去查</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; select * from tb_2;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+---------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| id | name &nbsp; &nbsp;|</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+---------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;2 | Michael |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+---------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">A也同步到了数据，至此说明A和B互为主从，在一个上面修改数据，就会同步到另外一个机器上是可行的。&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">查看下两机器状态&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">这次A的bin-log地址没有变化，还是000001:546，而变的是B，成了000001:239了，说明从机只有变成主机数据被修改的时候，才会改变自己的bin-log地址，同步是不会改变bin-log地址的。&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">接下来配置keepalived。</span></p><p><br/></p><p><span style=\"font-size: 36px;\"><strong><span style=\"font-family: 隶书, SimLi;\">二、KeepAlived</span></strong></span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">上一步确保了互为主从设置成功后，接下来安装&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">yum install keepalived&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">看下版本&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">[root@localhost ~]# keepalived -v&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Keepalived v1.2.13 (03/19,2015)</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 24px;\">1.配置</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">然后在A服务器编辑KeepAlived的配置文件&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">vim /etc/keepalived/keepalived.conf</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">! Configuration File for keepalived</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">global_defs {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; router_id HA_MySQL #标识，双主相同</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">vrrp_instance VI_1 {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;state BACKUP #注意，主从两端都配置成了backup，因为使用了nopreempt，即非抢占模式</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;interface eth0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;virtual_router_id 51 #分组，主备相同&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;priority 100 #优先级，这个高一点则先把它作为master</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;advert_int 1</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;nopreempt #不主动抢占资源，设置非抢占模式</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;authentication {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;auth_type PASS</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;auth_pass 1111</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;virtual_ipaddress {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;192.168.1.199</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">virtual_server 192.168.1.199 3306 {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;delay_loop 2</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;lb_algo wrr #带有权重的轮询</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;lb_kind DR</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;persistence_timeout 60 #同一IP的连接60秒内被分配到同一台真实服务器&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;protocol TCP</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;real_server 192.168.1.201 3306 {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;weight 3 #权重为3</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;notify_down /data/keepalived_shutdown.sh #当mysq服down时，执行此脚本，杀死keepalived实现切换, 自杀脚本.</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TCP_CHECK {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;connect_timeout 10</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nb_get_retry 3</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;delay_before_retry 3</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;connect_port 3306</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">然后编辑B的配置文件&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">vim /etc/keepalived/keepalived.conf</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">! Configuration File for keepalived</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">global_defs {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;router_id HA_MySQL</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">vrrp_instance VI_1 {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;state BACKUP</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;interface eth0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;virtual_router_id 51</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;priority 90 #优先级，这个低一点</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;advert_int 1</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;nopreempt</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;authentication {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;auth_type PASS</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;auth_pass 1111</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;virtual_ipaddress { #虚拟IP (VIP)</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;192.168.1.199</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">virtual_server 192.168.1.199 3306 {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;delay_loop 2 #每2秒检查一次real_server存活</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;lb_algo wrr</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;lb_kind DR</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;persistence_timeout 60</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;protocol TCP</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;real_server 192.168.1.202 3306 {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;weight 3</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;notify_down /data/keepalived_shutdown.sh</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TCP_CHECK {</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;connect_timeout 10 #连接超时时间</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;nb_get_retry 3 #重连次数</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;delay_before_retry 3 #重连间隔时间</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;connect_port 3306 #健康检查端口，配置自己mysql服务端口</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp;}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">}</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">有一点要注意的是，主从两端的state，都配置成了backup，因为使用了nopreempt，即非抢占模式。&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">举个例子，当主端先启动mysql实例和keepalived后，如果此时从端也启动了mysql实例和keepalived，那么vip不会跳到从端上去，即使它的优先级为100，要大于主端的90&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">而如果不设置nopreempt，那么这个时候，又分2种情况：&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">1.state相同，即都是master或都是backup&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">优先级高的，会占有vip，和角色无关&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">2.state不同，即master-&gt;backup或backup-&gt;master&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">优先级高的，会占有vip，和角色无关&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">前提不同，结果都是一样的，即优先级是主导，谁的优先级高，vip就漂到谁那里</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">可以看到A和B配置的共同点，就是virtual_ipaddress都是，这样当我们使用mysql的时候，就连接到这个虚拟ip上，由它进行转发到实体机。priority值高的先被访问，作为Master。这样实体机mysql的down机重启和转换主从角色则由keepalived来完成，对应用层透明，让应用无法感知。两台机器要通局域网，虚拟IP会被设置在他们共有的局域网内，不通的话两台机器各设置各的虚拟IP。</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">杀死keepalived的脚本&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">vim /data/keepalived_shutdown.sh</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">#!/bin/bash</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">#kill掉keepalived进程，以防止脑裂问题。</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">pkill keepalived123</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 24px;\">2测试</span></p><p><img src=\"http://img.blog.csdn.net/20160701232040313\" alt=\"这里写图片描述\"/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">先给个图说下目前的状况，应用程序连接VIP，VIP连接到A机器，从A向B执行Replication同步。&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">这里写图片描述&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">1.连接虚拟ip&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">先查看下虚拟ip有没有，在设置的priority值高，也就是主机的那台机器上，这里是A机器，调用如下命令</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">[root@localhost data]# ip addr</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">1: lo: &nbsp;mtu 16436 qdisc noqueue state UNKNOWN&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; inet 127.0.0.1/8 scope host lo</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; inet6 ::1/128 scope host&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">2: eth0: &nbsp;mtu 1500 qdisc pfifo_fast state UP qlen 1000</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; link/ether 08:00:27:eb:92:52 brd ff:ff:ff:ff:ff:ff</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; inet 192.168.1.201/24 brd 192.168.1.255 scope global eth0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; inet 192.168.1.199/32 scope global eth0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; inet6 fe80::a00:27ff:feeb:9252/64 scope link&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">可以看到已经有虚拟ip了，被绑定到了eth0上了。同时在B上面执行，则发现没有虚拟ip，说明现在A机器被选择了承担虚拟ip。接下来ping下它&nbsp;</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">[root@localhost data]# ping 192.168.1.199&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">PING 192.168.1.199 (192.168.1.199) 56(84) bytes of data.&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">64 bytes from 192.168.1.199: icmp_seq=1 ttl=64 time=0.104 ms</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">可以ping通哦，可以连接了！</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">用客户端连接共同的入口，虚拟ip&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">myslq -uroot -h192.168.1.119 -p&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">OK，连接上了，查下当前后端接入的是哪个实体机</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; show variables like &#39;server_id&#39;;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| Variable_name | Value |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| server_id &nbsp; &nbsp; | 1 &nbsp; &nbsp; |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">server_id=1是A机器。此时两台机器上的数据都是</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; select * from tb_2;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+---------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| id | name &nbsp; &nbsp;|</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+---------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;2 | Michael |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+---------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">2.修改数据&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">好，我们修改下数据看看</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">update tb_2 set name=&#39;andy&#39; where name=&#39;Michael&#39;;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Query OK, 1 row affected (0.00 sec)</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Rows matched: 1 &nbsp;Changed: 1 &nbsp;Warnings: 0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">然后查看</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; select * from tb_2;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| id | name |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;2 | andy |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">单独开个客户端去查看A和B的机器，得到同样的效果，数据得到了同步</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; select * from tb_2;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| id | name |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;2 | andy |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">3.制造down机&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">把mysql进程直接杀掉，类似于机器down的情况。&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">ps -ef|grep mysql&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">分析结果，得到两个mysql的进程id，都给它杀掉&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">kill -9 7282&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">kill -9 7408&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">或者直接执行killall mysqld</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">然后再次查看server_id,短暂的失去连接，即使毫秒就恢复了</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; show variables like &#39;server_id&#39;;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">No connection. Trying to reconnect...</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Connection id: &nbsp; &nbsp;751</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Current database: *** NONE ***</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| Variable_name | Value |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| server_id &nbsp; &nbsp; | 2 &nbsp; &nbsp; |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">看样子是虚拟ip迁移了，在B上ip addr下</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">1: lo: &nbsp;mtu 16436 qdisc noqueue state UNKNOWN&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; inet 127.0.0.1/8 scope host lo</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; inet6 ::1/128 scope host&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">2: eth0: &nbsp;mtu 1500 qdisc mq state UP qlen 1000</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; link/ether dc:85:de:9f:f3:27 brd ff:ff:ff:ff:ff:ff</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; inet 192.168.1.202/24 brd 192.168.1.255 scope global wlan0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; inet 192.168.1.199/32 scope global wlan0</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; inet6 fe80::de85:deff:fe9f:f327/64 scope link&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">&nbsp; &nbsp; &nbsp; &nbsp;valid_lft forever preferred_lft forever</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">server_id=2，并且B机器加载上了虚拟ip，同时我们在A机器上使用ip addr看到虚拟ip已经不存在了，A机器的keepalived进程也死了。充分证明了现在虚拟ip迁移到了B机器上。当然要让A机器复活，自己另外写脚本重启吧。现在的情况变成了应用程序连接VIP，VIP连接到B机器，从B向A执行Replication同步。&nbsp;</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">这里写图片描述&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 24px;\">3.复活机器&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">重启A机器上的mysql和keepalived&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">service mysqld start&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">service keepalived start&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">再次查看server_id，发现还是2，说明虚拟ip没有迁移回到A机器，这样就避免了脑裂问题</span></p><p><br/></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; show variables like &#39;server_id&#39;;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| Variable_name | Value |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| server_id &nbsp; &nbsp; | 2 &nbsp; &nbsp; |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+---------------+-------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">CSDN同步文章http://blog.csdn.net/socho/article/details/51804720</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">创建于2012-12-23深圳腾讯，更新于2016-07-01杭州</span></p><p><br/></p>', ',技术,', '87', '0', '2016-07-07 16:35:08', '2016-07-07 19:16:23', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('43', '1', '环形队列', '', '', '0', '<span id=\"_baidu_bookmark_start_3\" style=\"display: none; line-height: 0px;\"><span style=\"line-height: 0px;\">﻿</span>‍</span><p><span id=\"_baidu_bookmark_start_2\" style=\"display: none; line-height: 0px;\">‍</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;font-family: 宋体;background: white\">环形队列，也可以叫环形缓冲区。我们用数组来举例，通常对于一个放到数组中的队列，生产者将数据写入队尾，消费者从队头取走，两个指针朝着同一个方向运动，消费者追生产者。而</span><span style=\"font-size: 14px;background: white\">“</span><span style=\"font-size: 14px;font-family: 宋体;background: white\">环</span><span style=\"font-size: 14px;background: white\">”</span><span style=\"font-size: 14px;font-family: 宋体;background: white\">在这里的体现，就是不管生产者还是消费者，当指针跑到队尾的时候，掉头到该数组头去，形成一个没有终点的环。</span><span style=\"font-size: 14px;background: white\"> </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;font-family: 宋体;background: white\">这要做的好处是，当生产者和消费者都是单线程，也就是只有一个生产者和一个消费者的时候，不用加锁。如果生产者或者消费者都是多个，就要加锁了，那还不如用普通队列吧。</span> </p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">- </span><span style=\"font-size: 14px;font-family: 宋体;background: white\">队空：生产者和消费者的指针在同一位置。</span> </p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">- </span><span style=\"font-size: 14px;font-family: 宋体;background: white\">队满：生产者的指针比消费者的指针小一个单位的时候，下一步就将指向消费者。</span> </p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;font-family: 宋体;background: white\">环形缓冲区</span> </p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;font-family: 宋体;background: white\">以下是我的示例，采用数组的线性队列，当然你也可以使用链表，这里只说明原理，就不展出了。两个线程分别模拟生产者和消费者</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:green;background:white;background:white\">// gcc test.c -lpthread</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">#include</span> <span style=\"font-size:14px;color:#A31515;background:white;background: white\">&lt;stdio.h&gt;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">#include</span> <span style=\"font-size:14px;color:#A31515;background:white;background: white\">&lt;pthread.h&gt;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">#include</span> <span style=\"font-size:14px;color:#A31515;background:white;background: white\">&lt;string.h&gt;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">#define</span><span style=\"font-size: 14px;background: white\"> MAX 10</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">#define</span><span style=\"font-size: 14px;background: white\"> LENGTH 32</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">struct</span><span style=\"font-size: 14px;background: white\"> circular_queue{</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">char</span><span style=\"font-size: 14px;background: white\"> status; </span><span style=\"font-size:14px;color:green;background:white;background:white\">/**&lt; 0 </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">队列可写</span><span style=\"font-size:14px;color:green;background:white;background:white\"> 1</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">队列满</span><span style=\"font-size:14px;color:green;background:white;background: white\">*/</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> write; </span><span style=\"font-size:14px;color:green;background:white;background: white\">/**&lt; </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">写指针，只能生产者修改</span><span style=\"font-size:14px;color:green;background:white;background:white\"> */</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> read; </span><span style=\"font-size:14px;color:green;background:white;background: white\">/**&lt; </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">读指针，只能消费者修改</span><span style=\"font-size:14px;color:green;background:white;background:white\"> */</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">char</span><span style=\"font-size: 14px;background: white\"> queue[MAX][LENGTH];&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">/**&lt; </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">环形队列，每个元素</span><span style=\"font-size:14px;color:green;background:white;background:white\">32</span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">字节最大长度</span><span style=\"font-size:14px;color:green;background:white;background:white\"> */</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">};</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">void</span><span style=\"font-size: 14px;background: white\"> print_queue(</span><span style=\"font-size:14px;color:blue;background:white;background:white\">struct</span><span style=\"font-size: 14px;background: white\"> circular_queue *cq){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> i = 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;print all:write=%d,read=%d:&quot;</span><span style=\"font-size: 14px;background: white\">, cq-&gt;write, cq-&gt;read);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">for</span><span style=\"font-size: 14px;background: white\">(i = cq-&gt;read; i != cq-&gt;write; ){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;queue[%d]=%s &quot;</span><span style=\"font-size: 14px;background: white\">, i, cq-&gt;queue[i]);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i = ++i % MAX;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;\\n&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">void</span><span style=\"font-size: 14px;background: white\"> init_circular_queue(</span><span style=\"font-size:14px;color:blue;background:white;background:white\">struct</span><span style=\"font-size: 14px;background: white\"> circular_queue *cq){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; memset(cq, 0, </span><span style=\"font-size:14px;color:blue;background:white;background: white\">sizeof</span><span style=\"font-size: 14px;background: white\">(</span><span style=\"font-size:14px;color:blue;background:white;background: white\">struct</span><span style=\"font-size: 14px;background: white\"> circular_queue));</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> put(</span><span style=\"font-size:14px;color:blue;background:white;background: white\">struct</span><span style=\"font-size: 14px;background: white\"> circular_queue *cq, </span><span style=\"font-size:14px;color:blue;background:white;background:white\">char</span><span style=\"font-size: 14px;background: white\">* str, size_t strlen){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\">(cq-&gt;status == 1){ </span><span style=\"font-size:14px;color:green;background: white;background:white\">// </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">队列满，无法插入</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">//perror(&quot;full&quot;);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print_queue(cq);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">return</span><span style=\"font-size: 14px;background: white\"> -1;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; } </span><span style=\"font-size:14px;color:blue;background:white;background: white\">else</span><span style=\"font-size: 14px;background: white\"> {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memcpy(&amp;cq-&gt;queue[cq-&gt;write], str, strlen);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cq-&gt;queue[cq-&gt;write][strlen] = </span><span style=\"font-size:14px;color:#A31515;background:white;background:white\">&#39;\\0&#39;</span><span style=\"font-size: 14px;background: white\">; </span><span style=\"font-size:14px;color:green;background:white;background: white\">// </span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">不要忘了终结符</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;put queue[%d]=%s\\n&quot;</span><span style=\"font-size: 14px;background: white\">, cq-&gt;write, cq-&gt;queue[cq-&gt;write]);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cq-&gt;write = (cq-&gt;write + 1) % MAX;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\">((cq-&gt;read - 1) == cq-&gt;write)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cq-&gt;status = 1;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">return</span><span style=\"font-size: 14px;background: white\"> 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">char</span><span style=\"font-size: 14px;background: white\">* get(</span><span style=\"font-size:14px;color:blue;background:white;background: white\">struct</span><span style=\"font-size: 14px;background: white\"> circular_queue *cq){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">//printf(&quot;test_get:write=%d,read=%d:&quot;, cq-&gt;write, cq-&gt;read);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\">(cq-&gt;read == cq-&gt;write){ </span><span style=\"font-size:14px;color:green;background:white;background:white\">// </span><span style=\"font-size:14px;font-family:宋体;color:green;background:white;background:white\">队列空</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">return</span><span style=\"font-size: 14px;background: white\"> NULL;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; } </span><span style=\"font-size:14px;color:blue;background:white;background: white\">else</span><span style=\"font-size: 14px;background: white\"> {</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">int</span><span style=\"font-size: 14px;background: white\"> tmp = cq-&gt;read;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cq-&gt;read = (cq-&gt;read + 1) % MAX;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cq-&gt;status = 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">return</span><span style=\"font-size: 14px;background: white\"> cq-&gt;queue[tmp];</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">void</span><span style=\"font-size: 14px;background: white\">* producer(</span><span style=\"font-size:14px;color:blue;background: white;background:white\">void</span><span style=\"font-size: 14px;background: white\"> *para){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">struct</span><span style=\"font-size: 14px;background: white\"> circular_queue *cq = (</span><span style=\"font-size:14px;color:blue;background:white;background:white\">struct</span><span style=\"font-size: 14px;background: white\"> circular_queue*)para;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">while</span><span style=\"font-size: 14px;background: white\">(1){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; put(cq, </span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;abc&quot;</span><span style=\"font-size: 14px;background: white\">, 3);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep(1);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; put(cq, </span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;1&quot;</span><span style=\"font-size: 14px;background: white\">, 1);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sleep(1);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; put(cq, </span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;123456&quot;</span><span style=\"font-size: 14px;background: white\">, 6);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sleep(1);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; put(cq, </span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;hello world!&quot;</span><span style=\"font-size: 14px;background: white\">, 12);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">void</span><span style=\"font-size: 14px;background: white\">* consumer(</span><span style=\"font-size:14px;color:blue;background: white;background:white\">void</span><span style=\"font-size: 14px;background: white\"> *para){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">struct</span><span style=\"font-size: 14px;background: white\"> circular_queue *cq = (</span><span style=\"font-size:14px;color:blue;background:white;background:white\">struct</span><span style=\"font-size: 14px;background: white\"> circular_queue*)para;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">while</span><span style=\"font-size: 14px;background: white\">(1){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;get %s\\n&quot;</span><span style=\"font-size: 14px;background: white\">, get(cq));</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sleep(2);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size:14px;color:blue;background:white;background:white\">int</span><span style=\"font-size: 14px;background: white\"> main(){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; pthread_t t1, t2;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">struct</span><span style=\"font-size: 14px;background: white\"> circular_queue cq;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; init_circular_queue(&amp;cq);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">// </span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">启动生产者线程</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\">(pthread_create(&amp;t1, NULL, producer, &amp;cq)){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; perror(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;producer&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:green;background:white;background: white\">// </span><span style=\"font-size:14px;font-family: 宋体;color:green;background:white;background:white\">启动消费者线程</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">if</span><span style=\"font-size: 14px;background: white\">(pthread_create(&amp;t2, NULL, consumer, &amp;cq)){</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; perror(</span><span style=\"font-size:14px;color:#A31515;background:white;background: white\">&quot;consumer&quot;</span><span style=\"font-size: 14px;background: white\">);</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; }</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">while</span><span style=\"font-size: 14px;background: white\">(1){}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:14px;color:blue;background:white;background: white\">return</span><span style=\"font-size: 14px;background: white\"> 0;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">}</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;font-family: 宋体;background: white\">运行结果</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get (null)</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[0]=abc</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[1]=1</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get abc</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[2]=123456</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[3]=hello world!</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[4]=abc</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get 1</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[5]=1</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[6]=123456</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get 123456</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[7]=hello world!</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[8]=abc</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[9]=1</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get hello world!</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[0]=123456</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[1]=hello world!</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[2]=abc</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get abc</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[3]=1</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">queue full: Success</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">print all:write=4,read=5:queue[5]=1 queue[6]=123456 queue[7]=hello world! queue[8]=abc queue[9]=1 queue[0]=123456 queue[1]=hello world! queue[2]=abc queue[3]=1 </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get 1</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[4]=hello world!</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">queue full: Success</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">print all:write=5,read=6:queue[6]=123456 queue[7]=hello world! queue[8]=abc queue[9]=1 queue[0]=123456 queue[1]=hello world! queue[2]=abc queue[3]=1 queue[4]=hello world! </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">queue full: Success</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">print all:write=5,read=6:queue[6]=123456 queue[7]=hello world! queue[8]=abc queue[9]=1 queue[0]=123456 queue[1]=hello world! queue[2]=abc queue[3]=1 queue[4]=hello world! </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get 123456</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[5]=123456</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">queue full: Success</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">print all:write=6,read=7:queue[7]=hello world! queue[8]=abc queue[9]=1 queue[0]=123456 queue[1]=hello world! queue[2]=abc queue[3]=1 queue[4]=hello world! queue[5]=123456 </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">queue full: Success</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">print all:write=6,read=7:queue[7]=hello world! queue[8]=abc queue[9]=1 queue[0]=123456 queue[1]=hello world! queue[2]=abc queue[3]=1 queue[4]=hello world! queue[5]=123456 </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get hello world!</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[6]=1</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">queue full: Success</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">print all:write=7,read=8:queue[8]=abc queue[9]=1 queue[0]=123456 queue[1]=hello world! queue[2]=abc queue[3]=1 queue[4]=hello world! queue[5]=123456 queue[6]=1 </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get abc</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[7]=hello world!</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">queue full: Success</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">print all:write=8,read=9:queue[9]=1 queue[0]=123456 queue[1]=hello world! queue[2]=abc queue[3]=1 queue[4]=hello world! queue[5]=123456 queue[6]=1 queue[7]=hello world! </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">queue full: Success</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">print all:write=8,read=9:queue[9]=1 queue[0]=123456 queue[1]=hello world! queue[2]=abc queue[3]=1 queue[4]=hello world! queue[5]=123456 queue[6]=1 queue[7]=hello world! </span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get 1</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[8]=123456</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[9]=hello world!</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[0]=abc</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get abc</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[1]=1</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[2]=123456</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">get 1</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[3]=hello world!</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">put queue[4]=abc</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;background: white\">&nbsp;</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;font-family: 宋体;background: white\">可以看到队列从</span><span style=\"font-size: 14px;background: white\">queue[0]</span><span style=\"font-size: 14px;font-family: 宋体;background: white\">到</span><span style=\"font-size: 14px;background: white\">queue[9]</span><span style=\"font-size: 14px;font-family: 宋体;background: white\">一直在被循环使用，达到了环的目的，而且，不冲突，不用加锁！</span></p><p style=\"text-indent:0;line-height: normal;text-autospace:none\"><span style=\"font-size: 14px;line-height: 150%;font-family: 宋体;background: white\">CSDN文章同步&nbsp;http://blog.csdn.net/socho/article/details/51859879</span></p><p style=\"text-indent:28px\"><span style=\"font-size: 14px;line-height: 150%;font-family: 宋体;background: white\">创建于</span><span style=\"font-size: 14px;line-height: 150%;background: white\">2011-09-30 </span><span style=\"font-size: 14px;line-height: 150%;font-family: 宋体;background: white\">深圳腾讯，更新于</span><span style=\"font-size: 14px;line-height: 150%;background: white\"> 2016-07-08 </span><span style=\"font-size: 14px;line-height: 150%;font-family: 宋体;background: white\">杭州</span></p><span id=\"_baidu_bookmark_end_4\" style=\"display: none; line-height: 0px;\">‍</span>', ',技术,', '75', '0', '2016-07-08 15:15:10', '2016-07-08 15:18:54', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('44', '1', '基于mysql的分布式数据库中间件-Mycat', '', '', '0', '####一、Mycat\r\n根据官网的定义：Mycat是一个可以用于MySQL读写分离和高可用的中间件，一个模拟为MySQL Server的超级数据库，一个能平滑扩展支持1000亿大表的分布式数据库系统，一个可管控多种关系数据库的数据库路由器，一个平滑从关系数据升级到大数据的应用中间件。其前身是阿里的Cobar项目。\r\n\r\n介绍就不多说了，可以看官网http://www.mycat.org.cn/ ，接下来我们实践吧。\r\n####二、mysql配置\r\nmysql节点A机器\r\n操作系统 : centos6.5 x64\r\n数据库 : mysql-5.1.73\r\nmycat版本 ：1.5.1 release\r\n数据库名 : db1\r\nhostname: localhost.localdomain\r\nip:192.168.1.201\r\n\r\nmysql节点B机器\r\n操作系统 : centos6.5 x64\r\n数据库 : mysql-5.1.73\r\nmycat版本 ：1.5.1 release\r\n数据库名 : db2\r\nhostname: 202.localdomain\r\nip:192.168.1.202\r\n\r\n开始前，要先建立实体库，逻辑库要在实体库上做分表。分别在两台机器上执行创建对应的库\r\nA上：CREATE database db1;\r\nB上：CREATE database db2;\r\n另外注意linux下数据库的名称是大小写敏感的，设置my.cnf内追加一行，使得都转为小写，这样在分库的时候就统一起来了\r\nvim /etc/my.cnf\r\nlower_case_table_names = 1\r\n\r\n三、安装mycat\r\n1.安装\r\n我们将mycat安装在A机器上\r\n由于官方的地址下载后无法解压，可能是他们编译出错了吧，所以我另外找了一个http://download.csdn.net/detail/socho/9571201，下载1.5.1版本，得到Mycat-server-1.5.1-RELEASE-20160509173344-linux.tar.gz\r\n然后一系列操作，你们都懂\r\ntar -xzvf Mycat-server-1.5.1-RELEASE-20160509173344-linux.tar.gz\r\nmkdri /home/mycat/app\r\nmv mycat /usr/local/\r\n设置环境变量\r\nvim /etc/profile\r\nexport MYCAT_HOME=/usr/local/mycat\r\nPATH=$PATH:$MYCAT_HOME/bin\r\n令修改生效\r\n[mycat@c1 ~]$ source /etc/profile\r\n测试是否配置成功\r\n[mycat@c1 ~]$ echo $MYCAT_HOME\r\n/usr/local/mycat</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">配置逻辑库(schema)和逻辑表（table）,打开conf/schema.xml 每个属性的含义请参考权威指南,这里给出基本的</span></p><p><span style=\"font-size: 13px; font-family: &quot;Source Code Pro&quot;, serif; color: red; background: yellow;\">&lt;?</span><span style=\"font-size: 13px; font-family: &quot;Source Code Pro&quot;, serif; color: blue;\">xml</span><span style=\"background-color: white;\"> </span><span style=\"font-size: 13px; font-family: &quot;Source Code Pro&quot;, serif; color: red;\">version</span><span style=\"font-size: 13px; font-family: &quot;Source Code Pro&quot;, serif;\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;1.0&quot;</span></strong><span style=\"font-size: 13px; font-family: &quot;Source Code Pro&quot;, serif; color: red; background: yellow;\">?&gt;</span></p><p style=\"text-indent: 0;background: white\"><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif;background: rgb(166, 202, 240)\">&lt;!</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">DOCTYPE mycat:schema SYSTEM &quot;schema.dtd&quot;<span style=\"background:#A6CAF0\">&gt;</span></span></p><p style=\"text-indent: 0;background: white\"><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;mycat:schema</span> <span style=\"font-size: 13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">xmlns:mycat</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;<span style=\"text-decoration:underline;\">http://org.opencloudb/</span>&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;schema</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;TESTDB&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">checkSQLschema</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;false&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">sqlMaxLimit</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;100&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:green\">&lt;!-- </span><span style=\"font-size:13px;font-family:宋体;color:green\">需要分片的表，在节点</span><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:green\">dn1,dn2</span><span style=\"font-size:13px;font-family: 宋体;color:green\">上分片，分片规则是</span><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:green\">auto-sharding-long --&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;table</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;travelrecord&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">dataNode</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;dn1,dn2&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">rule</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;auto-sharding-long&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">/&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;table</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;company&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">primaryKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;ID&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">dataNode</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;dn2,dn1&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">rule</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;mod-long&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">/&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;table</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;goods&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">primaryKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;ID&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">type</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;global&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">dataNode</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;dn1,dn2&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">/&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;table</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;hotnews&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">primaryKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;ID&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">dataNode</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;dn1,dn2&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">rule</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;mod-long&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">/&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;table</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;employee&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">primaryKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;ID&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">dataNode</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;dn1,dn2&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">rule</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;sharding-by-intfile&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">/&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;table</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;customer&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">primaryKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;ID&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">dataNode</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;dn1,dn2&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">rule</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;sharding-by-intfile&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;childTable</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;orders&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">primaryKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;ID&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">joinKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;customer_id&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">parentKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;id&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;childTable</span> <span style=\"font-size: 13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size: 13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;order_items&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">joinKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;order_id&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">parentKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;id&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">/&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/childTable&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;childTable</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;customer_addr&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">primaryKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;ID&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">joinKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;customer_id&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">parentKey</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;id&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">/&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/table&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/schema&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;dataNode</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;dn1&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">dataHost</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;201.liberalman.cn&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">database</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;db1&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">/&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;dataNode</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;dn2&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">dataHost</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;202.liberalman.cn&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">database</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;db2&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">/&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;dataHost</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;201.liberalman.cn&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">maxCon</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;1000&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">minCon</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;10&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">balance</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;0&quot;</span></strong></p><p style=\"text-indent: 0;background: white\"><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">writeType</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;0&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">dbType</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;mysql&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">dbDriver</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;native&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">switchType</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;1&quot;</span></strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp; </span><span style=\"font-size: 13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">slaveThreshold</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;100&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:green\">&lt;!-- </span><span style=\"font-size:13px;font-family:宋体;color:green\">心跳包</span><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:green\"> --&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;heartbeat&gt;</span><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">select user()</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/heartbeat&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:green\">&lt;!-- </span><span style=\"font-size:13px;font-family:宋体;color:green\">后端</span><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:green\">mysql</span><span style=\"font-size:13px;font-family: 宋体;color:green\">配置</span><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:green\"> --&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;writeHost</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">host</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;hostM1&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">url</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;localhost:3306&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">user</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;socho&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">password</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;Looks137&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;&lt;/writeHost&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/dataHost&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;dataHost</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;202.liberalman.cn&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">maxCon</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;1000&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">minCon</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;10&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">balance</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;0&quot;</span></strong></p><p style=\"text-indent: 0;background: white\"><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">writeType</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;0&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">dbType</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;mysql&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">dbDriver</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;native&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">switchType</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;1&quot;</span></strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp; </span><span style=\"font-size: 13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">slaveThreshold</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;100&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:green\">&lt;!-- </span><span style=\"font-size:13px;font-family:宋体;color:green\">心跳包</span><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:green\"> --&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;heartbeat&gt;</span><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">select user()</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/heartbeat&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;writeHost</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">host</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;hostM1&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">url</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;localhost:3306&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">user</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;socho&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">password</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;Looks137&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;&lt;/writeHost&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/dataHost&gt;</span></p><p style=\"text-indent: 0;background: white\"><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/mycat:schema&gt;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">上面配置的是连接后端mysql的配置，然后我们还要配置访问MyCAT的用户账号和授权信息，打开conf/server.xml</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\"></span></p><p style=\"text-indent: 0;background: white\"><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red;background:yellow\">&lt;?</span><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">xml</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">version</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;1.0&quot;</span></strong> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">encoding</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;UTF-8&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red;background:yellow\">?&gt;</span></p><p style=\"text-indent: 0;background: white\"><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif;background: rgb(166, 202, 240)\">&lt;!</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">DOCTYPE mycat:server SYSTEM &quot;server.dtd&quot;<span style=\"background:#A6CAF0\">&gt;</span></span></p><p style=\"text-indent: 0;background: white\"><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;mycat:server</span> <span style=\"font-size: 13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">xmlns:mycat</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;<span style=\"text-decoration:underline;\">http://org.opencloudb/</span>&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;system&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;property</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;defaultSqlParser&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">druidparser</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/property&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/system&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;user</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;test&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;property</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;password&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">test</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/property&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;property</span> <span style=\"font-size: 13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size: 13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;schemas&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">TESTDB</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/property&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/user&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;user</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;user&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;property</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;password&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">user</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/property&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;property</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;schemas&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">TESTDB</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/property&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;property</span> <span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:red\">name</span><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">=</span><strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:#8000FF\">&quot;readOnly&quot;</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&gt;</span><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">true</span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/property&gt;</span></p><p style=\"text-indent: 0;background: white\"><strong><span style=\"font-size: 13px;font-family: &#39;Source Code Pro&#39;, serif\">&nbsp;&nbsp;&nbsp; </span></strong><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/user&gt;</span></p><p style=\"text-indent: 0;background: white\"><span style=\"font-size:13px;font-family:&#39;Source Code Pro&#39;,&#39;serif&#39;;color:blue\">&lt;/mycat:server&gt;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">启动</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">[mycat@c1 ~]$ mycat start</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Starting Mycat-server...</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">如果启动遇到问题，请查阅日志logs目录下的文件。</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">默认数据端口为8066，管理端口为9066。好，我们用一个客户端连接下</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql -h192.168.1.201 -P8066 -utest -DTESTDB -ptest</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">2.测试</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">连上后就可以当初一个mysql数据库来操作了，后端逻辑对用户透明，建表：&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; create table employee (id int not null primary key,name varchar(100),sharding_id int not null);</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Query OK, 0 rows affected (0.05 sec)&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">成功后，插入数据：</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; insert into employee(id,name,sharding_id) values(1,&#39;leader us&#39;,10000); insert into employee(id,name,sharding_id) values(2, &#39;me&#39;,10010); insert into employee(id,name,sharding_id) values(3, &#39;mycat&#39;,10000); insert into employee(id,name,sharding_id) values(4, &#39;mydog&#39;,10010);</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Query OK, 1 row affected (0.04 sec)</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Query OK, 1 row affected (0.01 sec)</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Query OK, 1 row affected (0.00 sec)</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">Query OK, 1 row affected (0.00 sec)</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">查看下结果</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; select * from employee;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+-----------+-------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| id | name &nbsp; &nbsp; &nbsp;| sharding_id |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+-----------+-------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;1 | leader us | &nbsp; &nbsp; &nbsp; 10000 |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;3 | mycat &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; 10000 |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;2 | me &nbsp; &nbsp; &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; 10010 |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;4 | mydog &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; 10010 |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+-----------+-------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">4 rows in set (0.01 sec)</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">这时候分别到数据DB1,DB2查看，DB1数据</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; use db1;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; select * from employee;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+-----------+-------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| id | name &nbsp; &nbsp; &nbsp;| sharding_id |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+-----------+-------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;1 | leader us | &nbsp; &nbsp; &nbsp; 10000 |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;3 | mycat &nbsp; &nbsp; | &nbsp; &nbsp; &nbsp; 10000 |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+-----------+-------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">2 rows in set (0.00 sec)</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">DB2数据</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; use db2;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">mysql&gt; select * from employee;&nbsp;</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+-------+-------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| id | name &nbsp;| sharding_id |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">+----+-------+-------------+</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;2 | me &nbsp; &nbsp;| &nbsp; &nbsp; &nbsp; 10010 |</span></p><p><span style=\"font-family: 隶书, SimLi; font-size: 18px;\">| &nbsp;4 | mydog | &nbsp; &nbsp; &nbsp; 10010 |\r\n+----+-------+-------------+\r\n2 rows in set (0.00 sec)\r\n我们终于看大，明分片成功了，哈哈，两个数据库各一半数据。\r\n从schema.xml配置中看到，employee表是根据规则sharding-by-intfile（分片字段为sharding_id）进行分片，所以A中都是sharding_id=10000的数据，B中是sharding_id=10010。\r\n运行explain指令，可以看到SQL在哪些分片节点执行的情况：\r\n\r\nmysql&gt; explain create table employee (id int not null primary key,name varchar(100),sharding_id int not null);\r\n+-----------+------------------------------------------------------------------------------------------------+\r\n| DATA_NODE | SQL &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|\r\n+-----------+------------------------------------------------------------------------------------------------+\r\n| dn1 &nbsp; &nbsp; &nbsp; | create table employee (id int not null primary key,name varchar(100),sharding_id int not null) |\r\n| dn2 &nbsp; &nbsp; &nbsp; | create table employee (id int not null primary key,name varchar(100),sharding_id int not null) |\r\n\r\n+-----------+------------------------------------------------------------------------------------------------+\r\n2 rows in set (0.00 sec)\r\nexplain不会真的执行的，放心试试吧！\r\nhttp://blog.csdn.net/socho/article/details/51869199\r\n创建于 2016-05-25 北京，更新于 2016-07-09 杭州</span></p><p><br/></p>', ',技术,', '431', '0', '2016-07-09 23:13:05', '2016-08-10 19:33:30', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('54', '1', 'docker容器扫盲', '', '', '0', '# Centos 6.5 安装和使用docker\r\n\r\n基于本人一贯的习惯，关于“某某某是什么”这样的问题，请百度吧，会有更专业的人士，会比我说的更详细更深，这里我只给出本人亲历的安装和使用过程。\r\n\r\n#### 1.安装\r\n\r\n先检查服务器环境，docker要求操作系统CentOS6以上，kernel 版本必须2.6.32-431或更高，即>=CentOS 6.5，运行docker时实际提示3.8.0及以上，必须64bit，32bit不支持docker。\r\n```\r\n[root@201 ~]# uname -r\r\n2.6.32-642.1.1.el6.x86_64\r\n```\r\ndocker的存储驱动是Device Mapper，看下你的驱动是否符合\r\n```\r\n[root@201 ~]# grep device-mapper /proc/devices\r\n253 device-mapper\r\n```\r\n看来我们符合以上要求，然后开始安装。\r\n\r\n对于centos 6.5 需要先安装源\r\n```\r\n[root@201 ~]# rpm -Uvh http://download.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm\r\n```\r\n注意centos 6要安装的是docker-io来源于Fedora epel库，是第三方库，所以先要确保安装了epel\r\n```\r\n[root@201 ~]# rpm -q epel-release\r\nepel-release-6-8.noarch\r\n```\r\nok，我们已经安装过epel，然后yum一下，稍等片刻就安装成功\r\n```\r\n[root@201 ~]# yum install docker-io -y\r\n```\r\n如果系统是centos 7则不用以上步骤，并且安装包是docker而不是docker-io\r\n```\r\n[root@201 ~]# yum install docker -y\r\n```\r\n#### 2.启动\r\n启动守护进程\r\n```\r\n[root@201 ~]# service docker start\r\n```\r\n查看启动信息\r\n```\r\n[root@201 data]# docker info\r\nContainers: 0\r\nImages: 0\r\nStorage Driver: devicemapper\r\n Pool Name: docker-253:0-286421-pool\r\n Pool Blocksize: 65.54 kB\r\n Backing Filesystem: extfs\r\n Data file: /dev/loop0\r\n Metadata file: /dev/loop1\r\n Data Space Used: 305.7 MB\r\n Data Space Total: 107.4 GB\r\n Data Space Available: 3.536 GB\r\n Metadata Space Used: 729.1 kB\r\n Metadata Space Total: 2.147 GB\r\n Metadata Space Available: 2.147 GB\r\n Udev Sync Supported: true\r\n Deferred Removal Enabled: false\r\n Data loop file: /var/lib/docker/devicemapper/devicemapper/data\r\n Metadata loop file: /var/lib/docker/devicemapper/devicemapper/metadata\r\n Library Version: 1.02.117-RHEL6 (2016-04-01)\r\nExecution Driver: native-0.2\r\nLogging Driver: json-file\r\nKernel Version: 2.6.32-642.1.1.el6.x86_64\r\nOperating System: <unknown>\r\nCPUs: 1\r\nTotal Memory: 996.2 MiB\r\nName: 201.liberalman.cn\r\nID: BHFO:EYCF:XVAZ:J637:2LUV:RR6Y:UR7Z:MZ43:PR4N:CGUD:7EAJ:5SBI\r\n```\r\n设置开机启动\r\n```\r\n[root@201 ~]# chkconfig docker on\r\n```\r\ndocker日志路径\r\n```\r\n/var/log/docker\r\n```\r\n\r\n#### 3.实例测试\r\n##### 测试1\r\n我们下载一个centos image\r\n```\r\n[root@201 data]# docker pull centos\r\nlatest: Pulling from centos\r\n3690474eb5b4: Pull complete\r\n342c399b9d0e: Pull complete\r\n915b9d3c92fc: Downloading 23.78 MB/70.58 MB\r\n915b9d3c92fc: Downloading 70.58 MB/70.58 MB\r\nd5c89a2047c8: Download complete \r\nDigest: sha256:14bc8ca808518a2703b6eff1a5f3b7065d4b5d4b388b575ae6a27db8791ab19b\r\nStatus: Downloaded newer image for centos:latest\r\n```\r\n列出镜像，指定centos关键词看看我们下载的镜像\r\n```\r\n[root@201 data]# docker images centos\r\nREPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE\r\ncentos              latest              d5c89a2047c8        33 hours ago        196.7 MB\r\n```\r\n我们下载了一个近200M的镜像，好，运行container\r\n```\r\n[root@201 data]# docker run -i -t centos /bin/bash\r\n[root@f41d95a52943 /]# \r\n```\r\n-t表示传递给容器tty终端，-i是interactive，表示可以交互。可以看到我的终端也由root@201 data变成了root@f41d95a52943，说明进入了容器的终端，要退出输入exit就可以。如果要新开一个终端进入我们之前启动的容器，先查询container id\r\n```\r\n[root@201 data]# docker ps -a\r\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\r\nf41d95a52943        centos              \"/bin/bash\"         12 minutes ago      Up 12 minutes                           backstabbing_poincare \r\n```\r\nid是f41d95a52943然后在新终端中登录\r\n```\r\ndocker exec -it f41d95a52943 /bin/bash\r\n```\r\n这样就可以登录了。\r\n\r\n我们在docker中起了一个centos的最小系统，登录到此系统[root@f41d95a52943 /]后，查看下其ip地址，发现没有ifconfig命令，使用 yum install net-tools 安装后\r\n```\r\n[root@f41d95a52943 /]# ifconfig\r\neth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\r\n        inet 172.17.0.1  netmask 255.255.0.0  broadcast 0.0.0.0\r\n        inet6 fe80::42:acff:fe11:1  prefixlen 64  scopeid 0x20<link>\r\n        ether 02:42:ac:11:00:01  txqueuelen 0  (Ethernet)\r\n        RX packets 10375  bytes 12736213 (12.1 MiB)\r\n        RX errors 0  dropped 0  overruns 0  frame 0\r\n        TX packets 5643  bytes 309098 (301.8 KiB)\r\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\r\n\r\nlo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536\r\n        inet 127.0.0.1  netmask 255.0.0.0\r\n        inet6 ::1  prefixlen 128  scopeid 0x10<host>\r\n        loop  txqueuelen 0  (Local Loopback)\r\n        RX packets 0  bytes 0 (0.0 B)\r\n        RX errors 0  dropped 0  overruns 0  frame 0\r\n        TX packets 0  bytes 0 (0.0 B)\r\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\r\n```\r\n可以看到我们docker中的centos系统，分配了一个ip 172.17.0.1，对外ping百度等网站可以ping通！是不是到此就结束了呢，当重启container的时候，你就会发现，ifconfig命令又没有了，默认是不会为我们保存修改的，所以需要我们提交对image的修改。在宿主机中查询容器id，然后提交修改\r\n```\r\n查看刚运行过的容器\r\n[root@201 ~]# docker ps -l\r\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                     NAMES\r\n4e108c90fa11        centos              \"/bin/bash\"         2 minutes ago       Up 2 minutes                                  ecstatic_franklin \r\n[root@201 ~]# docker start 4e108c90fa11\r\n4e108c90fa11\r\n然后连上去\r\n[root@201 ~]# docker exec -it 4e108c90fa11 /bin/bash\r\n安装net-tools包\r\n[root@4e108c90fa11 /]# yum install net-tools -y\r\n退出，在宿主机上提交评论\r\n[root@201 ~]# docker commit -m=\"add net-tools packages,nclude ifconfig command\" 4e108c90fa11\r\n129d59168480299c786d0585e9eb74fdbde3dcd00ee2cd2815d11b7749e53ac7\r\n```\r\n好，现在重新启动刚才的container，连上去试试ifconfig，就会发现ifconfig已经保存在image中了。\r\n\r\n##### 测试2\r\n宿主机上，我们在container上运行一个web服务器\r\n```\r\n[root@201 data]# docker run -d -P training/webapp python app.py\r\nUnable to find image \'training/webapp:latest\' locally\r\nlatest: Pulling from training/webapp\r\ne9e06b06e14c: Pull complete \r\n02a8815912ca: Download complete \r\nStatus: Downloaded newer image for training/webapp:latest\r\nf0b7172ab3a14e6f078e7b01310a3b027e28234baf44f4f6f1aa68465e854f60\r\n```\r\n这个web应用为docker官方提供，本地没有，所以自动去仓库下载，很方便的实现image，code 共享，并且到处运行。\r\nimage都是分层的，所以更改后构建比较快速。\r\n```\r\n[root@201 ~]# docker ps\r\nCONTAINER ID        IMAGE               COMMAND             CREATED              STATUS              PORTS                     NAMES\r\n272a09b3f713        training/webapp     \"python app.py\"     About a minute ago   Up About a minute   0.0.0.0:32768->5000/tcp   serene_jang \r\n```\r\n看到web服务器将docker内部的5000端口映射到我们宿主机的的32768端口，同时我们在宿主机上查看ip信息\r\n```\r\n[root@201 ~]# ps -ef|grep docker-proxy|grep -v \"grep\"\r\nroot      3163  3041  0 10:56 pts/0    00:00:00 docker-proxy -proto tcp -host-ip 0.0.0.0 -host-port 32768 -container-ip 172.17.0.1 -container-port 5000\r\n[root@201 ~]# netstat -npl|grep 32768\r\ntcp        0      0 :::32768                    :::*                        LISTEN      3163/docker-proxy \r\n[root@201 ~]# ifconfig\r\ndocker0   Link encap:Ethernet  HWaddr 82:EA:95:80:A9:F3  \r\n          inet addr:172.17.42.1  Bcast:0.0.0.0  Mask:255.255.0.0\r\n          inet6 addr: fe80::c057:bbff:fe36:55cf/64 Scope:Link\r\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\r\n          RX packets:9 errors:0 dropped:0 overruns:0 frame:0\r\n          TX packets:6 errors:0 dropped:0 overruns:0 carrier:0\r\n          collisions:0 txqueuelen:0 \r\n          RX bytes:612 (612.0 b)  TX bytes:468 (468.0 b)\r\n\r\neth0      Link encap:Ethernet  HWaddr 08:00:27:DD:0D:82  \r\n          inet addr:192.168.1.201  Bcast:192.168.1.255  Mask:255.255.255.0\r\n          inet6 addr: fe80::a00:27ff:fedd:d82/64 Scope:Link\r\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\r\n          RX packets:469 errors:0 dropped:0 overruns:0 frame:0\r\n          TX packets:304 errors:0 dropped:0 overruns:0 carrier:0\r\n          collisions:0 txqueuelen:1000 \r\n          RX bytes:46223 (45.1 KiB)  TX bytes:67929 (66.3 KiB)\r\n```\r\n宿主机的ip是192.168.1.201，我们访问这个web服务器，通过宿主机上的浏览器访问http://192.168.1.201:32768/，看到输出\r\n```\r\nHello world!\r\n```\r\n#### 4.制作属于自己的镜像\r\n\r\n突发奇想，制作一个mysql镜像，然后在自己服务器上开一堆mysql的服务，提供不同端口来访问，搞个集群什么的，呵呵\r\n\r\n首先创建一个目录/data/mysql，并创建一个Dockerfile文件，文件内容如下\r\nvim Dockerfile\r\n```\r\nFROM centos6:centos6\r\nMAINTAINER liberalman \"361509573@qq.com\"\r\n\r\nRUN yum install -y mysql-server\r\n\r\nRUN service mysqld start &&\\\r\n        mysql -e \"grant all privileges on *.* to \'socho\'@\'%\' identified by \'Looks137\';\"&&\\\r\n        mysql -u root -e \"show databases;\"\r\n\r\nVOLUME [\"/data/volume1\"]\r\nEXPOSE 3306\r\n```\r\n在Dockerfile所在目录下运行build命令来生成image文件，指定文件名mysql_test\r\n```\r\n[root@201 mysql]# docker build -t mysql_test ./\r\n...\r\nStarting mysqld:  [  OK  ]\r\nDatabase\r\ninformation_schema\r\nmysql\r\ntest\r\n...\r\nSuccessfully built ac45bc85be5e\r\n创建成功，查看镜像\r\n[root@201 ~]# docker images mysql_test\r\nREPOSITORY          TAG                 IMAGE ID            CREATED              VIRTUAL SIZE\r\nmysql_test          latest              ac45bc85be5e        About a minute ago   374.3 MB\r\n```\r\n这会创建一个在centos6系统上安装的mysql服务器，镜像名称是mysql_test，同时也会将centos6系统下载到本地来。好嘞，启动下\r\n```\r\n[root@201 ~]# docker run --name=mysqlserver -d -P mysql_test\r\na903be8b69fe540395e61a6cff3db16cf944ca1177cb581f7e591247a12b0737\r\n[root@201 ~]# docker ps\r\nCONTAINER ID        IMAGE               COMMAND                CREATED              STATUS              PORTS                     NAMES\r\na903be8b69fe        mysql_test         \"/usr/bin/mysqld_saf   About a minute ago   Up About a minute   0.0.0.0:32769->3306/tcp   mysqlserver \r\n```\r\n容器内的数据库已经启动了，而且映射到宿主机32769端口，连接下\r\n```\r\n[root@201 mysql]# mysql -hlocalhost -uroot -P 32769            \r\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\r\nYour MySQL connection id is 4\r\nServer version: 5.1.73 Source distribution\r\n\r\nCopyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.\r\n\r\nOracle is a registered trademark of Oracle Corporation and/or its\r\naffiliates. Other names may be trademarks of their respective\r\nowners.\r\n\r\nType \'help;\' or \'\\h\' for help. Type \'\\c\' to clear the current input statement.\r\n\r\nmysql>\r\n```\r\n连接正常，mysql可以用了。既然是用docker，我们就要体现它的牛逼之处，所以我要启动2个以上的mysql容器，以后用来做数据库集群也可以啊，哈哈\r\n```\r\n[root@201 ~]# docker run -p 3307:3306 --name=mysqlserver1 -d -P mysql_test1 \r\n8126d375d2f832a0381704424b45669178bc718598c1c8fa8868587455df6fed\r\n[root@201 ~]# docker run -p 3308:3306 --name=mysqlserver2 -d -P mysql_test  \r\nad920abde38b249e35600bf75f64bc44e7a007b399995e4e0fa17e7c9e5ed1a2\r\n[root@201 ~]# docker ps\r\nCONTAINER ID        IMAGE               COMMAND                CREATED              STATUS              PORTS                     NAMES\r\nad920abde38b        mysql_test         \"/usr/bin/mysqld_saf   21 seconds ago      Up 20 seconds       0.0.0.0:3308->3306/tcp    mysqlserver2\r\n8126d375d2f8        mysql_test         \"/usr/bin/mysqld_saf   About a minute ago   Up About a minute   0.0.0.0:3307->3306/tcp    mysqlserver1        \r\na903be8b69fe        mysql_test         \"/usr/bin/mysqld_saf   34 minutes ago       Up 34 minutes       0.0.0.0:32769->3306/tcp   mysqlserver \r\n```\r\n看吧，启动三个容器，分别按32769、3307、3308三个不同的端口连接都OK，数据库相互独立不影响。\r\n\r\n做了以上的活还不够，如果真的要在生产环境中使用多个mysql，最好在Dockerfile文件中设置容器中mysql的datadir目录挂载宿主机目录下，以便将真实产生的数据写入到宿主机中，否则容器一关闭所有的数据就丢失了，当然不同容器挂载到宿主机中的目录一定要不同，千万不要数据混淆了\r\n```\r\nVOLUME [\"/var/lib/mysql\"]\r\n```\r\n好了，到此写了很多，先写到这里，接下来研究怎么做弹性伸缩和扩容！\r\n#### 5.docker命令\r\n关闭容器\r\n- docker stop 容器名\r\n- docker kill    容器名\r\n\r\n杀死所有正在运行的容器\r\n- docker kill $(docker ps -a -q)\r\n\r\n删除所有已经停止的容器\r\n- docker rm $(docker ps -a\r\n\r\n删除所有未打 dangling 标签的镜像\r\n- docker rmi $(docker images -q -f dangling=true)\r\n\r\n通过image id删除镜像\r\n- docker rmi -f <image id>\r\n\r\n删除所有镜像\r\n- docker rmi $(docker images -q)\r\n\r\n搜索和centos相关的镜像\r\n```shell\r\n[root@201 data]# docker search centos\r\nNAME                          DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED\r\ncentos                        The official build of CentOS.                   2453      [OK]       \r\njdeathe/centos-ssh            CentOS-6 6.8 x86_64 / CentOS-7 7.2.1511 x8...   26                   [OK]\r\nnimmis/java-centos            This is docker images of CentOS 7 with dif...   13                   [OK]\r\nmillion12/centos-supervisor   Base CentOS-7 with supervisord launcher, h...   12                   [OK]\r\nconsol/centos-xfce-vnc        Centos container with \"headless\" VNC sessi...   10                   [OK]\r\ntorusware/speedus-centos      Always updated official CentOS docker imag...   8                    [OK]\r\nnickistre/centos-lamp         LAMP on centos setup                            4                    [OK]\r\n...\r\n```\r\n\r\n查看运行中某个容器的进程，容器id是f41d95a52943\r\n```shell\r\n[root@201 data]# docker top f41d95a52943\r\nUID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD\r\nroot                5845                5388                0                   14:23               pts/2               00:00:00            /bin/bash\r\n```\r\n\r\n查询日志\r\n- docker logs <容器id>\r\n\r\n#### 6.遇到问题\r\n1.启动失败，查看日志文件后，发现\r\nsymbol dm_task_get_info_with_deferred_remove, version Base not defined in file libdevmapper.so.1.02 with link time reference\r\n\r\n解决办法：执行：yum upgrade device-mapper-libs\r\n\r\n\r\n2.Error response from daemon: Cannot start container d9bf569e3f0db33bc3d800cca4e6be1ccf7ac89e91951ba6486e3239f92516a5: [8] System error: mountpoint for cgroup not found\r\n\r\n解决办法：因为cgroup在宿主机上没有挂载。\r\n\r\nvim /etc/fstab\r\n\r\nnone        /sys/fs/cgroup        cgroup        defaults    0    0\r\n\r\n重启机器，docker也重启下即可\r\n\r\n3.Conflict. The name \"mysqlserver\" is already in use by container 19a5ab1401f6\r\n\r\n命名冲突问题，删掉\r\n\r\ndocker rm mysqlserver\r\n\r\n****\r\n>创建于 2016-07-21 杭州，更新于 2016-07-22 杭州。\r\n\r\n>该文章在以下平台同步\r\n- >LIBERALMAN:\r\n- >CSDN:http://blog.csdn.net/socho/article/details/51999744\r\n- >简书:http://www.jianshu.com/p/3ffa4e5cbb86test-editormd', ',技术,', '39', '0', '2016-07-22 22:54:08', '2016-07-22 22:54:22', '0', null, '0', null);
INSERT INTO `tb_post` VALUES ('57', '1', '没有几个人真正希望你过得好', '', '', '0', '[![没有几个人真正希望你过的好](http://img2.manshijian.com/upload/member/image/56628/85905dcd2a8e324fb53f49e4730d6316.jpg \"没有几个人真正希望你过的好\")\r\n01\r\n\r\n我作为家族里学历最高的孩子，毕业后却一直混得不怎么好，收入一直在贫困线水准。邻里聚会每当谈到收入问题的时候，总是我最难受的时刻。\r\n\r\n去年换了一个不错的工作，待遇水平有了大幅的飞升，爸妈知道后都挺高兴。过年回家后，终于有人问起这个一年一度的问题，我的话刚说到嘴边，爸爸就接了一句：“还和往常一样，也就刚够糊口。只是稳定，书读多了也没什么用。众亲戚说，稳定就不错了。”\r\n\r\n我当时十分不理解，平时那么好面子的爸爸，终于到了可以扬眉吐气的时候，为什么突然变得那么低调。\r\n\r\n过了很久我懂得了爸爸的深意，才发现他不愧是老江湖，很多问题上看得比我要透彻。\r\n\r\n这个世界上，除了少数几个最亲近的人，比如家人，比如最好的朋友，大多数的人来了解你的近况，他们也只是问问而已，并不是真正希望你过得好，过得幸福。甚至来说，他们只是想要确认一下，确认你是不是还过得不如意，如果是，确认你没有威胁，那么他们就放心了。特别是你曾经考过好的学校，抢过风头的这种，你现在跌得越惨，别人就会觉得越有快感。\r\n\r\n如果你告诉他们你过得还不错，你要么走向了他的对立面，要么就成为了他的借钱对象。无论是哪个结果，对你都没有好处。\r\n\r\n爸爸很高明，选择了隐藏自己，别人听了开心，自己也不会活成一个靶子。\r\n\r\n02\r\n\r\n有一次，和一个朋友在一起玩，她掏出手机把她朋友圈的一个女生和男友发的自拍照指给我看，说：“前天我还听说她被男友打了，据说她给这男的戴了绿帽子，明明这么骚，还装出一副傻白甜的样子，真是恶心。”说完她点开了评论窗口。\r\n\r\n我以为他要戳穿真相，马上就要看到一场撕逼大戏了。没想到她回复的是：亲爱的，一定要幸福哦，么么哒。\r\n\r\n除了亲近的人，很多人表面上在祝福你，其实他可能比谁都希望看到你跌倒的样子。他们的心理就像我们看喜剧片一样，主角捅的篓子越大、出的糗越丢人，我们就觉得越开心。\r\n\r\n进化了这么多年，很多人骨子里还保留着一套丛林法则。他们总会留一个心眼和身边的人比较，同水平出发，一旦别人超过自己，就会觉得不舒服，有危机感，难受。\r\n\r\n看到你跑在他前面，有的可能会奋起直追；有的则会提起腿，对着你的屁股就是一脚，或者悄悄地伸长腿，放在你前面，给你使个绊子，心里想谁叫你这么得瑟。\r\n\r\n03\r\n\r\n我的朋友冬冬毕业后一直混得不错，进了一家好公司，老板很赏识他。工作一年多，顶头上司泄露公司机密，被辞退，他就顺利上位了。去年房地产市场大热，他更是赚得盆满钵满，简直是同学中少有的人生赢家。\r\n\r\n可是在同学朋友面前，他却总是一副苦大仇深的样子。\r\n\r\n朋友圈里经常发一些加班到深夜的照片，还配上“方便面买了但是还来不及吃”的文字，一副苦逼加班狗的形象；\r\n\r\n月初信用卡帐单一到，就PO出去，哀叹说，又要砸锅卖铁还债了。\r\n\r\n虽然只是偶尔发一下状态，但苦逼的印象已经建立。周围的朋友都喜欢找他聊天，生活中遇到什么烦心事跟他聊一聊，总能发现他比自己还惨，于是心情就好多了。所以虽然他哭惨，但是人缘奇好。\r\n\r\n而我是少有知道他真实现状的人，每次看到他，我都笑他太假了，至于演得这么凄苦吗。然后他就反问我，那你知道小林吗？\r\n\r\n我说知道啊，挺好的一个孩子，不知为啥，怎么说做微商就做微商了。\r\n\r\n冬冬笑着说，我和她曾经是同桌，可是她没卖过我一张面膜，你和她都没同过班吧，据我所知，你已经从她那买了好几百张啦。平时我给她一个过得不好的印象，她也没好意思过来找我推销。所以说，有时候还是低调点好，起码无关紧要的事情不会找上你。\r\n\r\n冬冬继续说，当然我也不是说硬要当个守财奴，朋友有难该帮的还是要帮。比如前不久大学的老班长买房，需要凑首付，我就支援了一些。他知道我过得并不好，开始硬是不好意思要。后来拿了后感动得不得了，觉得我才是真哥们。据说班里的大头也一样借了他十万，大家都知道大头收入不错。他支援一点大家觉得理所应当，并不觉得有多情深意重。相反，要是他没有任何动作，估计背后都有人说他了。\r\n\r\n看到了吧，你装逼，虽然不会遭雷劈，但你说出多大的话，就要承担多大的义务，你可以说，我混的好，关别人鸟事。但别人不这么认为，他们只为觉得你小气，觉得你是土豪，就得分田地。\r\n\r\n冬冬是个聪明人，充分领悟了“闷声发大财”的精髓，决不去图一时的面子。用他的话说：\r\n\r\n“面子有什么用，逞一时口舌之快，往后将是无尽的烦恼。一旦你在圈子里拔尖，别人要么想着绊倒你，要么想着分享你的果实。这个世界，压根就没有多少人希望你过得比他们好。”\r\n\r\n当然，如果你远远超过常人，像马云一样，旁人嫉妒就会换成崇拜，而且也完全不怕别人的掣肘，就没有这么多烦恼。\r\n\r\n可是，又有几个人做得了马云呢。所以，我们还是嘴巴老实点好。\r\n\r\n- THE END -\r\n\r\n作者：韩大茄', ',思想,', '53', '0', '2016-08-03 11:25:18', '2016-08-10 15:32:51', '0', null, '1', 'http://www.manshijian.com/articles/article_detail/193449.html');
INSERT INTO `tb_post` VALUES ('58', '1', 'epoll边沿触发漏报消息包问题', '', '', '0', '开发一个即时通讯后台，底层的网络收发使用 epoll + main loop实现网络事件(conn、read、send)的异步触发读写，以达到能最大限度减少线程的IO等待，提高cup利用率的目的。\r\n\r\n实际使用中，会发现有少量并没有 因为访问后端阻塞 但是依然反馈慢到超时的情况，我们定义从客户端发消息到收到反馈，3s超时，而我们发现延迟可能好几分钟，这让我觉得肯定不是后端一些复杂逻辑导致的，逻辑层再复杂，也不至于这么慢，而且也没有服务器down的情况出现，而且跟踪发现这种情况是在过了午夜到凌晨这一段时间发生。虽然这种情况很少，而且难以复现，经过不遗余力的跟踪，还是让我找到了问题的结症。\r\n\r\n问题定位：\r\n服务器基本的架构分为接入层+逻辑层+存储层。\r\n\r\n\r\n```sequence\r\nparticipant 客户端1\r\nparticipant 客户端2\r\n客户端1->网关: (1)msgA\r\n网关->逻辑层: (2)msgA\r\n逻辑层-->网关: (3)msgA\r\n逻辑层->存储层: (3\')msgA\'copy\r\n网关-->客户端2: (4)msgA\r\n```\r\n\r\n消息流动从客户端1-->网关-->逻辑层-->网关-->客户端2依次排查。其中逻辑层往存储层拷贝消息是在和逻辑层将消息转发回网关同时进行的，采用异步入库的方式存储消息日志。\r\n \r\n 我在上图中的每一个节点都打印日志，时间精确到毫秒。通过tcpdump抓下的16进制包和机器、客户端上的日志时间戳对比分析，不断的在测试环境尝试复现，最终确定，在(3)这个环节出现了延迟问题。\r\n \r\n原来会有这种情况出现，在逻辑层服务器收到一个包后，其在tcp缓冲区中待着不动，没有取出来，等到我再发一个消息过来的时候，才会将其冲出来。加入我一直不发消息，等个几分钟它就几分钟不出来。\r\n\r\n此时我猛然想到曾经看到过的资料，对于epoll的边沿触发模式，据说会发生tcp包漏报的情况，我想我这里应该就是漏报了，等下回新包来的时候，再一起给报出来。\r\n\r\n从网上找了别人的两张图\r\n\r\n![从socket读数据](http://img.blog.csdn.net/20160805111824193)\r\n\r\n![往socket写数据](http://img.blog.csdn.net/20160805111851945)\r\n\r\n水平触发(LT)下只要某个 socket 处于 readable/writable 状态，无论什么时候进行 epoll_wait 都会返回该 socket；而 边沿触发(ET) 模式下只有某个 socket 从 unreadable 变为 readable，或从unwritable 变为writable时，epoll_wait 才会返回该 socket。\r\n\r\n从这两张图中可以得知，在水平触发，或者使用select的时候，只要缓冲区中有数据，哪怕一次没有读完，main loop下次循环依然会报有数据，继续读就ok了。但是边沿触发的时候，假如上次读取了一部分数据，导致剩余数据低于边沿触发的水位线，其不会触发读回调函数，那么这个时候，消息就会一直待在tcp的缓冲区中，直到下一次有新的消息过来，触发了水位线才会再读出。\r\n\r\n于是将tcpdump抓到的包进行分析，我的协议包头两个字节代表协议版本、控制参数什么的，第3、4两个字节代表包长。我一次性发两个逻辑包，我发现tcpdump抓到了两个我的逻辑包，但是测试服务器终端只打印了第一个逻辑包，第二个不见了，于是印证了我的猜测，第二个果然躺在tcp缓冲区中挺尸啊！然后再发一次消息，果然把上一个给挤出来了，在结合tcp抓包，对上了。这是很典型的ET工作模式！说明有多个包黏在一起同时到达的时候，每次读回调只处理一个包。当然，这里多个包同时到达的问题，我觉得不是问题，tcp本来就允许这样啊。造成这个问题是因为我只关心了一个逻辑包的处理，没想到会黏包，而且还非要用高大上的ET边沿触发。下来看看我写的改进代码\r\n\r\n```c\r\nint n = 0;\r\nwhile(1)  \r\n{  \r\n    nread = read(fd, buf + n, BUFSIZ-1);//非阻塞的读，返回每次读的数据大小\r\n    if(nread < 0)  \r\n    {  \r\n        if(errno == EAGAIN || errno == EWOULDBLOCK)  //对于EAGAIN和EWOULDBLOCK要循环回去继续读，这种异常不要管它\r\n        {  \r\n            continue;  \r\n        }  \r\n        else  \r\n        {  \r\n            break;//or return;  \r\n        }  \r\n    }  \r\n    else if(nread == 0)  \r\n    {  \r\n        break;//0代表数据读完了 \r\n    }  \r\n    else  \r\n    {  \r\n        n += nread;  \r\n    }  \r\n}  \r\n\r\n```\r\n\r\n问题解决：\r\n找到问题后，就很容易解决了：每次读回调被触发的时候，读完一个逻辑包后，紧接着试探是否还有数据未读，有未读继续读，直到读完再退出，修改epoll_ctl到反向的模式。\r\n\r\n****\r\n> 创建于 2015-04-25 北京，更新于 2016-08-05 杭州\r\n\r\n>该文章在以下平台同步\r\n- >LIBERALMAN:http://api.liberalman.cn:40000/article/58\r\n- >CSDN:http://blog.csdn.net/socho/article/details/52127663\r\n- >简书:\r\n\r\n- [ ]  引用\r\n', ',技术,', '164', '0', '2016-08-05 11:50:02', '2016-08-10 16:01:02', '0', null, '0', '');
INSERT INTO `tb_post` VALUES ('59', '1', 'epoll 边沿触发和水平触发区别实战讲解', '', '', '0', '```c\r\n#include <stdio.h>\r\n#include <stdlib.h>\r\n#include <string.h>\r\n#include <errno.h>\r\n#include <unistd.h>\r\n#include <fcntl.h>\r\n#include <arpa/inet.h>\r\n#include <netinet/in.h>\r\n#include <sys/socket.h>\r\n#include <sys/epoll.h>\r\n\r\n/* 最大缓存区大小 */\r\n#define MAX_BUFFER_SIZE 5\r\n/* epoll最大监听数 */\r\n#define MAX_EPOLL_EVENTS 20\r\n#define EPOLLLT 0\r\n\r\n/* 设置文件为非阻塞 */\r\nint set_nonblock(int fd)\r\n{\r\n    int old_flags = fcntl(fd, F_GETFL);\r\n    fcntl(fd, F_SETFL, old_flags | O_NONBLOCK);\r\n    return old_flags;\r\n}\r\n\r\n/* 出错处理 */\r\nvoid err_exit(char *msg)\r\n{\r\n    perror(msg);\r\n    exit(1);\r\n}\r\n\r\n/* main函数 */\r\nint main(int argc, const char *argv[])\r\n{\r\n    int listenfd, epollfd, nfds, reuse = 1;\r\n    struct sockaddr_in server_addr;\r\n    struct epoll_event events[MAX_EPOLL_EVENTS];\r\n\r\n    if (argc < 3)\r\n    {\r\n        fprintf(stderr, \"usage:%s ip_address port_number\\n\", argv[0]);\r\n        exit(1);\r\n    }\r\n\r\n    memset(&server_addr, 0, sizeof(server_addr));\r\n    server_addr.sin_family = AF_INET;\r\n    server_addr.sin_port = htons(atoi(argv[2]));\r\n\r\n    if (inet_pton(PF_INET, argv[1], &server_addr.sin_addr) == -1)\r\n        err_exit(\"inet_pton() error\");\r\n\r\n    if ((listenfd = socket(PF_INET, SOCK_STREAM, 0)) == -1)\r\n        err_exit(\"socket() error\");\r\n\r\n    /* 设置复用socket地址 */\r\n    if (setsockopt(listenfd, SOL_SOCKET, SO_REUSEADDR, &reuse, sizeof(reuse)) == -1)\r\n        err_exit(\"setsockopt() error\");\r\n\r\n    if (bind(listenfd, (struct sockaddr *)&server_addr, sizeof(server_addr)) == -1)\r\n        err_exit(\"bind() error\");\r\n\r\n    if (listen(listenfd, 5) == -1)\r\n        err_exit(\"listen() error\");\r\n\r\n    if ((epollfd = epoll_create(256)) == -1)\r\n        err_exit(\"epoll_create1() error\");\r\n\r\n    /////////////////////////////////////////////////////////////\r\n    /* 设置监听socket：LT，noblock */\r\n    /* 设置监听socket：ET，noblock */\r\n    struct epoll_event ep_event;\r\n    ep_event.data.fd = listenfd;\r\n    ep_event.events = EPOLLIN | EPOLLLT; // EPOLLET\r\n    set_nonblock(listenfd); // 设置是否非阻塞\r\n    epoll_ctl(epollfd, EPOLL_CTL_ADD, listenfd, &ep_event);\r\n    /////////////////////////////////////////////////////////////\r\n\r\n    printf(\"监听socket=%d\\n\", listenfd);\r\n\r\n    while (1)\r\n    {\r\n        printf(\"\\n================================= epoll_wait() =================================\\n\\n\");\r\n        nfds = epoll_wait(epollfd, events, MAX_EPOLL_EVENTS, -1);\r\n        if (nfds == -1)\r\n            err_exit(\"epoll_wait() error\");\r\n        else\r\n        {\r\n            struct sockaddr_in client_addr;\r\n            socklen_t client_addrlen;\r\n            int newfd, connfd;\r\n            int i, ret, sec;\r\n\r\n            for (i = 0; i < nfds; i++)\r\n            {\r\n                newfd = events[i].data.fd; //取出事件的fd\r\n                if (newfd == listenfd) //当新事件的fd和我们的主监听fd相同时，说明这是建立新连接的请求\r\n                {\r\n                    printf(\"--------------------------------- events[%d],新连接 -----------------------------\\n\", i);\r\n                    /* 休眠3秒，模拟一个繁忙的服务器，不能立即处理accept连接 */\r\n                    //sec = 3;\r\n                    //sleep(sec);\r\n                    //printf(\"服务器繁忙，等待了%d秒，现在开始accept..\\n\", sec);\r\n\r\n                    client_addrlen = sizeof(client_addr);\r\n                    connfd = accept(listenfd, (struct sockaddr *)&client_addr, &client_addrlen);\r\n                    /* 注册connfd到epoll，并设置是LT,默认阻塞 */\r\n                    struct epoll_event ep_event;\r\n                    ep_event.data.fd = connfd;\r\n                    ep_event.events = EPOLLIN | EPOLLLT;\r\n\r\n                    set_nonblock(connfd);\r\n\r\n                    epoll_ctl(epollfd, EPOLL_CTL_ADD, connfd, &ep_event);\r\n                    printf(\"accept(connfd = %d) 已加入accept列表\\n\", connfd);\r\n                } else if (events[i].events & EPOLLIN) { // EPOLLIN 有数据进来\r\n                    /* 可读事件处理流程 */\r\n                    printf(\"--------------------------------- events[%d],EPOLLIN ---------------------------\\n\", i);\r\n                    char buffer[MAX_BUFFER_SIZE];\r\n                    int ret;\r\n\r\n                    memset(buffer, 0, MAX_BUFFER_SIZE);\r\n                    ret = recv(newfd, buffer, MAX_BUFFER_SIZE, 0); //阻塞模式下的recv调用\r\n                    printf(\"recv() %d 字节数据\\n\", ret);\r\n                    if (ret > 0)\r\n                        printf(\"recv>%s\\n\", buffer);\r\n                    else\r\n                    {\r\n                        if (ret == 0)\r\n                            printf(\"客户端主动关闭！！！\\n\");\r\n                        close(newfd);\r\n                    }\r\n                } else\r\n                    printf(\"other msg ...\\n\");\r\n            } \r\n        }\r\n    }\r\n\r\n    close(listenfd);\r\n    return 0;\r\n}\r\n\r\n```\r\n\r\n#### 1.将监听socket设置为==LT，noblock==\r\n\r\n监听socket，也就是main函数一开始定义的 listenfd，现在测试它的连通性。我们使用nc命令来进行测试，如果没有，则执行 yum install nc -y 安装。首先开启我们的服务\r\n```\r\n[root@201 test]# ./a.out 0.0.0.0 5000\r\n```\r\n然后新开一个终端，连续执行5次测试命令\r\n```\r\n[root@201 test]# nc localhost 5000&\r\n[1] 7560\r\n[root@201 test]# nc localhost 5000&\r\n[2] 7561\r\n[root@201 test]# nc localhost 5000&\r\n[3] 7562\r\n\r\n[1]+  Stopped                 nc localhost 5000\r\n[root@201 test]# nc localhost 5000&\r\n[4] 7563\r\n\r\n[2]+  Stopped                 nc localhost 5000\r\n[root@201 test]# nc localhost 5000&\r\n[5] 7564\r\n\r\n[3]+  Stopped                 nc localhost 5000\r\n[root@201 test]# jobs\r\n[1]   Stopped                 nc localhost 5000\r\n[2]   Stopped                 nc localhost 5000\r\n[3]-  Stopped                 nc localhost 5000\r\n[4]   Stopped                 nc localhost 5000\r\n[5]+  Stopped                 nc localhost 5000\r\n\r\n```\r\n在我们服务端看到打印出如下日志\r\n```\r\n[root@201 test]# ./a.out 0.0.0.0 5000\r\n监听socket=3\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],新连接 -----------------------------\r\n服务器繁忙，等待了3秒，现在开始accept..\r\naccept(connfd = 5) 已加入accept列表\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],新连接 -----------------------------\r\n服务器繁忙，等待了3秒，现在开始accept..\r\naccept(connfd = 6) 已加入accept列表\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],新连接 -----------------------------\r\n服务器繁忙，等待了3秒，现在开始accept..\r\naccept(connfd = 7) 已加入accept列表\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],新连接 -----------------------------\r\n服务器繁忙，等待了3秒，现在开始accept..\r\naccept(connfd = 8) 已加入accept列表\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],新连接 -----------------------------\r\n服务器繁忙，等待了3秒，现在开始accept..\r\naccept(connfd = 9) 已加入accept列表\r\n\r\n================================= epoll_wait() =================================\r\n\r\n\r\n```\r\n说明即便服务器很繁忙，也依然每次在等待了3s后将新的连接接入，connfd依次是5、6、7、8、9，链接没有漏报，5次全接入了。\r\n\r\n#### 2.将监听socket设置为==ET，noblock==\r\n\r\n先杀掉之前的测试程序，执行\r\n```\r\nfor i in {1..5};do kill %$i;done\r\n```\r\n然后用相同的方式测试，发起5次接入\r\n```\r\n[root@201 test]# ./a.out 0.0.0.0 5000\r\n监听socket=3\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],新连接 -----------------------------\r\n服务器繁忙，等待了3秒，现在开始accept..\r\naccept(connfd = 5) 已加入accept列表\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],新连接 -----------------------------\r\n服务器繁忙，等待了3秒，现在开始accept..\r\naccept(connfd = 6) 已加入accept列表\r\n\r\n================================= epoll_wait() =================================\r\n\r\n\r\n```\r\n看结果发现只接入了两条，还有3条没接入。说明高并发时，会出现客户端连接不上的问题。\r\n\r\n#### 3.将读写socket设置为==LT，block==\r\n读写socket，也就是那个connfd。此时的listenfd，我们就不用管了，当epoll_wait返回时，必定有事件发生，我们设置为非阻塞IO。重点是测试connfd。建立新连接的的时候，将如下代码设置成EPOLLLT，注释掉设置非阻塞的函数\r\n```c\r\n/* 注册connfd到epoll，并设置是LT还是ET,是否阻塞 */\r\nstruct epoll_event ep_event;\r\nep_event.data.fd = connfd;\r\nep_event.events = EPOLLIN | EPOLLLT;\r\n//set_nonblock(connfd);\r\n```\r\n这样就设置成功LT，block了。还有上面两例在测试时候设置的接入休眠部分的代码也可以注释掉了，这里不用模拟服务器忙了。这次我们更改下测试方式，只连接一个客户端，然后依次输入1~9个数字，发送\r\n```\r\n[root@201 test]# nc localhost 5000\r\n123456789 \r\n```\r\n看下服务端的反馈\r\n```\r\n[root@201 test]# ./a.out 0.0.0.0 5000\r\n监听socket=3\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],新连接 -----------------------------\r\naccept(connfd = 5) 已加入accept列表\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],EPOLLIN ---------------------------\r\nrecv() 5 字节数据\r\nrecv>12345\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],EPOLLIN ---------------------------\r\nrecv() 5 字节数据\r\nrecv>6789\r\n\r\n\r\n================================= epoll_wait() =================================\r\n\r\n```\r\n1~9在客户端是一条消息，但是到了服务端被拆分成了两次事件，打印了两条消息。水平触发触发了2次，我们代码里面设置的缓冲区是5字节，处理代码一次接收不完，水平触发一直触发，直到数据全部读取完毕。\r\n#### 4.将读写socket设置为==LT，noblock==\r\n测试结果同3相同，因为读、写的socket其实设置阻塞或者非阻塞，区别在于缓冲区是否可读写。当不能读写的时候，阻塞型的会一直等待直到可以读写；而非阻塞会立即返回，由我们再写代码决定下一步怎么做。\r\n#### 5.将读写socket设置为==ET，block==\r\n建立新连接的的时候，将如下代码设置成EPOLLET，注释掉设置非阻塞的函数\r\n```c\r\n/* 注册connfd到epoll，并设置是LT还是ET,是否阻塞 */\r\nstruct epoll_event ep_event;\r\nep_event.data.fd = connfd;\r\nep_event.events = EPOLLIN | EPOLLET;\r\n//set_nonblock(connfd);\r\n```\r\n相同方式再测试下\r\n```\r\n[root@201 test]# ./a.out 0.0.0.0 5000\r\n监听socket=3\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],新连接 -----------------------------\r\naccept(connfd = 5) 已加入accept列表\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],EPOLLIN ---------------------------\r\nrecv() 5 字节数据\r\nrecv>12345\r\n\r\n================================= epoll_wait() =================================\r\n\r\n```\r\n边缘触发只触发了一次，只读取了5个字节。这就是传说中的ET的方式会漏报吗！继续在客户端发一个消息\'s\'\r\n```\r\n[root@201 test]# nc localhost 5000\r\n123456789\r\ns\r\n```\r\n这下终于把上次没报完的消息给逼出来了\r\n```\r\n[root@201 test]# ./a.out 0.0.0.0 5000\r\n监听socket=3\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],新连接 -----------------------------\r\naccept(connfd = 5) 已加入accept列表\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],EPOLLIN ---------------------------\r\nrecv() 5 字节数据\r\nrecv>12345\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],EPOLLIN ---------------------------\r\nrecv() 5 字节数据\r\nrecv>6789\r\n\r\n\r\n================================= epoll_wait() =================================\r\n\r\n```\r\n看到6789打印出来了，不过s字母还没打印。好我再输入一个字母\'b\'\r\n```\r\n[root@201 test]# ./a.out 0.0.0.0 5000\r\n监听socket=3\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],新连接 -----------------------------\r\naccept(connfd = 5) 已加入accept列表\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],EPOLLIN ---------------------------\r\nrecv() 5 字节数据\r\nrecv>12345\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],EPOLLIN ---------------------------\r\nrecv() 5 字节数据\r\nrecv>6789\r\n\r\n\r\n================================= epoll_wait() =================================\r\n\r\n--------------------------------- events[0],EPOLLIN ---------------------------\r\nrecv() 4 字节数据\r\nrecv>s\r\nb\r\n\r\n\r\n================================= epoll_wait() =================================\r\n\r\n```\r\n终于把之前的s和现在的b都打印出来了，原来上次的 s + 回车 两个字节，再算上本次的 b + 回车 总共4个字节，没超出缓冲区5字节的大小，所以都打印出来了。我们可以看到，阻塞的边缘触发，如果不一次性读完一个事件上的数据，会干扰下一个事件！！！\r\n\r\n\r\n', ',技术,', '124', '0', '2016-08-05 22:03:23', '2016-08-06 00:07:48', '0', null, '0', '');
INSERT INTO `tb_post` VALUES ('60', '1', '我爱这土地', '', '', '0', '假如我是一只鸟，\r\n\r\n我也应该用嘶哑的喉咙歌唱：\r\n\r\n这被暴风雨所打击着的土地，\r\n\r\n这永远汹涌着我们的悲愤的河流，\r\n\r\n这无止息地吹刮着的激怒的风，\r\n\r\n和那来自林间的无比温柔的黎明 ……\r\n\r\n——然后我死了，\r\n\r\n连羽毛也腐烂在土地里面。\r\n\r\n为什么我的眼里常含泪水？\r\n\r\n因为我对这土地爱得深沉 ……\r\n****\r\n  by 艾青 1938', ',思想,', '309', '0', '2016-08-06 21:23:32', '2016-08-06 21:35:03', '0', null, '1', '《我爱这土地》——艾青');
INSERT INTO `tb_post` VALUES ('61', '1', '历史选择儒家而不选墨家的原因', '', '', '0', '#历史选择儒家而不选墨家的原因\r\n######——浅析墨家与儒家之不同命运\r\n儒家，孔孟文化为源，走中庸礼乐之道；墨家，兼爱非攻，尚贤尚同，走实用主义路线。同是“百花齐放，百家争鸣”中的一朵奇葩，历史，为什么选择了儒家而非墨家？思想网络同样都涵盖了政治、经济、文化、教育、军事等诸方面，为什么不是墨家受到统治者的青睐？\r\n首先须明确一点，这里所讲的“历史”是有时间局限的：自汉武帝实行“罢黜百家，独尊儒术”的文化专制主义政策后，墨家学派便渐趋消亡，直到清代才有人开始重新校注《墨子》，所以之于对儒家和墨家的取舍，主要在春秋战国至西汉这段时期罢了。\r\n\r\n  在我看来，两家的不同命运是有多重原因的，不仅有思想本身的原因，也有思想家的影响因素，同时历史机遇也是不容忽视的原因之一。\r\n  \r\n  首先，儒墨两家的不同思想主张，构成了两家不同命运之根本。\r\n  \r\n  墨家思想的本身缺点首先影响了墨家思想的可采纳性：\r\n  \r\n  在我看来，墨家思想上的缺点主要有四点。第一点，过于极端。比如说对于礼乐的极端的排斥态度。墨子认为王公大人对于礼乐的追求，只会造成“亏夺民衣食之财”（《非乐上》），并通过男子敲乐耽误农桑、用赋税制造琴瑟不符合圣王的原则等论据，得出“为乐非也”的结论。这虽是墨子在当时社会物质生产极端匮乏情况下的一种无奈之举，但是墨家未能认识到声乐丰富文化、愉悦放松身心等的积极意义。一味的否定和排斥礼乐，是不利于社会全面发展和历史进步的。另外，如主张节省消费的“节用”观等观点认为只要食能果腹，衣可御寒即可，再往前一步，便是一种无益的消费，也带有“极端”的倾向，是不适宜生活提高，社会发展的。第二点，不合情理。墨家主张“丈夫年二十，毋敢不处家，女子年十五，毋敢不侍人”早婚早生子，以增加人口，增加劳动力，这也是一种幼稚的想法。十五是女子的最大限度，这实在说不过去。人事未通，自身的发育都还没有完全的女子便让她去做母亲，根本不合情理。同时，墨家《贵义》篇中提出“必去喜、去怒、去乐、去悲、去爱，而用仁义”试问爱欲去尽，“仁义”又从哪里来？主张“兼爱”却又扬言“去爱”岂不自相矛盾，不合情理？第三点，本身自相矛盾。墨子通过史书上记载的杜伯报仇周宣王、庄子仪报仇燕简公、死羊显灵断真假等事例，论证得出“则鬼神之有，岂可疑哉？”的结论，并借此说明“虽有深溪博林，幽涧毋人之所，施行不可以不董”的主张。但与此同时，墨子还主张“非命”，认为人的命运要靠自己把握，一方面鼓吹鬼神的干涉作用，一方面又强调人的主观能动性，两者岂不矛盾？第四点，畸形的“宗教主义”。墨家弟子效仿墨子“以裘褐为衣，以跂硚为服，日夜不息，以自苦为极”和“摩顶放踵，利天下为之”的行为，过着清苦的生活，这颇似宗教的禁欲主义。墨者为理想不惜牺牲生命的表现更似宗教的“殉教”行径。这几点在我看来是不值得提倡的，因为墨家不是真正的宗教，原因有二：第一，墨家虽然承认天和鬼神的存在，但它更重视对现实世界的改造，它的理想在于改造此岸世界，而不在于追求彼岸世界的天国的幸福。天、鬼神在墨子的宗教观中都是作为其政治理想的代言人出现的，并非作为崇拜偶像出现的。第二，墨家的“节用”、“节葬”、“非乐”等主张，都是针对统治者的奢侈腐化的生活而提出的，其旨在维护劳动人民的利益。墨者的生活简朴、勤于劳作应视为劳动者的本色，而不是什么清教徒和殉教。\r\n  \r\n  墨家思想与当时社会状况的冲突，对当时历史环境的不适应，也是墨家思想不被青睐的决定性原因。这主要表现在以下三个方面：\r\n  \r\n  第一个方面，墨家思想不符合封建统治阶级的“口味”。墨子说：“君，以若(顺)民者也”，可见，墨家的法制不是顺君而是顺民；国家的宪令也不是利君而是利民，故他说：“功，利民也”，利民者赏，“赏，上报下之功也”。墨子义正言辞的指出：建国立君，并不是为王公们的富贵淫佚，“将以为万民兴利，除害，富贫，众寡”。所谓“富贫”，则人民贫困，就需要“强本节用”，使人民富裕。所谓“众寡”，则人口少，劳动力不足，就必须“内（宫）无拘女，外无寡夫”，使人口增长。如是，则人民富庶，国家兴旺。这一观点在《十论》及《七患》《辞过》皆有所阐明和发挥，说明了墨家主张建立的国家是人民的，墨家是站在人民的立场上的呐喊者，这与自春秋战国就开始的封建社会的统治阶级的利益是极相排斥的。历代封建统治阶级无不想加强统治，维护自己的利益，达到专制目的，岂会搬起墨家的石头砸自己的脚？而与此相反，儒家的“三纲五常”“天人合一”等封建思想正是对等级制度的划分与规范，正对了统治阶级的“口味”。\r\n第二点，破坏了封建等级观念和制度。这一点在《尚贤》《兼爱》篇中表现尤为突出，墨子的尚贤是彻底的，他要求“举义不避贫贱”“举义不避亲疏”“举义不避远近”，“兼相爱，交相利”，贵族、贫民不分贵贱，一视同仁，相等机会，这实际上打破了封建社会的等级观念，仅此而言，其思想之高远与宏达即已非其他周秦诸子所可同日而语者。当然，也正因如此，墨子在中国漫漫数千年的封建文化中几乎没有自己的立足之地。相反，儒家虽然也主张“爱”，但是儒家主张的是“仁者爱人”，是以“亲亲”为基础的，是有等级差别的爱，这正与森严的封建社会等级体系相适应。故而，又构成一个选儒不选墨的因素。第三点，对于君主的约束极多。墨子认为君主应该 “当为宫室，不可不节” “当为衣服，不可不节”“当为食饮，不可不节”“当为舟车，不可不节”“当蓄私，不可不节”，墨子把国君的吃、穿、住、行、甚至娶老婆的个数都管了个遍，认为国君只要满足基本需要就可以了，然而作为封建金字塔体制的致高点，国君恰恰需要宏伟的宫阁台榭来铸造威严，华裳龙袍体现他的与众不同，华盖出行表现他的天下独尊，食饮天下以示大全独揽，后宫充溢以彰显特权，墨家却一一给他削掉，国君又用何来展示他的龙威？所以说，国君不选择墨家思想作为统治思想也是情理之中的事。只是，在我看来，墨家之所以不受重视的致命原因还是源于它的“选天子”思想。《尚同》篇中，墨子说：“天下之所以乱者，生于无政长。是故选天下之贤可者，立以为天子。天子立，以其力为未足，又选择天下之贤可者，置立之以为三公。”“选天子”思想彻底的打破了封建帝王家族世袭的体制，与当时的封建政治产生了最为尖锐和深刻的矛盾。相反，儒家的“君君臣臣，父父子子”“君权神授”的拥君思想，则“聪明”的多，也受用的多。\r\n\r\n  其次，从思想代表及其后代弟子发展来说：\r\n  \r\n  墨家是一个有领袖，有学说，有组织的学派，但他们有强烈的实践精神。墨者们吃苦耐劳，严于律己，把维护公理与道义看作是义不容辞的责任。墨者大多是有知识的劳动者，战国后期分化为两支：一支注重认识论、逻辑学、几何光学、静力学等学科的研究，是谓“墨家后学”；另一支转化为秦汉社会的游侠，墨家思想的修缮几乎后继无人。韩非子说过：“儒以文乱法，而侠以武犯禁”，儒学一旦与政治同流，成为立法的根据，儒学便实现合法化；而以狭义自任的墨学，既然已做好同弱者共进退的准备，最后必然是走向强权政治的对立面，成为强权专制政权的眼中钉，肉中刺。墨家大致是在秦统一后迅速衰落，而凋谢于西汉中叶，及国家专制集权一成熟，墨家便无法生存下去。相反，儒家的发展却是持续旺盛的势头。由孔子及其弟子至孟子及其弟子至荀子及其弟子再到汉代的董仲舒……儒学一直在被随朝随代的修缮改造着，适应着历史的发展，故而在两千年封建社会中一直“长青不老”。\r\n  \r\n  再次，机遇也是影响儒墨不同命运的重要因素：\r\n  \r\n  汉初因诸侯割据势力膨胀，汉武帝决定采用董仲舒的“大一统”“君权神授”的儒家思想来加强思想统治，从而“罢黜百家，独尊儒术”，这一思想的提出更加快了墨家思想的灭亡和儒家思想的兴盛。虽然历史未有记载，但可以推测，在罢黜的百家思想中，墨家肯定是最受重创的一家，因为数百年的自由学术年代里墨家是唯一可以同儒学学派相抗衡的。清代学者汪中在《述学.墨子序》中写道：“与九流之中，唯儒足与之相抗，其余诸子，皆非其比”，而《韩非子.显学》也载：“世之显学，儒墨也”。从韩非子到汉武帝相去不过百年，而墨学从举世显学一举坠入深渊，以至于往后漫长的时间里，墨子的名字竟然极少为学者们提起，甚至于司马迁《史记》中也仅仅用了二十四个字来记述它。不能不说，历史机遇在两家的发展中也扮演了极为重要的角色。也许有人会说，那么，秦始皇“焚书坑儒”这一“机遇”不还是打压了儒家吗？这里需明确一点，秦朝是对法家以外的思想都排斥摧毁的，而庆幸的是儒家接着便被汉朝统治着扶持了，而墨家没有，所以说，“罢黜百家，独尊儒术”对于儒家来说仍是一个重要发展机遇。\r\n  \r\n   墨家沉睡了两千年，墨家的道义，注定其精神本质是无法苟合于集权的专制政体的。晚清墨学的复兴全然不是历史的巧合，当封建制度面临解体时，思想上的专制罗网也被撕开一角，而墨学作为中国古代具有先验性的思想理论，其复兴与重新受到重视，是顺理成章的事。\r\n   ', ',思想,', '90', '0', '2016-08-10 13:12:28', '2016-08-10 14:02:04', '0', null, '1', 'http://blog.sina.com.cn/s/blog_6f84559f0100nwlm.html');
INSERT INTO `tb_post` VALUES ('62', '2', '无题', '', '', '0', '\r\n6、神不贪，为何容不得一点对其不敬；神不恶，为何要将千万生灵命运握于手中？', ',思想,', '28', '0', '2016-08-13 22:06:32', '2016-08-13 22:07:34', '0', null, '0', '');
INSERT INTO `tb_post` VALUES ('63', '1', '柯南君：教你如何对待大型电商平台的性能优化？之 一 （方法、指标、工具、定位）', '', '', '0', ' 柯南君：教你如何对待大型电商平台的性能优化？之 一 （方法、指标、工具、定位）\r\n柯南君的朋友“闲哥”最近遇到了点困扰---”大型网站平台如何对待性能优化，以及如何针对性调优？“，柯南君今天，想谈一下性能优化的战略，主要是一些企业架构级别的技术和方法。柯南君将自己的个人经验和各家公司大咖的经验一起汇总给大家，如有瑕疵，请大家及时指正。\r\n\r\n柯南君有句自律的口头语“如果你不能成为一个追求性能的疯子，那么性能将会把你变成疯子”\r\n\r\n## 序曲：\r\n如何评估平台系统需求与性能指标？在这里，柯南君在这里小谈一下（因为每一家公司都不一样，所以，仅仅是举个例子）我先和大家探讨一下“性能测试方法”\r\n\r\n##### 1.V模型的标准测试策略\r\n\r\n![V模型的标准测试策](http://img.blog.csdn.net/20141120180244749?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc3VuMzA1MzU1MDI0c3Vu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)\r\n\r\n备注：\r\n       性能测试是V模型中验证整体系统的重要步骤', ',技术,', '36', '0', '2016-08-16 11:40:50', '2016-09-07 21:40:44', '0', 'http://img.blog.csdn.net/20141120180244749?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc3VuMzA1MzU1MDI0c3Vu/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center', '1', 'http://blog.csdn.net/sun305355024sun/article/details/41311617');
INSERT INTO `tb_post` VALUES ('68', '1', '知道哪些法律上的小常识可以保护自己？', '', '', '0', '哈哈 这个我擅长\r\n民事法官倾情推荐 全部来自实际案例 日常生活中常用实用小技巧 手机码字 大量干货居然干不到5个赞 实在打击我积极性 伯乐在哪里！！！\r\n一、合同借款类\r\n1、写合同或让他人打欠条，务必在对方落款名字后面让写上身份证号码，否则，后果你懂的；\r\n2、给人借钱：如果给现金，务必当日从银行取现而后保留取现的银行票据，ATM机取现则打印票据并保留、银行柜台取现则保留底单；如果转帐，同上，亦务必保留转帐凭证，同时不要注销掉该帐号。否则日后发生纠纷诉至法院，对方不认可，你亦没有提供资金来源，很可能败诉哦；\r\n3、借人高息的，在给人借款同时，不要马上就拿回当月或当年的利息，不然被拿回来的这部分不视为借款本金，你可以一起喝茶，喝完茶出来再拿嘛 何必急于一时呢；\r\n4、借人高息的，借条上千万不要不好意思写上利息哦，君知道，月息2分及以下都是可以支持的，写多了，大不了超过部分法院不支持。可系，如果你不写，对方法庭上不认可有利息，你就亏大发了哦，法院很有可能无证据不支持利息呢；\r\n5、关于诉讼时效，我看了下其他人答案，明显没有实践经验哦。如果你是借款方，可以和对方口头约定还款时间，但不要写在借条上哦，这样，你的借条有效期20年不会超诉讼时效。什么？那你担心对方无限期不还款？没关系，按你们约好的还款日子催一下，不还？不还直接法院见，没关系，法院会认可滴，而且再也不用担心对方突然找不到人过了两年诉讼时效哦。\r\n二、交通事故类\r\n1、事故发生后，务必记得拍一张对方交强险以及商业险的保单，一点都不费神，不然万一双方协商不好，你得到处查询或复印，比较麻烦；\r\n2、如果撞伤了对方，自己需要承担责任，但购买了交强险和商业险，记住，交警让你预付医药费什么的，推说自己最近买股票亏钱了，没有钱，不要垫付，让找保险公司。作为法官，机动车交通事故案子一般会调解，但调解便有利益让步，调解方案出来往往损害的是之前垫付了医药费方车主利益，便宜了保险公司，我很痛心却无能为力。记住，如果购买了保险，对方损失不大，你是除了鉴定费与诉讼法无需多出一分钱的；\r\n3、作为事故受损方，事故发生后走到诉讼阶段，如果伤残严重，不着急用钱，在法院组织调解时，可以不接受保险公司的调解方案，因为，因为，保险公司至少会在有可能判决赔偿的数目上打折10%以上。但如果本来标的不大，还是建议接受调解吧，早点拿钱，少走程序；\r\n4、在事故发生后，保留好一切票据，包括交通费发票、医药费发票、自己在小药店买药等等一切；\r\n5、众所周知，残疾赔偿金农村与城市相差巨大，所以，如果你是农村户口，只要你租住在城镇，或者在城镇务工，均可以按照城镇标准计算，如果务工地在发达地区，只是回老家发生交通事故，还可以按照务工地城镇标准起诉残疾赔偿金，那又是一大比银子。\r\n三、劳动合同类\r\n1、未签劳动合同：实名反对前面有人所说未签劳动合同可以一直要求双倍工资至劳动者离职。我在评论区给他留言指出错误，居然把我留言都删了，太过分！哦 扯远了，绕回来。没有签劳动合同，请保留好工作证，餐票，评先评优等一切证明你工作的证据，双倍工资从你入职第二个月开始计算，直至满一年，即一共赔你11个月双倍工资，超出一年只是视为与你签订无限期劳动合同，其实这个没什么实际效益；\r\n2、每周未休息2天或上班超过40小时，加班工资：周六、日 双倍，法定节假日比如五一十一等，三倍工资，货真价实；\r\n3、单位无故辞退，经济补偿金，工作几年算几月，计算标准为月平均工资，超6个月算1年，未满6个月算半年；\r\n4、未购买社保：你只能在职期间与公司协商要求其缴纳，否则你去劳动部门告发，劳动部门可以对其罚款。真闹到法院，法院对这一块是不予处理的。\r\n四、婚姻法\r\n手机码字好累 我要不要告诉高富帅或白富美在婚姻关系中如何保护自己的财产和荷包，或者告诉高穷帅或白穷美如何获得更多的夫妻共同财产呢 \r\n关于婚姻法的问题 我很纠结要不要更 也许有敏感的知友从前面的陈述中已经发现，我所写部分都是相对而言倾向于教弱势方保护自己的，所以，虽然我只是一介弱女子，但却也怀有侠客情怀，写答案是想教大家如何保护自己的合法权益。但婚姻法方面，每个案子都不一样，没有办法区分到底谁是过错方。我担心被心术不正的人看到以后利用，转而对付在婚姻关系中的善良一方。\r\n容我再仔细想想吧\r\n作者：大姐姐\r\n来源：知乎', ',思想,', '20', '0', '2016-08-19 12:52:28', '2016-08-19 12:52:43', '0', null, '1', 'https://www.zhihu.com/question/27486818?utm_campaign=official_account&utm_source=weibo&utm_medium=zhihu&utm_content=question');
INSERT INTO `tb_post` VALUES ('69', '1', '抛弃mysql模糊查询，使用sphinx做专业索引', '', '', '0', 'Sphinx是一个基于SQL的全文检索引擎，可以结合MySQL,PostgreSQL做全文搜索，提供比数据库本身更专业的搜索功能特别为MySQL也设计了一个存储引擎插件，从此抛弃模糊查询吧。\r\n\r\nSphinx 单一索引最大可包含1亿条记录，在1千万条记录情况下的查询速度为0.x秒（毫秒级）。Sphinx创建100万条记录的索引只要 3、4分钟，创建1000万条记录的索引可以在50分钟内完成，而重建一次只包含最新10万条记录的增量索引只需几十秒。\r\n#### 一、安装\r\n环境：centos6.5\r\n```\r\nyum install sphinx -y\r\n```\r\n默认配置路径 /etc/sphinx/ ，在该路径下，有配置文件sphinx.conf，看看我的配置\r\n```\r\n# 数据源，这里配置的是mysql\r\nsource src1\r\n{\r\n	type			= mysql\r\n\r\n	sql_host		= localhost\r\n	sql_user		= root\r\n	sql_pass		=\r\n	sql_db			= beego_blog\r\n	sql_port		= 3306	# optional, default is 3306\r\n\r\n    # 创建索引时候，从数据库查询数据的SQL\r\n	sql_query		= \\\r\n		SELECT id, userid, UNIX_TIMESTAMP(posttime) AS posttime, title, content, tags \\\r\n		FROM tb_post\r\n\r\n	sql_attr_uint		= userid\r\n	sql_attr_timestamp	= posttime\r\n\r\n	sql_query_info		= SELECT * FROM tb_post WHERE id=$id\r\n}\r\n\r\n# 索引1\r\nindex test1\r\n{\r\n    # 指定数据源\r\n	source			= src1\r\n    # 索引文件路径\r\n	path			= /var/lib/sphinx/test1\r\n    # 储文档信息的方式 extern\r\n	docinfo			= extern\r\n	charset_type	= sbcs\r\n}\r\n\r\n# 索引2\r\nindex testrt\r\n{\r\n	type			= rt\r\n	rt_mem_limit	= 32M\r\n\r\n	path			= /var/lib/sphinx/testrt\r\n	charset_type	= utf-8\r\n\r\n	rt_field		= title\r\n	rt_field		= content\r\n	rt_attr_uint	= userid\r\n}\r\n\r\n\r\nindexer\r\n{\r\n	mem_limit		= 32M\r\n}\r\n\r\n\r\nsearchd\r\n{\r\n    listen          = 0.0.0.0:9312 # 索引对外提供服务的地址\r\n	listen			= 9306:mysql41\r\n	log			    = /var/log/sphinx/searchd.log\r\n	query_log		= /var/log/sphinx/query.log\r\n	read_timeout	= 5\r\n	max_children	= 30\r\n	pid_file		= /var/run/sphinx/searchd.pid\r\n	max_matches		= 1000\r\n	seamless_rotate	= 1\r\n	preopen_indexes	= 1\r\n	unlink_old		= 1\r\n	workers			= threads # for RT to work\r\n	binlog_path		= /var/lib/sphinx\r\n}\r\n\r\n\r\n```\r\n生成索引，这里我们用上文配置的索引名称test1来从mysql获取数据。因此，我们先在myslq中，创建表和数据\r\n```\r\nCREATE TABLE `tb_post` (\r\n  `id` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,\r\n  `userid` mediumint(8) unsigned NOT NULL DEFAULT \'0\' COMMENT \'用户id\',\r\n  `title` varchar(100) NOT NULL DEFAULT \'\' COMMENT \'标题\',\r\n  `content` mediumtext NOT NULL COMMENT \'内容\',\r\n  `tags` varchar(100) NOT NULL DEFAULT \'\' COMMENT \'标签\',\r\n  `posttime` datetime NOT NULL DEFAULT \'0000-00-00 00:00:00\' COMMENT \'发布时间\',\r\n  PRIMARY KEY (`id`)\r\n);\r\nINSERT INTO `tb_post` VALUES (\'1\', \'1\', \'epoll边沿触发漏报消息包问题\', \'开发一个即时通讯后台，底层的网络收发使用 epoll + main loop实现网络事件\', \',技术,\', \'2016-08-05 11:50:02\');\r\nINSERT INTO `tb_post` VALUES (\'2\', \'1\', \'epoll 边沿触发和水平触发区别实战讲解\', \'epoll，看结果发现只接入了两条，还有3条没接入。说明高并发时，会出现客户端连接不上的问题。\', \',技术,\', \'2016-08-05 22:03:23\');\r\nINSERT INTO `tb_post` VALUES (\'3\', \'1\', \'快速排序算法\', \'快速排序算法是一个挺经典的算法，值得我们学习\', \',技术,\', \'2016-08-05 23:08:00\');\r\n```\r\n创建索引\r\n```\r\n[root@centos6 data]# indexer test1\r\nSphinx 2.0.8-id64-release (r3831)\r\nCopyright (c) 2001-2012, Andrew Aksyonoff\r\nCopyright (c) 2008-2012, Sphinx Technologies Inc (http://sphinxsearch.com)\r\n\r\nusing config file \'/etc/sphinx/sphinx.conf\'...\r\nindexing index \'test1\'...\r\ncollected 37 docs, 0.8 MB\r\nsorted 0.1 Mhits, 100.0% done\r\ntotal 37 docs, 833156 bytes\r\ntotal 0.082 sec, 10061176 bytes/sec, 446.81 docs/sec\r\ntotal 3 reads, 0.000 sec, 57.7 kb/call avg, 0.0 msec/call avg\r\ntotal 9 writes, 0.000 sec, 40.2 kb/call avg, 0.0 msec/call avg\r\n```\r\n可以看索引了37条文档，我们可以在命令行测试下效果\r\n```\r\n\r\n[root@centos6 libertyblog]# search epoll|more\r\nSphinx 2.0.8-id64-release (r3831)\r\nCopyright (c) 2001-2012, Andrew Aksyonoff\r\nCopyright (c) 2008-2012, Sphinx Technologies Inc (http://sphinxsearch.com)\r\n\r\nusing config file \'/etc/sphinx/sphinx.conf\'...\r\nindex \'test1\': query \'epoll \': returned 2 matches of 2 total in 0.000 sec\r\n\r\ndisplaying matches:\r\n1. document=59, weight=2831, userid=1, posttime=Fri Aug  5 22:03:23 2016\r\n        id=59\r\n        userid=1\r\n        title=epoll ???????????????\r\n        content=开发一个即时通讯后台，底层的网络收发使用 epoll + main loop实现网络事件\r\n......\r\n```\r\n结果匹配到了两条数据，篇幅有限，就不全列出来了。数据 1. document=59, weight=2831 表示该索引文档编号59，权重2831。以上是命令行操作，如果我们要对外提供服务，还需要启动searchd服务进程\r\n```\r\n[root@centos6 data]# service searchd start\r\n正在启动 searchd：Sphinx 2.0.8-id64-release (r3831)\r\nCopyright (c) 2001-2012, Andrew Aksyonoff\r\nCopyright (c) 2008-2012, Sphinx Technologies Inc (http://sphinxsearch.com)\r\n\r\nusing config file \'/etc/sphinx/sphinx.conf\'...\r\nWARNING: compat_sphinxql_magics=1 is deprecated; please update your application and config\r\nlistening on 127.0.0.1:9312\r\nlistening on all interfaces, port=9306\r\nprecaching index \'test1\'\r\nprecaching index \'testrt\'                                   \r\nprecached 2 indexes in 0.002 sec\r\n                                                           [确定]\r\n```\r\n启动成功，绑定了端口9312，我们查看下状态\r\n```\r\n[root@centos6 data]# searchd --status\r\nSphinx 2.0.8-id64-release (r3831)\r\nCopyright (c) 2001-2012, Andrew Aksyonoff\r\nCopyright (c) 2008-2012, Sphinx Technologies Inc (http://sphinxsearch.com)\r\n\r\nusing config file \'/etc/sphinx/sphinx.conf\'...\r\n\r\nsearchd status\r\n--------------\r\nuptime: 252 \r\nconnections: 1 \r\nmaxed_out: 0 \r\ncommand_search: 0 \r\ncommand_excerpt: 0 \r\ncommand_update: 0 \r\ncommand_keywords: 0 \r\ncommand_persist: 0 \r\ncommand_status: 1 \r\ncommand_flushattrs: 0 \r\nagent_connect: 0 \r\nagent_retry: 0 \r\nqueries: 0 \r\ndist_queries: 0 \r\nquery_wall: 0.000 \r\nquery_cpu: OFF \r\ndist_wall: 0.000 \r\ndist_local: 0.000 \r\ndist_wait: 0.000 \r\nquery_reads: OFF \r\nquery_readkb: OFF \r\nquery_readtime: OFF \r\navg_query_wall: 0.000 \r\navg_query_cpu: OFF \r\navg_dist_wall: 0.000 \r\navg_dist_local: 0.000 \r\navg_dist_wait: 0.000 \r\navg_query_reads: OFF \r\navg_query_readkb: OFF \r\navg_query_readtime: OFF \r\n```\r\n现在我们用一个第三方客户端访问该服务(golang语言开发)\r\n```\r\npackage main\r\n\r\nimport (\r\n    \"github.com/yunge/sphinx\"\r\n    \"log\"\r\n)\r\n\r\nfunc main() {\r\n	SphinxClient := sphinx.NewClient().SetServer(\"localhost\", 0).SetConnectTimeout(5000)\r\n	if err := SphinxClient.Error(); err != nil {\r\n		log.Fatal(err)\r\n		return\r\n	}\r\n\r\n	// 查询，第一个参数是我们要查询的关键字，第二个是索引名称test1，第三个是备注\r\n	res, err := SphinxClient.Query(\"epoll\", \"test1\", \"search article!\")\r\n	if err != nil {\r\n		log.Fatal(err)\r\n		return\r\n	}\r\n	var article_ids string\r\n	for _, match := range res.Matches {\r\n		article_ids += fmt.Sprintf(\"%d,\", match.DocId)\r\n	}\r\n\r\n	log.Println(article_ids)\r\n	SphinxClient.Close()\r\n}\r\n```\r\n打印结果，是 { 1 2 } ，这两个id，没有id为3的，说明索引查找是准确的，因为3里面没有epoll这个单词，而1和2里面都有epoll。至此，我们的测试完成，可以把此功能和自己网站的搜索框对接，以前都是用模糊查询的方式，在数据库中 like \'%\' 某某，这样效率其实很低，数据多的时候要等半天，现在用第三方索引来实现，速度快好几个量级。\r\n\r\n如果有新的数据插入，或者更新数据，是需要做 增量索引 的，很简单\r\n```\r\n[root@centos6 data]# indexer --rotate test1\r\nSphinx 2.0.8-id64-release (r3831)\r\nCopyright (c) 2001-2012, Andrew Aksyonoff\r\nCopyright (c) 2008-2012, Sphinx Technologies Inc (http://sphinxsearch.com)\r\n\r\nusing config file \'/etc/sphinx/sphinx.conf\'...\r\nindexing index \'test1\'...\r\ncollected 37 docs, 0.8 MB\r\nsorted 0.1 Mhits, 100.0% done\r\ntotal 37 docs, 833156 bytes\r\ntotal 0.081 sec, 10184036 bytes/sec, 452.26 docs/sec\r\ntotal 3 reads, 0.000 sec, 57.7 kb/call avg, 0.0 msec/call avg\r\ntotal 9 writes, 0.000 sec, 40.2 kb/call avg, 0.1 msec/call avg\r\nrotating indices: successfully sent SIGHUP to searchd (pid=12074).\r\n```\r\n最好把增量索引的操作放到crontab中，定时做增量，以保持索引最新。以下是每天2点做一次增量索引\r\n```\r\n0 2 * * * indexer --rotate test1\r\n```\r\n\r\n****\r\n> 创建于 2015-08-10 杭州，更新于 2016-08-19 杭州\r\n\r\n>该文章在以下平台同步\r\n- >LIBERALMAN:http://api.liberalman.cn:40000/article/\r\n- >CSDN:http://blog.csdn.net/socho/article/details/52251177\r\n- >简书:\r\n\r\n- [ ]  引用', ',技术,', '26', '0', '2016-08-19 16:04:28', '2016-08-19 16:42:49', '0', null, '0', '');
INSERT INTO `tb_post` VALUES ('70', '1', '摘录 2016-08 期', '', '', '0', '- 人出生在这个世上绝对不会是孤身一人的。\r\n这个世界上没有什么海贼船的设计图，乘上船的船员们挂上骷髅旗就是海贼船，挂上海鸥旗就是海军船。----《海贼王》\r\n\r\n- 中国一向就少有失败的英雄（项羽），少有韧性的反抗（伍子胥），少有单身鏖战的武人（李陵），少有敢抚哭叛徒的吊客（司马迁）；见胜兆则纷纷聚集，见败兆则纷纷逃亡。战具比我们精利的欧美人，战具未必比我们精利的匈奴蒙古满洲人，都如入无人之境。‘土崩瓦解’这四个字，真是形容得有自知之明。---- 鲁迅\r\n\r\n- 专制政府的出现能给国家带来短暂繁荣，于是人民便在这繁荣当中昏昏睡去，一朝醒来，却发现身陷囹圄。与此相反，自由通常于暴风骤雨中诞生，在社会内部各种力量的碰撞和较量当中艰难成长，只有到了自由成熟之时，我们才能认识到它的好处。---- 托克维尔，《论美国的民主》\r\n\r\n- 为什么成人要让孩子尽快地变得和自己一样？我们对自己的世界真的感到那么幸福和满意吗？儿童并不仅仅是一个初级的、不成熟的、准备前往成人世界的平台。……我们在把孩子从他们对自然的理解能力中引开。因为我们也就阻挡了自己理解自然的能力。---- 林达《像自由一样美丽》 （@喷嚏意图）\r\n\r\n- 不用太羡慕运动排行榜步数比你多的好友——他们可能没走多远，他们只是腿短！\r\n\r\n- 有位朋友说的很到位：“赵家否定文革的意思不是说欠你们贱民一个公道，而是说这个体制经不起再来一次胡闹。人家觉得是赵家人自己发晕差点葬送了江山，从来没有觉得害得你们贱民也很惨过。”\r\n\r\n- 人民日报的文章中心思想是：一个不犯错误的党固然伟大光荣正确，而一个犯了错误之后敢于承认错误纠正错误的党，显然更加伟大光荣正确。综上所述，无论犯不犯错误，党永远伟大光荣正确。这逻辑是相当严密的，从根本上排除了党不伟大不光荣不正确的可能性。\r\n\r\n- 有媒体表示：“性是网络第一生产力，无聊是第二生产力，免费是第三生产力。三力结合，基本上可以解释一切网络热点事件。”所以，美女直播，软色情等的出现，自然而然地抢占了“宅男们”的流量。\r\n\r\n- 田朴珺用的言论比王石的”野蛮人“严重多了。她用”流氓“与”坏蛋“来形容宝能，直接把投资者置为”侵略者“与”敌人“。不仅犯了没有文化的错误，还让人觉得幼稚。因为，但凡有点文化的人都知道，在资本市场上没有好人与坏人，只有成功与失败。\r\n\r\n- 医学院老师如此定义医生的作用：‘’我们所有人的归宿都是火葬场，全都在路上排队，医生的作用就是防止有人插队，时不时的把人从队伍里拎出来往后面排排，当然，有的实在拎不动的也只能随他了！有时候把他拎到后面还得挨顿揍！谩骂、侮辱、殴打医生者都是准备插队的！“      ——神一般的定义啊！\r\n\r\n- 20世纪80年代以后的中国，在经济体制改革与开放的拉动下，社会才一点点地从国家体制中解放出来，近三十年来中国所取得的成就，就在于逐步打破了原来的单位体制，使国民能在不同单位、不同地区之间自由流动，从单位人变成社会人。\r\n\r\n- 我们为了体面生活而挣扎，变成了自己曾经厌恶的某种人....可是不挣扎，又怕自己慢了，怕被别人比下去，就这样怅怅惘惘，蹉跎了岁月，也没觉得真正的畅快安然的活过一回。\r\n\r\n- 在美国，不同的州之间是竞争的。如弗里德曼所说，“政府仍不过是一个手段，一个工具。政府既不是一个给我们带来恩惠与礼物的人，也不是使我们盲目崇拜和为之服役的主人或神灵。”一个国家不仅要有市场经济，同样应该有“市场政治”，上述自由抉择的背后，是一套“市场政治”的法则。活跃于政治市场的竞争不仅体现在不同国家之间的移民，同样体现在一国之民可以按照自己的意愿自由迁移。由于没有户籍和单位的禁忌，西方居民可以通过居住地的自由抉择客观上使地方政府陷入关乎治理能力的竞争之中。\r\n\r\n- “对安逸的欲望扼杀了灵魂的激情,而它还在葬礼上咧嘴大笑。” ——纪伯伦《先知》\r\n\r\n- 如果每个人都理解你，你得普通成什么样子\r\n\r\n- 我给你一颗糖，你很高兴， 当你看到我给别人两颗，你就对我有看法了。 但你不知道他也曾给我两颗糖，而你什么都没给过我。\r\n\r\n- @邓相超：我们的国家，从幼儿园到小学、大学、再到研究生，一直都强调死记硬背为考试，强调看得见摸得着的硬技能，特别是科学和工程几乎为我们每个中国家长、每个老师认同，这些教育手段、教育内容使中国差不多也只能从事制造业。\r\n\r\n- 民粹主义和国家主义是最大的愚昧 ---- 资中筠\r\n走向文明，走向世界，有两个最大的阻力。一个是极端民族主义，我称它国家主义，国族主义。还有一个是民粹主义。现实中存在一种走向法西斯的力量，而且相当不弱。我不知道强到什么程度，可是相当普遍。最容易激发起来的就是民族主义，一说有敌对势力，马上有一大批人反应起来。比如一个卖菜的小贩，天天骂政府损害他的利益，可是一阅兵，一说小日本，架式马上就起来了。这就是民粹主义、民族主义的思想，是走向文明的一个绝大阻碍。出路在哪呢？就是启蒙，enlightment，这就是光，让智慧之光驱散愚昧。目前，愚昧最主要地是指民粹主义和国家主义，它们跟世界潮流格格不入。大概我的目光不够远大，以我所能预见到的，还是很难乐观起来。\r\n\r\n- 人生最悲凉的是明知道在空耗生命，但还是要自觉自愿地听之任之！\r\n\r\n- 凡是你抗拒的，都会持续。因为当你抗拒某事或某情绪时，你会聚焦在那事件或情绪上，这样就赋予了它更多的能量,它就变得更强大了。唯一可做的是，就是带进光来。光出现了，黑暗就消融了。\r\n\r\n- 常与同好争天下，不共傻瓜论短长！\r\n\r\n- 世界上并不是每个人和你一样成长在阳光下\r\n\r\n- 总有一些圣母，在我的评论里主张宽容无良之人，主张我该好好反思，主张错误在我，对我做有罪推定，对别人做责任推脱。以圣人的标准要求别人，以贱人的标准要求自己，在我看来，这样的人，其实就是王八蛋。\r\n\r\n- 在压抑之下，激烈的反抗是一种结果，还有一种结果就是默默的逆反。\r\n\r\n- 鲁迅早就说过：“中国人，轻家国而重乡土，勇于私斗，怯于公战”\r\n\r\n- 人的一切痛苦，本质上都是对自己的无能的愤怒。——王小波\r\n\r\n- 任何职业令人喜欢的程度取决于从业者驾驭局面的程度；任何职业令人不快的程度取决于从业者服从规则的程度。 ——阿兰《幸福散论》\r\n\r\n- 只要你谈论一下社会现象，尤其是负面的社会现象，就有人说：你说这个有什么用？你得拿出解决问题的办法。对此，我只想说，你每天看天气预报也会提出这样的要求吗？会要求气象台拿出解决天冷天热刮风下雨的办法吗？\r\n\r\n- 钱钟书任教清华大学时，因林徽因家的猫经常欺负自家的猫，钱钟书就用竹竿“帮架”。杨绛担心丈夫为猫而得罪人，便引用他自己的话劝他：“打狗要看主人面，那么，打猫要看主妇面了！” 那只猫可是林徽因的猫，不要伤了两家的和气。可钱钟书顾不了什么，照打不误，还说：“理论总是不实践的人制定的。”', ',思想,', '32', '0', '2016-08-23 14:30:21', '2016-09-10 14:49:04', '0', '', '0', '');
INSERT INTO `tb_post` VALUES ('71', '1', '通过UDF使mysql主动刷新redis缓存', '', '', '0', 'UDF是mysql的一个拓展接口，UDF（Userdefined function）用户自定义函数。在什么地方使用这个功能呢，试想有如下场景：\r\n\r\n你的网站使用mysql作为最终数据落地的存储引擎，而redis作为缓存以减小查询请求穿透到mysql的数量，可以极大的降低数据库性能瓶颈带来的整个网站对外服务的卡顿、不可用等情况。这种方式的架构，当有查询请求的时候，我们可以在业务逻辑层控制，先从缓存中查询，无命中的情况下，再到数据库中查询，同时缓存到redis中；当有修改请求的时候，我们可以先修改数据库，然后删除或更新缓存。\r\n\r\n以上方式是我们业务量不大，开发简单的，少横向扩展的情况下做的。当开发复杂度随着业务量并发增大，呈现横向扩展和垂直方向上螺旋迭代上升趋势的时候，逻辑复杂度直线上升。还采用在业务逻辑层做缓存控制将变得很复杂，运维上也容易出错。\r\n\r\n这个时候，如果能将缓存逻辑和业务逻辑分离，缓存层对业务逻辑提供服务透明，业务逻辑不用关心缓存逻辑，缓存逻辑也不用随业务变化而改动，互相做自己的事情，这样高内聚低耦合可以极大的增加扩展性和健壮性，也是我们做架构应该努力发展的方向。\r\n\r\n那么具体来说，我的这里要做的事情，其实就是把缓存更新的逻辑，放到mysql中去做。写一个trigger触发器监控insert/update/delete这些修改数据的操作，当有修改操作的时候，调用对应的自定义UDF函数来远程回写redis缓存，而我们在业务逻辑层则只管更新数据就行了，缓存更新的操作都放给以上的缓存层逻辑来完成。\r\n\r\n当然，以上操作也可以反方向来，先写redis，然后由redis同步到mysql去。两种方式各有利弊，看你的具体场景如何选择了，这里不讨论。我们此处的目的是使用mysql的udf函数更新数据到redis中。\r\n\r\n##### 开发环境\r\n操作系统:centos 6.4 server，内核2.6.32-358.18.1.el6.x86_64\r\n\r\n编译器：gcc 4.4.7\r\n\r\n数据库：mysql server 5.1.73\r\n\r\nmysql服务器之前已经安装了，现在我们要安装mysql开发包\r\n\r\nyum install mysql-devel -y\r\n\r\n#### 一、UDF函数入门\r\n首先学习下UDF函数的使用方法。我们自定义一个函数文件，test_add.cpp如下\r\n\r\n```\r\n#include <mysql.h>\r\n\r\nextern \"C\" long long testadd(UDF_INIT *initid, UDF_ARGS *args, char *is_null, char *error)\r\n{\r\n    int a = *((long long *)args->args[0]);\r\n    int b = *((long long *)args->args[1]);\r\n    return a + b;\r\n}\r\n\r\nextern \"C\" my_bool testadd_init(UDF_INIT *initid, UDF_ARGS *args, char *message)\r\n{\r\n    return 0;\r\n}\r\n```\r\n这是c++代码，编译\r\n```\r\n[root@centos6 ~]# g++ -shared -fPIC -I /usr/include/mysql -o test_add.so test_add.cpp\r\n```\r\n拷贝到mysql插件目录下，要以root身份\r\n```\r\n[root@centos6 ~]# cp test_add.so /usr/lib64/mysql/plugin/\r\n```\r\n如果你不知道插件的路径，执行\r\n```\r\nmysql> show variables like \'%plugin%\';\r\n+---------------+-------------------------+\r\n| Variable_name | Value                   |\r\n+---------------+-------------------------+\r\n| plugin_dir    | /usr/lib64/mysql/plugin |\r\n+---------------+-------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n登录mysql，创建函数关联\r\n```\r\nmysql> create function testadd returns integer soname \'test_add.so\';\r\nQuery OK, 0 rows affected (0.00 sec)\r\n```\r\n至此，UDF就搞定了，接下来测试\r\n```\r\nmysql> select testadd(1,2);\r\n+--------------+\r\n| testadd(1,2) |\r\n+--------------+\r\n|            3 |\r\n+--------------+\r\n1 row in set (0.00 sec)\r\n```\r\n可以看到testadd函数生效了，输出结果为 1 + 2 = 3.\r\n\r\n如果要删除UDF函数\r\n```\r\nmysql> drop function testadd;\r\nQuery OK, 0 rows affected (0.01 sec)\r\n```\r\n然后删除插件目录下的.so文件\r\n```\r\n[root@centos6 ~]# rm -f /usr/lib64/mysql/plugin/test_add.so\r\n```\r\n#### 二、结合redis做缓存更新\r\n##### 1.在DUF中访问redis\r\n更新redis的原理其实和上面示例一样的，只是要在UDF中调用redis的api函数。在此之前，请先下载api源码\r\ngit clone https://github.com/mrpi/redis-cplusplus-client\r\n这是redis官网给出的c++访问redis的客户端api代码，依赖于boost，先安装\r\n```\r\n[root@centos6 ~]# yum install boost boost-devel\r\n```\r\n然后\r\n```\r\n[root@centos6 ~]# cd redis-cplusplus-client\r\n```\r\n当要调用该库的时候，把如下几个文件拷贝过去一起编译就可以了\r\nredisclient.h、anet.h、fmacros.h、anet.c。接下来看我的源码test.cpp\r\n```\r\n#include <stdio.h>\r\n#include <mysql.h>\r\n#include \"redisclient.h\"\r\nusing namespace boost;\r\nusing namespace std;\r\n\r\nstatic redis::client *_client = NULL;\r\n\r\n// 初始化连接\r\nvoid check_connection()\r\n{\r\n    if(NULL == _client){\r\n        const char* c_host = getenv(\"REDIS_HOST\"); // 获取操作系统变量\r\n        string host = \"localhost\";\r\n        if(c_host)\r\n            host = c_host;\r\n        _client = new redis::client(host);\r\n    }\r\n}\r\n\r\n// 调用redis的hset命令\r\nextern \"C\" char *redis_hset(UDF_INIT *initid, UDF_ARGS *args, char *result, unsigned long *length, char *is_null, char *error)\r\n{\r\n    try{\r\n        check_connection();\r\n        if(!(args->args && args->args[0] && args->args[1] && args->args[2])){\r\n            *is_null = 1;\r\n            *length = 8;\r\n            snprintf(result, 8, \"is null\");\r\n            return result;\r\n        }\r\n        if(_client->hset(args->args[0], args->args[1], args->args[2])){\r\n            *length = 2;\r\n            snprintf(result, 2, \"0\");\r\n            return result;\r\n        } else {\r\n            *error = 1;\r\n            *length = 5;\r\n            snprintf(result, 6, \"error\");\r\n            return result;\r\n        }\r\n    } catch (const redis::redis_error & e){\r\n        *length = ((std::string)e).length() + 1;\r\n        snprintf(result, *length, \"%s\", (char*)e.what());\r\n        return result;\r\n    }\r\n}\r\n\r\n/*资源分配*/\r\nextern \"C\" my_bool redis_hset_init(UDF_INIT *initid, UDF_ARGS *args, char *message)\r\n{\r\n    if (3 != args->arg_count  || args->arg_type[0] != STRING_RESULT  || args->arg_type[1] != STRING_RESULT  || args->arg_type[2] != STRING_RESULT){ // hset(key, field, value) 需要三个参数\r\n        strncpy(message, \"please input 3 args and must be string, such as: hset(\'key\', \'feild\', \'value\');\", MYSQL_ERRMSG_SIZE);\r\n        return -1;\r\n    }\r\n    args->arg_type[0] = STRING_RESULT;\r\n    args->arg_type[1] = STRING_RESULT;\r\n    args->arg_type[2] = STRING_RESULT;\r\n\r\n    initid->ptr       = NULL;\r\n    return 0;\r\n}\r\n\r\n/*\r\n// 测试\r\nint main(){\r\n    char is_null;\r\n    char message[128] = {0};\r\n    char result[128] = {0};\r\n    unsigned long length = 0;\r\n    UDF_ARGS args;\r\n    UDF_INIT initid;\r\n    args.arg_count = 3;\r\n    args.args = new char*[3];\r\n    args.args[0] = new char[16];\r\n    args.args[1] = new char[16];\r\n    args.args[2] = new char[16];\r\n    args.arg_type = new Item_result[3];\r\n    strcpy(args.args[0], \"mykey\");\r\n    strcpy(args.args[1], \"myfeild\");\r\n    strcpy(args.args[2], \"myvalue\");\r\n    redis_hset_init(&initid, &args, message);\r\n    redis_hset(&initid, &args, result, &length, &is_null, message);\r\n    printf(\"%s\\n\", result);\r\n    if(args.arg_type)\r\n        delete args.arg_type;\r\n    if(args.args)\r\n        delete args.args;\r\n    return 0;\r\n}\r\n*/\r\n```\r\n请提前启动redis服务器，我是在本机启动的，所以地址就是localhost，端口不写默认就是6379。编译和拷贝\r\n```\r\n[root@centos6 ~]# g++ -shared -fPIC -I /usr/include/mysql -lboost_serialization -o myredis.so anet.c test.cpp\r\n[root@centos6 ~]# rm -f /usr/lib64/mysql/plugin/myredis.so && cp myredis.so /usr/lib64/mysql/plugin/ && chmod 777 /usr/lib64/mysql/plugin/myredis.so\r\n```\r\n登录mysql客户端，执行\r\n```\r\nmysql> DROP FUNCTION IF EXISTS `redis_hset`; create function redis_hset returns string soname \'myredis.so\';\r\nQuery OK, 0 rows affected (0.01 sec)\r\n\r\nQuery OK, 0 rows affected (0.00 sec)\r\n\r\nmysql> select * from mysql.func;\r\n+------------+-----+------------+----------+\r\n| name       | ret | dl         | type     |\r\n+------------+-----+------------+----------+\r\n| redis_hset |   0 | myredis.so | function |\r\n+------------+-----+------------+----------+\r\n```\r\n安装完成，现在测试。在mysql中执行\r\n```\r\nmysql> select redis_hset(\'Jack\', \'id\', \'101\');\r\n+---------------------------------+\r\n| redis_hset(\'User\', \'id\', \'101\') |\r\n+---------------------------------+\r\n| 0                               |\r\n+---------------------------------+\r\n```\r\n返回字符\"0\"，说明调用成功。到redis上看看结果\r\n```\r\n127.0.0.1:6379> hgetall User\r\n1) \"id\"\r\n2) \"101\"\r\n```\r\n数据正确，mysql的DUF和redis通信成功，并且正确的修改数据。\r\n##### 2.用触发器实现动态更新redis缓存\r\n这一步的思路，就是在mysql中创建一个触发器，监听表的insert/update/delete等操作，有数据更新的时候调用上一步的UDF函数刷新信息到redis缓存中去。\r\n\r\n先准备数据库表和触发器\r\n```\r\nCREATE TABLE `tb_user` (\r\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\r\n  `username` varchar(255) CHARACTER SET utf8mb4 DEFAULT NULL,\r\n  PRIMARY KEY (`id`)\r\n);\r\n```\r\n触发器\r\n```\r\ndelimiter $\r\ncreate trigger tg_user\r\nafter insert on tb_user\r\nfor each row \r\nbegin\r\n    set @id = (select redis_hset(CONCAT(\'user_\', new.id), \'id\', CAST(new.id AS CHAR)));\r\n    set @username = (select redis_hset(CONCAT(\'user_\', new.id), \'username\', new.username));\r\nend $\r\n```\r\n这里触发器监控的是insert，当插入新数据的时候，会把用户id和用户名刷新到redis缓存中去。也可以针对update和delete做触发，篇幅有限，就不列出来了。\r\n\r\n测试\r\n```\r\nmysql> insert into test.tb_user(`username`) values(\'Jack\');\r\nQuery OK, 1 row affected (0.01 sec)\r\n\r\nmysql> insert into test.tb_user(`username`) values(\'Lucy\');\r\nQuery OK, 1 row affected (0.01 sec)\r\n```\r\n插入了两条数据，查看redis的反应\r\n```\r\n127.0.0.1:6379> keys user_*\r\n1) \"user_1\"\r\n2) \"user_2\"\r\n\r\n127.0.0.1:6379> hgetall user_1\r\n1) \"id\"\r\n2) \"1\"\r\n3) \"username\"\r\n4) \"Jack\"\r\n\r\n127.0.0.1:6379> hgetall user_2\r\n1) \"id\"\r\n2) \"2\"\r\n3) \"username\"\r\n4) \"Lucy\"\r\n```\r\n可以看到user_1和user_2两条key都插入了，每条key的内容也和我们在mysql中插入的一致。至此，我们的目的，“数据库更新，自动刷新到缓存”就实现了，妥妥的！\r\n#### 总结\r\n以上的思路我已经讲的很清楚了，我只写了一个简单的示例，使用的是redis的hset命令。这里我们找一个现成的同步mysql到redis的工具，很全面。从 http://pan.baidu.com/s/1qW9DHYc 下载mysql_udf_redis.tar.bz2，基本满足常用的redis操作命令。\r\n\r\n****\r\n> 创建于 2016-08-23 杭州，更新于 2016-08-23 杭州\r\n\r\n>该文章在以下平台同步\r\n>- LIBERALMAN:http://api.liberalman.cn:40000/article/71\r\n>- CSDN:http://blog.csdn.net/socho/article/details/52292064\r\n>- 简书:http://www.jianshu.com/p/4381a38403a1\r\n\r\n- [1]  引用 http://blog.csdn.net/luoqiya/article/details/12888553', ',技术,', '64', '0', '2016-08-23 16:15:58', '2016-08-23 16:29:42', '0', null, '0', '');
INSERT INTO `tb_post` VALUES ('72', '1', '喜欢励志心灵鸡汤文？或是智力偏低表现', '', '', '0', '　　据国外媒体报道，我们都认识一些这样的人，他们经常在社交媒体上发一些看似深刻，实际上却毫无意义的心灵鸡汤或者名人名言。现在，对那些看不懂这些励志文字的人来说，终于有了为自己辩护的依据。\r\n\r\n　　据英国《每日邮报》报道，加拿大滑铁卢大学的一项新研究发现，那些经常在社交媒体上发布励志鸡汤文的人通常表现出较低的智力及认知能力。心理学者还发现，这些人更容易相信超自然现象和阴谋论，宗教信仰也更加坚定。\r\n\r\n　　在实验中，研究者以“灵性导师”狄巴克·乔布拉（Deepak Chopra）发表于推特上的语句为主要材料，询问参与者对这些语句的评价，包括内容是否深刻，以及是否同意其观点等。研究一共包括4个实验，有845位志愿者参加。\r\n\r\n　　在狄巴克·乔布拉的语句中，研究者还故意加入一些时髦的词语，组成毫无意义，但也可能被认为很深刻的通俗语句，如“大多数人都喜欢某种音乐”。接下来，研究者让参与者进行了一系列认知测试，其中一部分是关于是否认同某些宗教、超自然现象和阴谋论观点。\r\n\r\n　　在发表于《判断与决策》（Judgment and Decision Making）期刊的文章中，滑铁卢大学的认知心理学家戈登·彭尼库克指出，有些人更容易接受一些“伪深刻”的空虚言论，而有些人则能察觉到这些言论的问题所在，他们并不是不加区别地怀疑，而是对不明确和暧昧语句具有洞察能力。\r\n\r\n　　从测试结果可以看出，那些容易接受“伪深刻”言论的人，往往反应能力和认知能力较差，更容易出现本体论的混淆和阴谋论思维，更加坚信宗教和超自然现象，并且更加沉迷于补充和替代医学。\r\n\r\n　　研究者特别提及了狄巴克·乔布拉的言论，此人过往曾因为制造“呜呜响的废话”而遭受批评。他的话甚至还被好几个网站拿来恶搞，他们从他的推特发言中提取词汇，随机生成了许多类似风格的“名言”。（任天）\r\n  ', ',思想,', '30', '0', '2016-08-23 22:09:24', '2016-08-25 13:24:27', '0', null, '1', 'http://tech.sina.com.cn/d/v/2015-12-08/doc-ifxmhqac0191828.shtml');
INSERT INTO `tb_post` VALUES ('73', '1', '汶川地震后，范美忠的这七年', '', '', '0', '![裸奔者范美忠](http://photocdn.sohu.com/20150514/mp14909357_1431556724231_2.jpeg)\r\n\r\n###### 裸奔者范美忠\r\n###### 文|《智族GQ》记者何瑫 黄周颖\r\n　　2008年5月12日的汶川大地震，36岁的中学教师范美忠从距离震中15公里的教室中抛下学生夺命而出，却又亲手把自己送进了一场震动全国的舆论风暴。在震后10天的一篇文章中，他说自己不是先人后己勇于牺牲自我的人，哪怕母亲也不会管， \"因为成年人我抱不动，间不容发之际逃出一个是一个。\"\r\n　　铺天盖地的谩骂声接踵而至，集合了懦弱、无耻、缺乏责任心等评判的 \"范跑跑\"一词广为流传，成为他此生难以揭除的标签。\r\n　　然而，这一夹杂着愤怒情绪的刺耳代号，却远不足以呈现出这个千夫所指者的真实面目。在熟悉的人眼中，他是一个令旁人生羡却不敢效仿的精神裸奔者，逃离毫无归属感的故乡，考入最高学府，却又对之满心失望，在此后的漫长岁月里四处游荡。孤独、绝望、愤怒、狂傲、虚无、分裂成为他的人生基调，他的身上，交织着中国社会文化的种种冲突悖论。\r\n　　现实中存在一类世俗意义上的成功者，他们身段灵活柔软，在现实夹缝中游走自如，为实现胸中理想常做出适度妥协。范美忠对之心生佩服，却从不愿效仿。幼年时，他日复一日用拳头击打自家墙壁，这一场景恰是他个人，乃至以他为代表的一类人命运轨迹的映射——个人欲求与坚硬现实持续冲撞，纵然疼痛，也不停歇。\r\n　　震灾过后，那篇有意挑衅大众伦常认知的文章将他与外部世界的格格不入推向顶点。道德审判的狂欢之后，看客纷纷离场，他本人的精神余震却一直持续，至今已是7年。他将自己多年的精神困局形容为一个蛋壳，自己努力挣脱而不得， \"范跑跑\"事件却像是一把锤子，从外部将蛋壳狠狠击破。\r\n　　锤子力道凶猛，砸碎了蛋壳，也砸伤了他自己。汶川地震7年之后，《智族GQ》记者贴身采访范美忠，探寻其漫长艰险的精神重建历程。在此过程中，他抛弃了曾经的精神教父鲁迅，尝试皈依基督教却以失败告终，随后投向了曾经怀疑拒斥的中国传统文化，成为庄子的信徒。从鲁迅到庄子，这一精神源头的颠覆是否如其本人所言业已实现，目前做出判断还为时过早，但其变化过程却摆出一道横亘在旁观者面前的命题：置身于纷繁复杂遍布困扰的世事之中，每一个向往精神自由的个体，究竟该以何种方式面对自己的内心。\r\n#### 布道\r\n　　往返于成渝两地间的火车每天从四川省隆昌县金鹅镇瓜子岩村旁驶过，隆隆的汽笛声让村民们烦躁不安，却又是他们的精神寄托之一：对于这个偏居川南的破旧村落而言，铁路负载着数辈人对繁华富裕的想象，以及改变命运的可能。但村中第一个考入北京大学的孩子在成年之前，却从未获得机会借此打探外面的世界。1980年代中期，这个戴着1000度近视眼镜的瘦弱男孩，为自己制订的首要任务不是应对初中课业，而是日复一日用拳头疯狂击打自家泥土砌成的墙壁。三年过后，他的心愿达成，练出一身紧实肌肉，足以对抗父亲及四个兄长的殴打辱骂。\r\n　　\"青春期那种对父亲的彻底反叛，是我特别成功的一点。后来那么多人骂我，却完全击不垮我，为什么？因为这种经历让我十几岁就完成了人格的独立。\"如今，43岁的中学教师范美忠回忆起儿时与父亲的冲突，将其视为个人性格的源起。家庭气氛的暴戾贫苦令他心生绝望，北大历史系录取通知书的到来被村民们视作光宗耀祖，在他眼中，却获取了一种逃离压制的解脱感。\r\n　　自1992年离开隆昌，二十多年间几经辗转，范美忠如今的落脚地，离故乡不过二百公里。2015年2月的一个清晨，我在成都文殊坊的一家茶馆里见到他。他被围坐在来自全国各地的年轻人中间，与他们进行有关文学、历史、哲学的无主题自由讨论。这是为期一周的公益课程的其中一天，八个小时的讨论，他的回报是三四百元的象征性酬劳。\r\n　　村邻眼中，没有比考入北大这样的学校更加美妙的改变命运的机遇。然而，1997年毕业至今，范美忠从未像这所中国最高学府的大多数毕业生那样，获取超过平均水准的社会地位和物质财富。但他却毫不在意，甚至从未对此产生兴趣。\r\n　　牛仔裤松松垮垮，裤脚早已磨破。黑色羽绒服的下沿露出来了白衬衣的一角，另一角却藏在里面。十几个人中，范美忠是穿着最随意的一个。为了保证秩序，讨论引入了罗伯特议事法则：每人有两分钟时间提问，范美忠则有五分钟时间回答，一旦到时，必须停止，除非下一个人放弃提问。多次超时后，范美忠表达了反对。 \"这套规则是非常好的，但是用于开会，我们是讨论问题，并不完全适用。\"\r\n![裸奔者范美忠](http://photocdn.sohu.com/20150514/mp14909357_1431556724231_3.jpeg)\r\n　　主持人表示，既已如此规定，就要执行下去。他再无异议，却加快了语速，陌生的人名和术语越来越密集地出现。他飞快地转动手中的纸杯，杯口已被捏扁。一脸茫然的面孔越来越多，但不在他的视线范围之内——他的眼神始终投往一个固定的方向，前方并不是某个提问者，而是人群外的一块地板。\r\n　　他非常享受这种言说的快感，至于听众能否接受，不是他关心的问题。范美忠十多年的好友、北京十一学校特级历史教师魏勇这样描述他的讲课风格： \"用叶芝、昆德拉、海德格尔、李泽厚作为下河前的准备活动，安东尼奥尼、伯格曼、基耶斯洛夫斯基也不过是一点儿小风小浪，真正的风浪是突然一下到了诸子百家，一个豪华转身、一个古典巨浪。于是，许多没见过风浪的学生被他打晕。\"\r\n　　正如范美忠曾在不同场合反复表达的那样，他在我面前多次评价自己为 \"中国最好的文科老师\"。中午12点，讨论结束，我们走在去饭馆的路上，聊起了曾被他视为精神教父的鲁迅。 \"北大钱理群对鲁迅的研究根本比不上我。我花了五年做到了中国鲁迅研究第一人。\"\r\n　　然而，即使是他看来最理解他的朋友，也对他的这番自我判断持有保留意见。成都同辉国际学校校长李勇对我说，范美忠更像是一个不由分说的布道家，需要的只是一群听众： \"美忠不是通常意义上的好老师。他更多考虑的是把我想说的尽可能说出去。可是好的老师要照顾受众的心理，他想听什么，他能听懂什么，他需要听什么？美忠是不考虑的。\"\r\n　　类似的评价，范美忠心知肚明，却不为所动。每接一届学生，他首先要做的是 \"在学生目瞪口呆之时对他们进行知识轰炸\"。他也从不掩饰对大部分老师在智力和道德两方面的优越感。他曾在《中国青年报·冰点周刊》公开撰文： \"我对那些要我注意教学方法的劝告不屑一顾：你们这些老师懂什么？连《史记》都没看过也跟我谈历史！你们那点儿可怜的知识和僵化的头脑再有教学方法也没用！\"\r\n　　在他的眼中，大部分老师是充当应试教育的帮凶，向学生们传递无用甚至有害的伪知识。为与他们划清界限，这个自视 \"中国最好的文科老师\"的人，至今没有教师资格证。 \"参加这种考试是对我的一种侮辱。\"\r\n　　这自然令他付出代价。学生抗议、家长举报、校长停课、然后离开，如此周而复始， \"大半个中国倒腾了一圈\"。最短的一次在广州华美外国语学校，仅21天。但回忆起这段经历时，他并不认为自己是他所痛恨的应试教育制度的受害者： \"各种人的反应都在我的预料范围内。每一次离开，主动权都在我自己手上。\"\r\n　　然而，当这种行事风格在特殊的历史节点出现在课堂外的公共空间时，受众的反应却完全超出了他的想象。这令他遭遇了前所未有的猛烈攻击，也让这个自视极高却寂寂无名的中学老师在一夜之间世人皆知。\r\n　　2008年5月12日，四川汶川发生8级地震，范美忠在剧烈震荡中，第一个跑出都江堰市光亚中学教室。10天之后，他在天涯论坛贴出《那一刻地动山摇—— \"5·12\"汶川地震亲历记》： \"我是追求自由和公正的人，却不是先人后己勇于牺牲自我的人！在这种生死抉择的瞬间，只有为了女儿才可能考虑牺牲自我，其他人，哪怕是我母亲，在这种情况下我也不会管。因为成年人我抱不动，间不容发之际逃出一个是一个。\"\r\n　　这番言论迅即引起了无数批评与谩骂。次日，网络写手五岳散人撰文提出 \"范跑跑\"一词，这成为了范美忠此生难以揭除的标签。\r\n　　时任教育部发言人说：我们可以不崇高，但是不能允许无耻。北大历史系党委书记说：北大以有这样的学生为耻，如果开除他，我们很赞成。类似的批评，当时无法计数。 \"如果发生在十几年前，我可能会去自杀。但当时我一丝这种想法都没有。中国十三亿人，哪怕十二亿九千万人说我是错的，只要我认为自己是对的，我就是对的。\"回忆起旧事，他的神情有些不耐烦—— \"我绝不后悔\"、 \"如果事情重来一次，我还会那样做\"，过去7年间，这样的语句他已经重复了无数次。\r\n　　在他眼中，童年一次次用拳头击打墙壁，恰是他此后人生轨迹的映射——个人欲求与坚硬现实持续冲撞，纵然疼痛，也不停歇。正因如此，他人为名利打拼之时，他四处漂泊，寻觅理想的归宿；而当要求开除他甚至杀他全家的大字报贴上光亚学校的大门，他却选择留下，一待就是7年。\r\n　　在他研究鲁迅的一本著作《民间野草》中，他引用里尔克的诗句： \"离开村子的人将长久漂泊，也许，还有许多人会死在途中。\"而算上汶川地震之前的3年，他在光亚学校任教已近10年。他为数不多的朋友们一度觉得，他或许已经不再漂泊，找到了归宿。但他本人的答案是否定的——在我见到他的一周前，光亚学校正式批准了他的辞呈。\r\n　　离开成都后，我飞往三亚，采访在此休假的光亚学校校长卿光亚。谈及范美忠辞职一事，这个1949年后内地第一家私立学校的创始人说： \"地震的事对他刺激非常深，我觉得他现在还是一个病人。他辞职的时候情绪是失控的，根本没有计划。\"\r\n　　范美忠本人的说法与此大相径庭。他评价自己如今 \"达到了前所未有的平和\"、 \"生命走到了一个新的阶段，在极度的黑暗中找到了出路\"。他认为自己摆脱了曾经的精神教父设下的牢笼： \"鲁迅无法解决你的问题，基本让你走向绝望。\"\r\n　　那新的精神资源是什么？一天午饭过后，他提议去一个附近的茶馆喝茶。在一个十字路口等绿灯时，我向他提起了里尔克的那句诗。 \"那你觉得自己依然还在漂泊吗？还是说像他说的那样，已经死在途中？\"\r\n　　他毫不犹豫地回答： \"如果没有转向庄子，我早死了。庄子让我起死回生。\"绿灯亮起，我们快步穿了过去。\r\n#### 漂泊\r\n　　成德高速上车流稀疏，远方弥漫着四川盆地常见的雾气。范美忠的妻子吴文冰坐在后排，不时提醒丈夫开慢一点儿，注意安全。\r\n　　吴文冰之所以坐在后排，是因为她肚里怀着孩子，需要宽敞的空间。按照预产期，他们的第二个孩子还有不到半个月就将降生。因为担心成都的医院过于拥挤，他们驱车前往德阳做最后的产前检查。\r\n　　产检结束后，我们去医院附近的餐馆吃饭。刚一落座，范美忠问服务员： \"青菜有哪几种？\"对方一一列举，他摇了摇头，带着我们离开。他向我解释说： \"文冰爱吃的那种菜这里没有，我们换一家看看。\"妻子怀孕后，他包揽了买菜做饭的任务。 \"她做饭其实不好吃，所以我宁可多做一点儿。\"看到我有些惊讶，他特意补充道。\r\n　　这是范美忠难得一见的，让人嗅到烟火气的时刻。见到他之前，我和大多数人一样，对他的印象就是一个不食人间烟火的斗士，永远在与人争辩宏大命题，柴米油盐这种东西似乎与他无关。\r\n　　这并不符合范美忠对自己的判断。 \"婚姻拯救了我，让我变得柔软。我原来是一个缺乏爱、缺乏归属的人。一个人长期这样，心理是会变形的。买菜、做饭、带孩子，这些形而下的东西迫使我低下头来关注现实世界，这样的生命才可能是通透的。\"\r\n　　他的朋友李勇则张开双臂，用手势向我演示他眼中范美忠的变化： \"在他的生活里，一头是物性，一头是诗性，前者是世俗生活，后者是精神追求，结婚前他无限地靠近后者，但这是非常危险的。妻子的出现，把他往另外一头拽了一点儿。\"\r\n　　幼年时的穷困常令人成年后被追逐财富的欲望所绑架，范美忠却恰恰相反。作为家中六个孩子中最小的一个，儿时与四兄一姐抢食的经历令他对物质的欲求产生厌恶。初二时，有三个月家里没有油，盐巴在口腔留下的咸涩久久挥之不去，这让如今的他对街头的 \"苍蝇馆子\"赞不绝口。与贫苦相比，他眼中对自己未来性格影响更为深重的，乃是爱的缺失。\r\n　　曾经读过四年私塾的范父是村里少有的读书人，还会杀猪、编箩筐、在村里的红白喜事上担任大厨，这使他具备超出村邻的挣钱能力。但自范美忠形成记忆以来，范父对赌博的兴趣盖过了一切。他总习惯性地将杀猪刀磨得锃亮，却只磨不用。早上醒来，范美忠总会看到一把利刃挂在墙上，这令他心生恐惧。\r\n　　勤劳隐忍的范母挑起养家重任，农活最忙时，她夜里两点入睡，4点起床，以至于多年之后，七十多岁的她与九十多岁的母亲坐在一起时，比母亲显得更加苍老。 \"父母的爱是任何东西无法代替的，但我感受不到。母亲不是不爱你，但她必须出去劳动。父亲呢？他一早就去赌钱，天黑才回来，男人对家庭的责任感，你是完全看不到的。\"范美忠说。\r\n　　每年寒暑假，范美忠有两个多月时间可以回到隆昌。但最近几年，他在家乡的时间越来越短。还有一个星期就是春节，他只打算回去两天，初二就离开。 \"在成都其实也很无聊，但是回到那里更难受。那是母亲的家，是你哥的家，不是你的家。你会发现他们面孔很熟悉，但交谈起来非常陌生，无法交流。那种时候你感觉极其孤独，坐立不安。\"\r\n　　这使他在成年后的漫长时间里，成为一个找不到归宿的异乡人。 \"无论走到哪里，我都只是一个过客。\"《过客》是鲁迅《野草》中的一篇，主人公是一个不停向远方行走的老人，他不知道自己的名字， \"从我还能记得的时候，我就是一个人。\"范美忠在文中找到了自己的影子，在一篇对《过客》的解读文章里，他写道： \"行走本身即已成为目的，停止即意味着死亡。\"\r\n　　四处漂泊时，他曾有一年未和家人联系过。有一天，他突然接到家乡的电话，才知道父母曾经以为他已经自杀了。原因是搜到他很久之前发在网上的一篇文章：《自杀离我有多远》。\r\n　　他戏称自己有 \"处女书情结\"，同一本书会反复买好几次，原因是 \"不想让上一次做的批注框束新的思考\"。而这件事的另一面则是，每去一个新学校，他会把大多数书送给同事，只随身携带少量原典。到光亚学校前，他从未买过书柜，一大堆书就随意散落在房间里。 \"因为我每次搬家都清楚，这就是一个临时的落脚地，睡觉的地方，不是家。买书柜怎么处理？难道背着到处走？\"\r\n　　即使已经在光亚执教了10年，这种漂泊感依旧困扰着他。 \"我内心有非常痛苦的一对矛盾。一方面你渴望漂泊，因为你工作过的每一个地方，都让你失望，然后你就总会觉得有一个遥远的地方，神秘，未知，充满着可能性，就像当年的新教徒，漂洋过海，到美洲寻找新大陆的感觉。但另一方面，你又极其渴望有一个地方，让你觉得稳定、熟悉，心里踏实，有安全感。这是非常矛盾的感受。\"\r\n　　到光亚的前两年，为了抵御独居带来的孤独感，每天上完课后，他会来到学校附近的一个茶馆读书，点一杯10块钱的竹叶青，从下午两三点钟，一直坐到晚上打烊。为了找到 \"稳定、熟悉\"的感觉，他每次都坐在同一个座位上。第一次去时，老板养的狗刚生了一窝小狗。每次去喝茶，他都要逗小狗玩儿，日复一日，一窝小狗只剩下一只，他却依旧每天坐在那里。除了老板，小狗只听他的指挥。\r\n　　每到一所新的学校，他都会给学生们放映他最喜欢的电影，《死亡诗社》。那个孤独却饱含激情，鼓励学生自由思考的 \"船长\"在曾经的他眼中，正是自己的化身。但多年过后他说： \"船长给人的感觉，是温暖的，充满善意的。可我在黑暗阴冷的深渊里待了太久。\"\r\n　　促使他这样思考的是他的学生。汶川地震后，他对大多数批评意见予以猛烈的反击，但当光亚学校的几个学生表达对他的失望时，他开始反思：我是不是真的太过冷酷了？\r\n　　答案是肯定的。他用一连串的形容词来形容自己当时的状态： \"孤独、虚无、黑暗\"，但又无能为力。 \"我也想多给别人一些爱，但是做不到。我从小没有感受过被爱的感觉，你自己都没得到过的东西，怎么给得了别人呢？\"\r\n#### 裸奔\r\n　　名为 \"第一线批判性思维专题研修班\"的培训进行到第三天，一位听课的企业家请几位授课老师吃晚饭，范美忠也在其中。企业家来自新疆，饭桌上的话题便从新疆问题开始，自然地延伸到了更广的时局领域，时不时还会插进来几个荤段子——性和政治，男人们的饭局主题总是如此。\r\n　　范美忠却几乎从不发言。他后来对我解释说，他对当下的时事并不关心。直到服务员端上了一盘秋葵，面无表情的他却一下子兴奋起来： \"山中习静观朝槿，松下清斋折露葵。王维的这首诗就是秋葵名字的来历。\"原本热闹的包厢突然沉默了几秒，众人纷纷掩饰尴尬的表情，夸赞他有学问——在一个荤段子横飞的饭局上突然冒出两句唐诗，你可以想象那是怎样的情景。\r\n　　另一位老师则成为了饭局的主角。他牢牢主导着话题的走向，偶尔开几句其他人的玩笑，实则是夸赞对方，语言风趣而不失分寸。他叫魏勇，北京十一学校的历史特级教师，范美忠最好的朋友之一。2003年，范美忠执教两个半月后被杭州外国语学校驱逐，在天涯社区发表帖子批判杭外校长。次日，魏勇发出《坚决反对范美忠的个人英雄主义》，两人由此不打不相识。互动几句后，他们发现对方竟是隆昌老乡，魏毕业于隆昌一中，范则是二中。\r\n　　单从饭局上的表现来看，他们像是两类完全不同的人：前者一身书生气，显出几分迂腐，后者则身段柔软，深谙处世之道。而二者的教师生涯也似乎是两条相反的轨迹：前者毕业于最高学府，一路颠簸，驻足于一所西部县级市的私立中学，后者师专毕业，从家乡的一所小学起步，一步步成为京城名校的王牌教师。\r\n　　另一天中午，我和范美忠、魏勇一起吃午饭。聊着聊着，范美忠情绪有些激动： \"我不怕别人骂我，你可以把我刚才说的写出去！\"说到这里，他的手机响了，出去接听大概五分钟后，他回来说自己要赶去参加一个朋友的婚礼。西装革履的魏勇用手指着他的衣服调侃道： \"你穿得这么随便，就别去砸场子了吧？\"范美忠不好意思地笑了笑，还是急匆匆去了。\r\n　　就是这样两个状况迥异的人，却保持了十几年的友情，至今联系密切。双方都认为对方对求知本身充满热情，并且具备与自己对话的水准。他们共同的朋友，德阳外国语学校语文老师丰继奎向我这样分析二者的异同： \"魏勇既有俗世的油滑，又同时怀有某种理想主义。相比之下，美忠是一个拙于谋生的人。他身边的很多人，打着理想主义的旗号，但在现实中其实都捕获了很多猎物。而美忠呢，一点儿猎物都没打到。\"\r\n　　对于性格造成的命运差异，范美忠不回避。 \"魏勇是一个有弹性的人，能够适当扭曲一下自己，在缝隙中游走前进，既让自己活得更好，同时能够实现理想。他这个能力是很强的，我很佩服。这种扭曲自己的能力，我几乎没有。\"\r\n　　在2012年一篇题为《启蒙者魏勇》的文章里，他用看似更为刻薄的语句评价这位挚友： \"他在理想和现实、批判思考与体制限制之间周旋的能力实在是太强了……魏老师的这种内心分裂能力和世俗智慧才是我最佩服的。\"\r\n　　当同样的问题抛给魏勇时，他将范美忠定义为虽不能至却心向往之的 \"裸奔者\"： \"为什么许多人喜欢范美忠？因为他有侵略性；为什么许多人反感范美忠？因为他有侵略性……他的侵略性源于思想裸奔的举动，比基尼让伊斯兰长袍感觉到侵略性，裸奔则让比基尼感受到侵略性。所以裸奔者范美忠让一切比基尼思想者自卑羡慕，进而产生一起裸奔的愿望——当然，仅仅是愿望。\"\r\n![裸奔者范美忠](http://photocdn.sohu.com/20150514/mp14909357_1431556724231_4.jpeg)\r\n　　童年的回忆毫无愉悦可言，尽管如此，范美忠觉得父母的一个共同点给他留下了愿意接受的烙印：真实。由于家事繁重，担任集体公社会计的范母曾一度辞职，几天后，邻居们纷纷上门请她回去，因为只有她能秉公办事。而范父也是从不看别人脸色行事的人。 \"我爸就是有一种什么呢，又臭又硬的感觉。不管是官是富，我没有听他说过一句吹捧别人的话。\"\r\n　　一件事如果让他感到厌恶，他必定反对。他的姐姐范美琼回忆说，父亲有时酒后会殴打母亲，家里无人敢发出声音，范美忠却会站起身来和父亲理论。\r\n　　这样的习惯被他带出了故乡。1992年，北大新生要在石家庄接受一整年军训，这被他视为 \"一生中最痛苦的一年\"。他每天熄灯后将头蒙在被子里偷听《美国之音》，直到随身听被没收。 \"这东西我军训前没听过，军训后也再没听过，但是当时禁止我们听，那我就偏要天天听。\"\r\n　　一年后的北大初体验，令他感到崩溃。他发现自己当时人文基础之薄弱，不但无法与大城市考来的同学相比， \"甚至不及校门口卖盗版光盘的文艺小贩\"。只是读了几本历史研究著作，他便觉得，自己过去12年阅读的课本，乃是满纸谎言，从小建立的世界观顷刻崩塌。一番恶补后，他又有了新的认识，觉得北大教授们多是寻章摘句的考据家，全无知识分子的情怀与格局。他表达失望的方式是放弃考试，在宿舍闭门自修，每天与室友辩论，且绝不认输。四年下来，成绩稳居末位，这并未让他失去批评教授们的底气：毕业后，他写出一篇流传甚广的《评北大历史系诸君》，将老师们骂了个遍。\r\n　　这篇在今天看来过于愤懑苛刻的文章，夹带着他当时对个人命运的不满：成绩不佳，又无其他技能，找工作四处碰壁。他觉得一门心思读了四年书，其实是把自己推向了极尴尬的境地：20岁时才从零开始补课，基础之薄弱，注定成为不了大家。而若是投身于现实，他天天琢磨的东西，又离社会太远。\r\n　　某一天，他突然觉得自己如此痛苦，全是书本的错。一气之下，把四年来买的一千多本书全卖了。\r\n　　冷静之后，他决定做一名老师。 \"自己成不了大家，但可以培养未来的大家。\"他回到四川，进入自贡蜀光中学。校长看中他的最大原因是，一个考进北大的人，一定能传授给学生们其他老师不具备的考试技巧。\r\n　　这个推测是错误的。范美忠不希望学生们重演他当年进入大学后世界观崩塌的一幕， \"我上课的基调就是猛烈批判教材\"。不到一个月，党委书记嘴唇发抖地质问他：你觉得学生考试的时候，该写你讲的，还是教材上印的？\r\n　　冲突不止于此。他的第一堂课不到20分钟就讲完，然后回办公室喝茶，因为觉得内容很简单，无须多言。他在公开场合对校长说高三老师都是在摧残学生，不顾同事们尴尬的表情。事实上，他并不把他们视为 \"同事\"，而是 \"当我的学生资格都不够的蠢材\"。\r\n　　三年后，他不辞而别。类似的故事随后在不同学校反复上演。在广州华美外国语学校，他21天即被辞退，导火索是在课堂上对比蒋经国和邓小平。2005年，朋友丰继奎邀请他做关于鲁迅的演讲，台下坐着德阳几所中学的五六十位老师，他张口就是 \"我觉得中国的文科老师多数都是白痴\"。没过几分钟，人已走了大半。\r\n　　\"他就是比较任性，谁都不管，自己想怎么样就怎么样。\"绍兴稽山中学语文老师蔡朝阳与范美忠在新浪读书沙龙相识，一度共同担任论坛版主。他用10个字形容范美忠： \"执着如怨鬼，纠缠似毒蛇。\"2002年5月，这两位网友在绍兴的一处出租屋首次见面，接头暗号是一本林贤治的鲁迅研究著作《记忆》。范美忠毫无初次碰面的拘谨，聊了三天三夜。 \"你根本没机会跟他说，我不知道，我听不懂。他就是不停讲不停讲，你带个耳朵听就是了。\"\r\n　　与范美忠交谈的几天里，我充分体验到了蔡朝阳的感受。他极度看重言说的连贯性，对交谈环境也十分在意。和他去德阳的那天，我找了两家茶馆，都被否决，打车找了大半个小时后，他仍不满意，直到打电话咨询一个当地的朋友才选定地方。 \"我这个人对吃饭穿衣一类的事情不是很注意，但是聊天的地方，一定要感觉舒服，才能进入交流的状态。\"\r\n　　因对应试教育体系深感绝望， \"不愿成为其帮凶\"，在他的教师生涯中，还曾短暂穿插过一段媒体从业经历。在《经济时报》，一篇近万字的文章被删去三分之二， \"感觉就像挥刀自宫\"，在《南方体育》， \"我忍受不了新闻娱乐化\"，一个月就主动走人。他只得回到自己熟悉的教育领域，在成都的《教师之友》杂志担任编辑。\r\n　　这段经历仍然是不愉快的。时任主编李玉龙回忆起一个细节：和一个教育专家讨论问题时，范美忠觉得对方姿态高傲却见识浅陋，骂他 \"傻逼\"。李玉龙命令范美忠道歉，他强忍脾气照办，但最后还是忍不住来了一句： \"虽然跟你道歉了，但我还是觉得你是一个傻逼。\"\r\n　　2005年下半年，《教师之友》团队因为一些复杂的原因被迫解散，在尚未清理完毕的编辑部办公室里，他用一台旧电脑连写了一个月文章，名为解析鲁迅《野草》，实为复盘己命： \"鲁迅自身对社会抱有过于完美的理想主义态度……他仍然缺乏打持久战的心理准备。鲁迅的启蒙未尝没有效果，但是因自身心态过于急切，总希望更快地见到更好的效果，故反而产生失败和受挫感。\"\r\n　　他觉得自己几乎已经到了无路可走的境地。 \"偌大的中国，竟无一处自由表达的空间。\"就在此时，在朋友的牵线下，他在成都的一间茶馆里，收到卿光亚的邀约，担任IB项目的中方老师。\r\n　　IB项目全称为国际预科证书课程，学生获得证书，就可取得进入大多数国家大学学习的资格。没有指定教材，没有教学大纲，甚至没有固定的考试形式，都由任课教师自行掌握。该项目的学生不参加国内高考，这意味着老师也无应试压力。这些都令范美忠兴奋不已，觉得简直是为自己量身定制。\r\n　　在光亚，他感受到了前所未有的授课自由。为了表达对他授课方式的充分尊重，卿光亚甚至从未听过他讲课。但好景不长，他不再忍受外部空间的逼仄，内心的痛苦，却在这种宽松的氛围中无节制地蔓延开来。\r\n　　他觉得找不到哪怕一个能与自己进行有质量交流的人，无论是学生还是老师。多次抱怨学生 \"质量普遍太差\"后，卿光亚甚至为他特意修改了选课制度，由学生选课改为双向选择，不喜欢的学生，他可以不要。\r\n　　包括魏勇在内的朋友们，经常接到他抱怨的电话。 \"他经常说，学生差得不得了。他的兴趣其实不在教育本身上面，而是通过讲课这种形式去探讨高精尖的问题。他看到学生没兴趣听课，他自己也没兴趣讲了，好吧，那你们就自己看书吧。这是没有道理的，基础教育的目的并不是培养大师、文豪，而是发掘孩子身上的可能性。如果我在他的位置，我不会去挑拣学生。\"\r\n　　范美忠接受这样的批评，但不愿做出改变。教育对他而言只是走出精神困境的手段，不是最终目的。目力所及范围内，很难找到一个比光亚更宽松的环境，但精神之困却还在延续，这令他内心的绝望感达到了峰值。坐在都江堰堤坝旁那个固定的茶馆座位上，三十多年来的种种痛苦矛盾，累积到了即将爆发的时刻。\r\n#### 重建\r\n　　范美忠偶尔会参加中学同学组织的聚会。多年不见面的同学，见面后总会问他，你原来那么强壮，现在怎么瘦了这么多。\r\n　　在我面前，他突然攥紧了拳头。 \"因为那时候天天在墙上狂打，本来很平整的一面墙，打得坑洼不平。\"拳头越练越硬，后来已经察觉不到痛感，他便不再满足于在家中操练，而是成天提着一根棍子到处走，等着别人与他干架。\r\n　　类似的行为模式延续到了成年后，只是换了一种形式。现实生活中找不到可以对话的人，他就转向虚拟世界。他不用网名，始终实名发帖。和现实中风格类似，他发帖火药味十足，回复极快，别人还没来得及回复一条，他已洋洋洒洒又发了七八条。\r\n　　这种风格自然会激怒别人，针锋相对的反驳文章屡屡出现。这反倒让他结识了不少朋友，魏勇、李勇、蔡朝阳皆是如此。由于讨论话题多集中于学术领域，引发的波澜始终限于小圈子里，直到2008年5月22日发在天涯社区的那篇《那一刻地动山摇》。\r\n　　7年过后，如今的他承认，当时的文风过于极端，语气比平时更加挑衅，但他强调，这是有意为之的结果，至今不后悔。 \"矫枉必须过正\"。\r\n　　为了躲避盛传的大余震，随后几天，他没有上网。直到三天后一个记者的电话，才让他意识到文章的影响。他问记者：我并不是一个受人关注的人，你采访我干什么？记者说：你自己上网看看吧。\r\n　　\"我蒙住了，不知所措。不是害怕，是压根儿没想到会扩散到这种程度。\"直到风波渐渐平息之后，他才回过神来：提着棍子和别人在小巷里打斗，或许没什么。但若是在人山人海的广场上挥起棍子，结果就不是自己能预料的了。\r\n　　记者的电话如潮水般涌来。他一概拒绝，希望事情渐渐平息。但发现一些曾对他予以极高评价的人也称他为 \"人渣\"后，他推翻了自己。 \"我怎么能以这样的形象定格在历史上呢？我还想用我的声音影响这个社会，如果现在不出来扭转这个形象，那以后说话还有谁听呢？\"\r\n　　在他自己的观察中，凤凰卫视《一虎一席谈》，成为了扭转形象的关键节点。一位辩论嘉宾请求主持人让他提前离场，在其看来，现场近乎疯狂的谩骂声，已经超越了承受极限。但范美忠表现平静，用微笑回应嘉宾的请求： \"放心，我足够坚强。\"\r\n　　节目播出后，大量支持他的声音出现，舆论由此前的一边倒批评变得多元。无论褒贬，都已让他感到麻木，他更敏感的是，媒体约访时，不再将注意力局限于那篇文章，而表现出对他过往经历的强烈兴趣。\r\n　　央视、新华社、《南方周末》、《朝日新闻》、BBC……媒体规格之高，问题之细致，令他意外。接受一家杂志采访时，他忍不住问记者：难道是中宣部下了文件要求你们报道我？回答让他哭笑不得： \"竞争媒体都在做你的稿子，我们不做，就是漏题。\"\r\n　　一拨接一拨的采访，持续了大约三个月。 \"当时我突然就想：我为什么不借此机会传播我的观念呢？平时写文章发网上没什么人看，现在到处都采访你，那你就借采访把观念说出来噻！虽然他们肯定会删，但是总能出来一些的。\"\r\n　　对于邀约，他也并非照单全收。北京一家培训学校请他去讲座，他本已接受，但在临行前，得知对方临时将主题改为了 \"如何考上北大\"，他在电话里大骂对方。 \"我当时非常生气。我这样一个反对高考、追求教育理想的人，你让我讲这个？\"\r\n　　一些心态乐观的朋友，觉得他是因祸得福。丰继奎曾对他说，这件事让我觉得你才是真正北大出身的人，你通过让自己下地狱的方式，上了从教以来最成功的一堂课。\r\n　　但很快，情势急转直下。6月初，他接到通知，光亚学校接到市教育局转教育部指令，要求吊销他的教师资格证。这是一个乌龙事件，因为他从未获得该证，吊销无从谈起。但经媒体报道，他被光亚解聘的消息很快传遍网络。\r\n　　危机时刻，曾经的电视剧导演卿光亚巧妙处理了此事。他一边向前来求证的媒体确认解聘的消息，一边安抚声称要起诉教育部的范美忠： \"你先回家休息，暑假结束就回来。奥运会一开，大家什么都忘了。\"为了让他安心调整状态，卿光亚后来甚至将他暑假期间的薪水装在信封里，开车送到他成都的家中。\r\n　　正如卿光亚所料，一场道德审判的狂欢过后，看客纷纷离场，只留下千夫所指者默默舔舐伤口。谈起这段经历时，范美忠拿过我的笔记本，在上面画了一个圆圈。 \"这是一个蛋壳。我以前一直努力破壳而出不得，\"说着，他又在圆圈顶端画了一个箭头， \"直到2008年，那件事像一个锤子，从外面把蛋壳敲破了。\"\r\n　　锤子的力量太过猛烈，砸碎了蛋壳，却也砸伤了他。 \"我以前一直觉得，我已经把人性看得过于阴暗、丑陋和虚伪，但通过这件事，我觉得自己以前对人性的估计还是过高了。\"\r\n　　越是这样觉得，他越是想要摆脱曾经的精神教父鲁迅。他觉得自己对人性之恶的洞察已经达到了和鲁迅相当的水准，但这又如何？ \"鲁迅只提出问题，却从来不给出答案。\"\r\n　　决定离鲁迅而去的这一年，范美忠37岁。他在《荣格自传》中看到一套神秘理论，称37岁是一个人找到自我，精神发展走向真正成熟的节点。他将信将疑，阅读了更多材料，发现似乎确有道理——37岁这年，鲁迅发表《狂人日记》，黑格尔写就《精神现象学》，海德格尔完成《存在与时间》。与他们相比，37岁的范美忠，却要彻底重建自己的精神体系。他形容当时的自己在沼泽地中越陷越深。 \"我拼命想抓住一个东西把自己拉上来，但扑腾半天，却不知道该抓什么。\"\r\n　　最难熬的时候，他通过打篮球透支体能来释放压力。李勇成为了他的球伴，几个月间，两人把成都市内所有小学的球场打了个遍。\r\n　　时至今日，自认为已经上岸的他反复强调妻子的帮助。经朋友介绍，他们2006年初在网上认识，7个月后走进婚姻。为此，吴文冰放弃了自己在北京的工作，回到家乡。在京时，她曾借从事儿童出版的机会，混迹于北大的知识圈子。 \"北大的很多学者、博士，比美忠更帅，性格也更柔和。但是和他们聊天感觉很失望，根本没什么力量。美忠那种真、纯的力量感，非常有魅力，让我眼前一亮。\"\r\n　　\"如果当时没有遇到我，他现在很可能已经走向崩溃。\"范美忠认同妻子的这个判断，觉得对方带给了他一直所期盼的归属感。 \"我以前一直很害怕有了婚姻和孩子，就会失去自由。但婚后看法很快就改变了，它其实让你获取更大的自由，从那种漂泊的、没有归属感的困境中解脱出来。\"\r\n　　他们在一起最爱做的事是，在书房里各捧一本书，读到触动之处就念给对方，交换各自的体会。汶川地震之后，在吴文冰的引导之下，亟须心理重建的范美忠每日诵读《圣经》，尝试和妻子一样，成为一名基督徒。\r\n　　他一度觉得，基督教像是一架直升机，将会把自己从沼泽中拉起。但这番尝试最终以失败收场。 \"基督教讲求无条件的宽恕。对于当时的我来说，终究还是很难做到。\"\r\n#### 出走\r\n　　2015年1月31日的傍晚，范美忠在微信朋友圈公布辞职一事： \"终于辞职离开光亚学校了。10年，这是我做得最长的一个工作了。稍事休息，接下来要做三件事：迎接新生命的诞生；准备华德福高中的历史课；继续写《庄子解读》。\"\r\n　　5分钟后，一位朋友留言： \"嗯，终于摆脱了卿光亚的魔爪，祝贺！\"\r\n　　他马上回复： \"我是很感谢卿校长的，他给了我很多帮助和照顾。只是一个工作做久了，确实感到疲惫和厌倦。\"\r\n　　看似平淡的回答背后，暗流汹涌。\r\n　　2011年，他觉得自己对学生理解能力的忍受达到了极限，试图通过开设新课程的新鲜感来减轻自己的痛苦。在西方思想长河中漂流多年后，他将目光重新投向中国传统，具体对象是《庄子》。这是一个带有偶然性的选择： \"一般的作品我看不上眼，要教就教最好的。唐诗宋词好，但是太熟悉了，厌倦了。那就只有先秦经典了，《论语》讲了一遍，不喜欢。那试试《庄子》吧，其实我当时不懂，大学在床头放了四年，就是读不懂。\"\r\n　　头两年的讲授过程， \"现在可以负责任地说讲得是不好的\"。 \"当时我一直是在批判《庄子》，不讲逻辑，逃避现实。其实根本没读懂人家意思，还瞎批。\"\r\n　　他觉得自己随后突然找到了门径。 \"第三年才入门，第四年水平就已经非常高。可以说能够代表当代研究《庄子》的最高水平。\"\r\n　　如今，他的自我定位不只是《庄子》的研究者，而是皈依者。这是人至中年的一场精神出走： \"曾经我对中国文化是完全拒斥的，但现在我觉得它绝非我以前想象的那样。鲁迅那代人对中国文化有很多成见，其实他们并不太懂。《庄子》这种原典，才真正涉及中国人精神的核心问题。\"\r\n　　\"那你现在对鲁迅什么态度？\"\r\n　　\"没有任何兴趣了。鲁迅全集还是要留着，其他研究鲁迅的书全扔了，除了我自己写的。\"\r\n　　他觉得 \"庄子把我对绝对真理的执着和理性逻辑的自由都打破了，这让我彻底自由\"， \"获得了前所未有的平和\"。一个例证是，2008年的风波过后，他和妻子曾经把批评自己的言论全部汇集在一个文档里，现在打开这个文件，他内心不会产生任何波动。\r\n![裸奔者范美忠](http://photocdn.sohu.com/20150514/mp14909357_1431556724231_5.jpeg)\r\n　　早年间在课堂上大谈政治，向学生 \"放毒\"的场景，如今鲜有出现。早前，他曾参加成都的一些知识分子聚会，在一场读书会中，大家围坐成一圈，谈起了反腐话题，挨个表达愤怒。范美忠感觉尴尬，差点儿中途离开。后来，他退出了这个组织。 \"别人都很愤怒，我一个人无动于衷，也不是很好。可是，总不能伪装愤怒吧？\"\r\n　　但一如过往，并不是谁都能认同他的自我判断。卿光亚眼中范美忠这几年的变化，就与他本人的讲述相去甚远。他在我面前表示出对范美忠未来生活的巨大担忧，例子之一，就是他不久前辞职的经过。\r\n　　对于收到范美忠的辞呈，卿光亚早有心理准备。 \"每次地震周年的时候，总有媒体问他辞不辞职，为什么不辞职？不停地给他心理暗示，结果搞得他居然把辞职当成了一个提要求的法宝，每隔一段就来说一下。\"\r\n　　为了让范美忠留下，卿光亚屡次做出妥协。除了专门为他修改选课制度外，还把他的课程都安排在早上11点。 \"他说他起得晚。其实是没有理的，按照学校规定，早上8点准时上班，不管有没有课。他也不坐班。有一次他睡过头没来，我还去替他上课。\"为了让他安心任教，卿光亚说自己还对他做出了一些暗中的保护。每年春天，都江堰市教育局都会派人来校询问范美忠的状况，卿光亚总会想办法错开范美忠讲课的时间，避免双方直接接触。\r\n　　\"狼来了\"的故事上演了七年，终于成真。范美忠与成都华德福学校达成约定，将于2015年秋季学期起在该校讲授高中历史，他的妻子目前正是在此任教。他并不觉得华德福是比光亚更理想的平台，离开的原因只是厌倦了目前的状态。 \"我对中国的学校，已经不再抱有期待。一个地方待久了，即使它很好，我也会选择离开，因为它是旧的。\"\r\n　　按照他与华德福的约定，他本应在光亚执教到2015年夏天，但实际离开的时间却提前了半年。突然提前辞职的导火索，是一个看似琐碎的事件。\r\n　　他错过了一堂期末考试的监考，高中分部校长为此开出罚单，要扣他三天工资。他当着校长的面将罚单撕碎，并向卿光亚抗议此事。 \"我当然是拒绝他。这种事情我不能通融。\"卿光亚回忆说。而范美忠的反应则是，辞职。\r\n　　卿光亚觉得，汶川地震让很多人受到了严重的心理创伤，范美忠是受伤最深的人之一。 \"他比以前更敏感，更反叛。2008年之前，高中部是个外国女校长，要求老师着正装上课。他穿牛仔裤，校长要处罚他，他就跑出去买了一套正装，回来跟学生说，看到没有？这就叫规则，就叫纪律。可现在呢？\"\r\n　　无论卿光亚如何一再表达惋惜，这对合作十年的搭档终究分道扬镳。提前辞职意味着，未来半年内，范美忠将没有固定收入，可第二个孩子的降生，必然意味着更多的经济支出。但和过去一样，仍然无法在他身上感受到关于金钱的忧虑。一天傍晚，我和他一同乘坐公交，路过一栋闹市区路口的高楼时，他告诉我大楼的主人是一位北大哲学系1987届的师兄。 \"钱挣多少算多呢？很多时候只是个数字。每年成都北大校友会聚会时，这个师兄都是捐钱最多的，但那些钱换算一下，也不过是这栋大楼的几平米罢。\"\r\n　　他习惯性地将话题拉回精神层面。 \"我读懂《庄子》的同时，也完全解决了自己的精神问题。心灵得到自由，生命得到安顿。他让我的生命走到了一个新的阶段，思想获得了大突破。\"\r\n　　七年之间，从鲁迅到庄子。这种颠覆性的变化，真的已经完成了吗？他的朋友冉云飞告诉我，他强烈怀疑。 \"他一段时间内喜欢什么，他就极力推崇什么。这是他的大问题。这是多年累积的知识结构的缺陷造成的，很难解决。\"\r\n　　实际上，范美忠如今仍然在被一些问题所困扰，尽管在旁人看来几乎称不上是问题。几年前，朋友送了他一辆二手桑塔纳，也将烦恼送给了他。那天傍晚等公交车的时候，他说自己每天都在为出行方式感到纠结，作为一个环保主义者，他觉得开车与否将自己置于了一个两难的境地。\r\n　　他最好的朋友魏勇觉得，判断他是否真正完成了精神的蜕变，还为时尚早，也并不重要。 \"我经常想，也许在我们同情范美忠的时候，其实他正双倍地同情我们。我们很多人都是假猎手，永恒地瞄着目标却永远不肯扣动扳机，而他想开枪就开了，管它准不准。开枪常失准头的猎手还是猎手，可永远不开枪的猎手还是猎手吗？不如说是猎物。\"\r\n　　（本文原载于《智族GQ》杂志，原标题为：裸奔者范美忠，是微信号 GQZHIZU 原创文章）', ',思想,', '43', '0', '2016-09-02 11:22:55', '2016-09-07 21:18:21', '0', 'http://photocdn.sohu.com/20150514/mp14909357_1431556724231_2.jpeg', '1', 'http://learning.sohu.com/20150514/n413008832.shtml');
INSERT INTO `tb_post` VALUES ('74', '1', '一名前教师追问：徐玉玉之死，我们足够心疼吗', '', '', '0', '　　作者：单士兵   来源：理论头条v\r\n　　前几天，18岁的农村女孩徐玉玉死了。徐玉玉刚被南京邮电大学录取，却中了诈骗电话的招，学费被骗光，焦虑痛苦之下，心理崩溃，突然昏厥，继而身亡。\r\n　　这样的悲惨，也激起人们痛骂诈骗分子心狠恶毒，痛斥通信运营商无良失职，批评公共部门援助救济缺失，指摘相关部门轻忽公众权益。这种舆论情势，似乎已经成为轮回现象。比如，若问接下来，电话诈骗能进行陪葬吗？垄断无良能及时遏止吗？监管失灵能尽快改变吗？很多人恐怕只能一声叹息。\r\n　　最不想看到的，就是人们将这类人间悲剧视为一个宣泄情绪的临时出口，久而久之，心灵越来越麻木。面对徐玉玉的死，很多人说，“太让人心疼了”。我认为，这份心疼，值得呵护。心足够疼就不会麻木。如果能让这种锐痛感转变为普遍的共鸣感，进而生成改变各种不公的共理心，心疼还可以带来动力，产生改变不公的现实力量。\r\n　　那么，你对徐玉玉真的足够心疼吗？你真的了解徐玉玉这种农村贫困学生是如何艰难奋斗的吗？你真的清晰感受到这类群体在人生转折期遭遇的心理压力吗？我认为，不知道农村贫穷高中女生经历过怎样的心灵炼狱，就不明白徐玉玉为何会心理崩溃，也不足以去说是真正心疼徐玉玉。\r\n　　十几年前，我在苏北一所国家级示范性高中当班主任老师。那个城市很多权贵名流都会动用各种关系来把子女送进来这所名校。我的班上有不少学生是从农村考来的，他们多半家境贫寒，但学习刻苦，成绩优异。这类学生团结认真，进步巨大，后来学校还专门开设农村班，将从农村高分招来的学生放在一起。我也被调去做农村班老师，加上自己本身也是在农村贫困家庭长大，我敢说，我真的懂他们。\r\n　　因为懂得，所以慈悲。我对农村学生格外偏爱，特别是农村贫困女生，更是心疼。农村并不足够重视教育，很多贫困家庭女孩读完初中就会被送出去打工挣钱养家。加上重男轻女观念严重，很少家庭愿意在女孩进行过多的教育投资。那些农村贫困家庭女生非常珍惜到城里名校读书的机会。城市再繁华，也与她们无关。她们不买漂亮衣服，没有化妆品，吃不起好的饭菜，分数就是她们所有快乐与幸福的所在。每次考完试，考砸的都会哭得撕心裂肺。每天晚自习熄灯后，她们总会去抢路灯下的位置读书，直到被我赶回宿舍。周末她们也很少回家，安安静静在教室里学习。\r\n![徐玉玉作文《我的家庭》](http://n.sinaimg.cn/news/transform/20160826/N_37-fxvixer7282852.jpg)\r\n徐玉玉在其作文《我的家庭》里说：父母已年近半百，过了半辈子了呀。还没跟我们姐妹俩享一天清福呢所以，我一定要很努力地学习才能报答我的父母……　　徐玉玉在其作文《我的家庭》里说：父母已年近半百，过了半辈子了呀。还没跟我们姐妹俩享一天清福呢所以，我一定要很努力地学习才能报答我的父母……\r\n　　她们就是应试教育的囚徒，但应试教育也是她们的希望。应试教育的考核标准化、行为短期化、目标功利化，尽管适合做放飞她们梦想的翅膀，但也随时会让她们变成折翼的天使。她们不认同辍学打工或早早出嫁的生活，为远离粗鄙乡村，开启梦幻人生，用尽心力去死读书，读死书。在这种情况下，应试教育给了她们分数，但不能带来良好的人格养成，也不能带来防范社会风险的能力，反而容易让她们生成更为偏狭性格心理。由于应试教育偏离人文精神，也无法祛除贫困和学业带给她们带来的心理压力，她们不断承受着自尊与自卑带来的痛苦。可以说，在从高中通往大学的道路上，随时都会出现压垮这些贫困女生的最后一根稻草。\r\n　　那些年，我曾见过很多贫困高中女生的悲剧，最普遍的是精神衰弱、性格畸形，严重的就是高考失败、选择自杀。值得强调的是，为这些女生提供心理救助，使她们免于恐惧和伤害，并不是容易的事。因为生存压力和生活梦想，都把她们心拴得死死，让她们信念系于一端，一旦破灭，就容易崩溃。徐玉玉因电话诈骗突然崩溃死亡，就是这种状况的表征。毫不夸张地说，现在依然有无数的农村贫困女在经历着可怕的心灵炼狱。如果整个社会对她们人生缺乏心疼，对她们命运缺乏关注，对她们苦难缺少救助，像徐玉玉这样的悲剧，就一定会通过各种各样的方式上演。\r\n　　再穷不能穷教育。教育扶贫确实也是国家精准扶贫的重要落点，精神扶贫和文化扶贫也是被屡屡提及的概念。但是，精准都在细节幽微处，文化都在人心深远处。徐玉玉的悲剧，还是说明，我们社会对这样的人生并不足够心疼，特别是从国家和制度层面，还缺乏足够精细的人文呵护和救济力量。\r\n\r\n', ',思想,', '75', '0', '2016-09-04 21:03:22', '2016-09-07 21:17:40', '0', 'http://n.sinaimg.cn/news/transform/20160826/N_37-fxvixer7282852.jpg', '1', 'http://news.sina.com.cn/pl/2016-08-26/doc-ifxvixeq0519696.shtml');
INSERT INTO `tb_post` VALUES ('75', '1', '“郭曹互撕”后面是一卷长长的裹脚布', '', '', '0', '郭德纲和徒弟曹云金的矛盾闹大了，闹翻了。\r\n我稍为捋一捋，是上周郭德纲在纲丝节上公布了德云社的家谱。曾经的两名云字科徒弟何云伟与曹云金并不在列，这显然是要将两位徒弟除名的意思嘛。\r\n![](http://tc.sinaimg.cn/maxwidth.800/tc.service.weibo.com/mmbiz_qpic_cn/073bdf585dcd95da505ea7d3e889ad66.jpg)\r\n然后郭德纲又发微博：该清的清，该驱的驱。所谓的清理门户，是为了给好人们一个交代。凡日月所照、江河所至皆以忠正为本。留下艺名带走脸面，愿你们万里鹏程。从此江湖路远，不必再见。\r\n这不指名不道姓的话已经很明了：我要清理门户，要和曹云金你们这些不孝之徒断决关系，从此老死不相往来。\r\n然后，曹云金发长文细述自己和郭德纲的恩怨，称曾被赶睡公园演出遭封杀。还说，“是你的江湖险恶，但我的世界阳光，……人生长路漫漫，确实不必再见。”这是一副从此绝别的话。\r\n![](http://tc.sinaimg.cn/maxwidth.800/tc.service.weibo.com/mmbiz_qpic_cn/dbabd5bede34a2de07df629f424408d3.jpg)\r\n再然后，就是其他人，包括郭德纲的徒弟纷纷站出来指责曹云金“背叛恩师”，说“一日为师终身为父”，曹云金此举是禽兽不如。\r\n比如郭德纲的徒弟朱云峰就说了：德云社十大班规之首，不准欺师灭祖。守者立，犯者罚！一日为师，终身为父，老话乌鸦讲反哺，羊羔跪乳。出言不逊，犯我恩师。禽兽尚知眷念父母！总之，还字之前，请闭嘴。\r\n无论是郭德纲还是其徒弟朱云峰的话语，都充满了让我熟悉而惊讶的口吻和气息，那就是过时的，江湖味极浓的，充满人身依附的师徒关系，散发着一股子霉味。\r\n“现代社会，师徒关系仍然有权利与义务之分别，但本质上是契约关系，彼此应该是平等而独立的。”\r\n我记得我大学毕业到某银行办公室工作，行长是从过去老信用社过来的人，就跟我说，我们现在大学生多舒服，而他那阵子从业时不叫员工，叫学徒，在师父面前低三下四，早早就来到办公室，把卫生做好，把师傅的桌子擦得干干净净，冬天生好炉子，师父一来，温热的毛巾就递了过去，把师父侍候得舒舒服服，才学到一点业务。\r\n这种情形在过去可能是比较普遍的，无论哪一门手艺，都还没有学校，成件制，模板化，批量学习，要想学点东西，就得拜师学艺，学到了手艺，才能够混出名堂，才能有安身立命之本。所以，任何一个学徒都有可能将师父视为再生父母，故而有“一日为师终身为父”，师父对徒弟的影响实在太大了，确实是徒弟的大恩人，恩重如山，恩重超父母。\r\n与之相对的是，师父给你如此大的恩惠，改变你的命运，给你一生的荣华富贵（比如成了名师、名角、名人），相应地，你对师父要尽到更多的义务，这其中就不准欺师灭祖，这其实就是要你“一日为徒终身为徒”，背叛恩师的事，肯定会遭到圈子里以及社会的普遍指责，这是有其合理性的。\r\n![](http://tc.sinaimg.cn/maxwidth.800/tc.service.weibo.com/mmbiz_qpic_cn/80a8ba80cc3fdc1b401d4a2252e946a9.jpg)\r\n此外，在过去，一门讨生活的手艺、艺术，求学者众，师父有极大的挑选权，一些底层弟子无家可归，拜师学艺时也就将师父视同生父生母了，视师父的家为自己的家。而在过去，子女对父母有极大的人身依附，说不上有多少独立的人格和自由，这也让过去的师徒关系染上了浓浓的人身依附关系。\r\n\r\n而且这样的父子关系毕竟非血缘关系，师父对徒弟的背叛自然舍得下狠手打击，加之像戏曲、相声这些群体多为江湖行走者，生存颇为不易，不冷血不行，一旦沾染了江湖规矩，翻起脸来，就会更为残酷无情。\r\n\r\n这一点，我们可以从《霸王别姬》的电影里看到，那些学京剧的徒弟对师父是何等的言听计从，师父有着怎样的生杀予夺之权，可以决定着弟子的前途命运。哪怕成了名震天下的名角，对师父也是不敢有半点不敬。\r\n\r\n\r\n然而，时代变化了，很多手艺、艺术都纳入到学校制了，而不是门派师徒制了。在现代社会，师徒关系仍然有权利与义务之分别，但本质上是契约关系，彼此应该是平等而独立的，“一日为师终身为父”更多的是讲一种尊敬，绝不是强调人身依附关系。没有哪个老师敢要求弟子对其尽无穷的责任，成为师父赚钱的工具，对其有绝对的指使，没有这回事。\r\n![](http://tc.sinaimg.cn/maxwidth.800/tc.service.weibo.com/mmbiz_qpic_cn/a94425c0c693eb1ac393e971872919a1.jpg)\r\n只有仍然没有进化到现代教育模式的手艺和艺术，只有还停留在传统时代的思维，只有还迷恋江湖思维的人，才会觉得自己收了一个徒弟，就是收进了家门（门户），就是自己的孩子，可以一辈子指来唤去，幻想着自己仍拥有强大的父权，弟子稍有不从，就动用社会道德来鞭打他。\r\n\r\n恰恰现在很多手艺、艺术都已经学校制化了，有些手艺可以在职校学习，有些艺术可以投师艺术学校。而这样的学习之中，我们很少听说师生之间有那么多的书剑恩仇之事。唯有仍然保留着传统的、江湖式的传授方式的相声、二人传等艺术，总是不断地闹出一些幺蛾子，不断爆出内讧，不是师徒反目，就是徒弟之间互撕，圈子内的互殴，而且撕起来还不如泼妇骂街体面，斯文扫地，其状难看至极。\r\n\r\n\r\n我想，这些落后的、过时的艺术传授方式真得改改了，还把过去那些裹脚布、小脚当宝贝，在现代社会还演绎得那么自鸣得意，除了感到恶心，还有太有多的时空穿越感。\r\n\r\n新京报 2016.09.05 20:25\r\n\r\n文/廖保平', ',思想,', '37', '0', '2016-09-06 09:32:54', '2016-09-07 21:16:59', '0', 'http://tc.sinaimg.cn/maxwidth.800/tc.service.weibo.com/mmbiz_qpic_cn/0', '1', 'http://media.weibo.cn/article?id=2309404016443917259512&from=timeline&isappinstalled=1&jumpfrom=weibocom&luicode=10000011&lfid=2');
INSERT INTO `tb_post` VALUES ('76', '1', '川藏线老司机说：就算你举着“求怀孕”的牌子', '', '', '0', '作者： 来源： 兴趣部落 2016年09月04日 21:50:20\r\n![](http://www.fawan.com/UploadFiles/allimg/160904/25_160904214706_1.jpg)\r\n　　作为一个常年在川藏线跑生活的老司机说：“穷游的妹子们，拜托你们不要进藏了，如果要进藏，请你们坐火车、飞机进藏，我不会再搭你们了。请原谅我们的拒绝!”\r\n　　讲真的，常年跑西藏货运，一路上都是男男女女的背包客，只要他们竖起大拇指请求搭车，我都会停下来搭他们。有时候甚至他们不请求搭车，我也会主动停下来问问他们要不要顺道载他们一程；因为看着他们背上背包那么沉，挺心疼他们虐待自己的。\r\n　　顺道搭载他们一程，是举手之劳的事情，咱们就当做好事积阴德了；谁一辈子没有遇到过困难，对不对？\r\n　　不过，前阵子开始，我决定不再搭载他们了。因为发生了太多事，我也不想给自己不痛快。\r\n![](http://www.fawan.com/UploadFiles/allimg/160904/25_160904214719_1.jpg)\r\n##### 1.舆论的威力太大了，压力也大\r\n　　我有空的时候会看看新闻，看到关于川藏线的新闻也会点进去看看。那些评论说什么炮游、AB制、分腿游，真是外行人看热闹，说得好像我们为了占人家小姑娘便宜才搭载一样。川藏线上，男男女女都搭过，就觉得顺道帮个忙，路上也有个说话的人，没那么无聊。可是现在那么多人说炮游的，容易误导我们的家人。我不想惹这个麻烦，以后就不搭他们了。\r\n##### 2.路上形形色色的人太多\r\n　　搭的人多了，碰到形形色色的人也多。碰到很多有素质的，比如中途停车加水时，还会去商店给我带烟、带红牛的。像这种人，我就觉得帮他们是值得的。\r\n　　当然，也遇到一些脸皮厚的，有时候搭他们会碰上饭点，有些人很客气的吃随身携带的干粮或者自己吃、有些人跟着我一起吃饭主动掏钱请客；而有些人吃完直接拍拍屁股走人连句客套话都没有，好像我请吃饭是应该的；后来我再遇到这种人，我直接说今天不走了，让他们自己走。\r\n![](http://www.fawan.com/UploadFiles/allimg/160904/25_160904214734_1.jpg)\r\n##### 3.作为谈资，不会感恩\r\n　　现在为什么那么多人说炮旅、分腿游，就是他们中一些人把事情说得太玄乎了，什么83元走西藏、700元走西藏，弄得人们云里雾里，东想西想；也害得我们变成了占便宜的司机。\r\n　　其实那些说花83元、700元走西藏的人，就是为了吹牛逼，说得自己有多厉害。就不知道感恩这一路上帮助过他们的人，只拿这些当作他们吹嘘的资本。\r\n##### 4.遇到困难时\r\n　　之前搭了一个人，半道轮胎爆了，我下车换轮胎，他倒好，帮都不帮，直接下车走了。\r\n##### 5.无节操\r\n　　曾经一个司机朋友好心拉一个搭车的男生，谁知道下车后，他的钱包都不见了。\r\n　　总之，现在碰到他们，我现在是不敢搭了，也不想搭了。搭到些有素质的人还好，搭到那些没素质的人，心里窝火。干脆不搭，不惹那一身臊。', ',思想,', '52', '0', '2016-09-07 10:42:31', '2016-09-07 17:26:26', '0', 'http://www.fawan.com/UploadFiles/allimg/160904/25_160904214706_1.jpg', '1', 'http://www.fawan.com/fwbdhz/2016/09/04/365992.html');
INSERT INTO `tb_post` VALUES ('77', '1', '你知道“道德绑架”背后的真实心理吗？', '', '', '0', '后台有一位读者给我讲了这样一个故事。\r\n\r\n>他出生在西北的一个小县城，由于地理原因，那里的生活条件很落后，大家都过着贫穷的日子，有什么事相互帮忙，邻里关系很不错。其中有一个人头脑特别灵活，知道附近的山上有很多珍贵的药材，就以很低的价格买下了那片山头，雇了些人上山采药，然后贩卖到东部发达地区，再把那里的东西运回来卖给小县城的人，如此十几年折腾下来，竟然拥有了一家制药公司和一家贸易公司，不但在市区买上了别墅，还配了一辆日本进口的小轿车，成为远近闻名的首富。\r\n\r\n>这时候，小县城的人不淡定了，认为他应该把赚来的钱拿出来给大家修公路，建养老院，照拂家乡。\r\n\r\n>他不愿意，认为自己想做慈善那是自己愿意，凭什么让别人来支配自己的财富？于是，他遭到了空前的责难，一顶顶帽子扣下来，比如“为富不仁”“忘恩负义”“一毛不拔”等等，他和家人成了大家眼里的混蛋。\r\n\r\n>读者说当年他才刚上高中，看着大家同仇敌忾的样子，活像对方杀了自己全家一样，他小小的心灵极为震撼，但是他不敢发表意见，怕别人把怒火引到他身上。\r\n\r\n>后来，由于某岛事件，引发了民族矛盾，小县城的一些人二话不说就拿着铁器，把他的日本小轿车砸了个稀巴烂，人人都瞪着血红的眼睛怒骂：“砸了这贱种的车，他是卖国贼、汉奸！”\r\n\r\n>这些暴力行为把他们一家吓得够呛，最后不得不搬家。\r\n\r\n![你知道“道德绑架”背后的真实心理吗？](http://www.timetimetime.net/zb_users/upload/2016/6/2016060801415563.jpg)\r\n\r\n还有一位读者跟我说，他是从农村到大城市来打拼的南漂一族，去年过年买了一辆车开回家过年，本来一家人都挺高兴的，结果有些邻居却说有能力买车，应该把那钱留起来给你父母养老，自己快活，于心何忍？\r\n\r\n读者说我每个月都会给我父母寄钱，父母老了我也会负责到底，可是我买辆车开着上下班怎么了？难道我不能买车吗？\r\n\r\n读者最后问我：每个人都有自己的自由和权利，过什么样的日子，怎么处理自己的财富，这不都是应该由自己决定的吗？为什么有这么多人喜欢搞道德绑架呢？你能告诉我这是为什么吗？\r\n\r\n若在以前，我会回复他，之所以有很多人喜欢道德绑架别人，是源于缺乏界限感，不懂得尊重别人的生活和选择，喜欢把自己的意志强加给别人。\r\n\r\n也有很多人认为道德绑架的人都是圣母，出发点是好的，只是方式用错了，曾经我也这么认为，但接触人性久了，发现完全不是这么一回事，我们所看到的，不过是事情的表面，而且还是最浅的那一面。\r\n\r\n所谓道德绑架的出发点，和圣母一点点关系都没有，你以为这些人是真的捆绑着别人做好事吗？\r\n\r\n就好比文中指责读者的那些邻居，他们真的关心那位读者是不是孝顺父母吗？他们根本不关心！真正的原因是：我家没有车，你家居然买车了。可是他又不能不让你买，怎么办？指责你不孝啊，孝道在中国的威力，很多人都感受过，还有比这更有打击力的武器吗？\r\n\r\n其实，作为是成年人，有多少人是真的不知道不应该去干涉别人的生活呢？有多少人是真的不知道那是人家自己的钱，人家想怎么花就怎么花呢？\r\n\r\n大多数人还是明白的，那么，为什么他们还是喜欢搞道德绑架呢？这其中的真实原因，恐怕连那些习惯道德绑架的人，都不敢面对。\r\n\r\n如果仔细观察一下，我们会发现但凡喜欢搞道德绑架的人，都是又LOW又穷又失败并且心理还不健康的那些人，于是，就不难理解为什么会产生道德绑架了。\r\n\r\n还记得马云下面的逼捐吗？如果这些留言的人对马云说：“你那么有钱，给我点花花吧？”会是什么结果呢？\r\n\r\n我想肯定会招来很多骂声，诸如“你穷你有理啊？”那些逼捐的人自己也明白会得到什么样的结果，于是，扯过道德的大旗，摇身变成：“发生了这种灾难，你这么有钱不应该多捐一些做好事吗？”\r\n\r\n于是，有了所谓的道德和正义的遮羞布，这些人就能大行肆虐，其真正的心理并非行善，当他们看到其他人联合在一起去指责比自己有钱有能力的人，他们的内心终于达到平衡，会生出这样的窃喜：呵，有钱又怎样？还不是跟过街老鼠一样，人人喊打？\r\n\r\n他们的真实心理是：你那么有钱，凭什么你一个人用？拿出来给大家花花！哼，就算你不拿出来，大家的唾沫也能淹死你，你也别想好过。\r\n\r\n这种心理才是逼捐背后的真实心理，源于仇富，而非圣母。\r\n\r\n还记得之前砸日本车的事件吗？\r\n\r\n据我了解，动手去砸的人当中没有一个是地位超然、能力卓绝的人，大多是些平时生活不得志的人，你会看见开着宾利、法拉利的人去砸人家二三十万的本田丰田吗？\r\n\r\n所以，答案不言自明。\r\n\r\n如果这些人说：“凭什么我骑自行车上班，你开着进口车出行，老子砸了你？”想都不用想会得到什么后果。但在特殊的时期，当这些人打着“爱国”的名义去干这些事，他们内心的阴暗心理就会被掩盖，还会得到诸多理解，比如：“爱国情怀是很好的，只是方式不当，太激进了。”\r\n\r\n在自我的催眠下，可能连他们自己都觉得自己的行为很“爱国”，而忘记了自己的心理有多阴暗。\r\n\r\n其实，他们的行为完全不是爱国，若真的爱国，必然会考虑什么行为才是真正的爱国，什么行为会带来后遗症，而不是以这种又LOW又蠢的行为，替中国抹黑，让外媒嘲讽，爱不爱国，他们并不关心，有没有替国家抹黑，他们也不在意，他们真正的心理是：“你开进口小轿车？我让你开不成，还落个卖国贼的恶名。”\r\n\r\n他们想发泄的不过是生活中的不得意和扭曲的心理而已。\r\n\r\n还有那些自己婚姻不幸福，别人要离婚时，经常在旁边说：“离婚太不负责了，为了孩子也该忍一忍，我都是为了你好，不希望你的人生留下遗憾。”\r\n\r\n你可以仔细观察一下，但凡这么说的女人，自己的婚姻状况如何？不管她们如何粉饰自己的幸福和掩饰自己的失意，都改变不了这些人的婚姻质量差强人意的事实，因为，真正幸福的女人是不会去干涉别人家的家事的。\r\n\r\n她真正的内心活动是：我不幸福我可以忍，凭什么你就要离婚？大家都是人，谁比谁高贵啊？大家一起不幸，自己的不幸就不会那么难受了。\r\n\r\n但她不能直勾勾地这样表达，于是才会拿出万年法宝——孩子，以孩子的名义捆绑你，离婚就是不为孩子负责，让你不管离与不离，都如鲠在喉。\r\n\r\n当然不是说，但凡劝合的人都心怀不轨，劝离的人才是为了你好。真正为你好的人，一定会去了解你真实的处境，给出中肯的意见，为你好的劝和，是替你分析现状，总结得失，绝不会上来就指责你不负责任；为你好的劝离，同样需要客观站在你的处境上，本着希望你更幸福的用意而给出的意见。\r\n\r\n之所以有这么多人喜欢搞道德绑架，是因为道德绑架太好用了，只要一拿出道德这面旗帜，就可以把别人打入万劫不复的地步，还不得抗争。\r\n\r\n所以，我们要明白：一个人有了一定的见识和成就后，是绝对不屑去道德绑架别人的，因为但凡成功的人，多多少少都经历过被人强迫的滋味，他们深知被一群无知无脑的人绑架，又无法理喻的那种感觉。\r\n\r\n那些动辄指责别人、干涉别人的人，永远都是一群没有自我、没有追求、没有情操、也没有见识的失败者而已，你又何需在意这些人说什么呢？\r\n\r\n你只要明白一点：说你不爱国的人，也许他生平没有做过任何爱国行为；说你不孝顺的人，也许他自己从来没干过什么孝顺的事；说你不负责任的人，也许他一辈子都没为谁负过责任。真正希望你做得更好的人，他们会用一种你非常乐意接受的方式来影响你，同化你。\r\n\r\n成功者都在为自己的人生努力，LOW者才会到处乱喷，绑架别人。\r\n\r\n不必害怕道德绑架，只有实在拿你的成功没办法的人，才会用道德绑架你，若他有其他打击你成功的办法，早就用了，就因为没有，才会耍耍嘴皮子，给你添点堵，明白了这一点，还需要那么郁闷想不开吗？\r\n\r\n我们要明白，如果你想过得比别人好，比别人更成功，你就无可避免地会受到道德绑架，攻击诋毁，这是我们在成功道路上必然会遇到的，没承受住，你就会掉入愤怒烦躁的深渊，承受住了，你的前路繁花似锦，一群有格调、有品位、有涵养的朋友，正在前方含笑等着你加入。（文/晚情）\r\n\r\n作者简介：晚情，作家，编剧，云意轩翡翠创始人，著有《且以情深共白头》《豪婚》等书，新书《做一个刚刚好的女子：不攀附，不将就》正在热卖中。微博@晚情的小窝，个人公众平台：倾我们所能去生活。', ',思想,', '27', '0', '2016-09-09 22:39:27', '2016-09-09 22:42:14', '0', 'http://www.timetimetime.net/zb_users/upload/2016/6/2016060801415563.jpg', '1', 'http://www.timetimetime.net/yuedu/71906.html');
INSERT INTO `tb_post` VALUES ('78', '1', '少年游·并刀如水', '', '', '0', '\r\n并刀如水，吴盐胜雪，纤手破新橙。锦幄初温，兽烟不断，相对坐调笙。\r\n\r\n低声问：向谁行宿？城上已三更。马滑霜浓，不如休去，直是少人行。\r\n\r\n—— 周邦彦（1056-1121）北宋词人', ',思想,', '20', '0', '2016-09-10 11:52:32', '2016-09-11 10:56:28', '0', '', '1', '《少年游·并刀如水》');
INSERT INTO `tb_post` VALUES ('79', '1', '表姐一家让我懂得娶一个女人，家庭背景多重要', '', '', '0', '先说说我表姐一家吧，我舅舅好吃懒做，靠着我外公留下的旧城区的破房子，一个月收 2000 块的租，天天不干活，就知道在楼下跟别人打麻将赌，赌不大一天输赢几十块，舅妈还好点，在商场帮人卖衣服，但是性格很懦弱，这样的家庭下，我小表哥也是个不学无术的人，初中毕业就没念了，跟人混社会，混到现在也没一人样，一天到晚喝酒。我表姐想考大学，舅舅没给，认为女人就应该早成家，她气不过，自己边打工边自学，报成考，考了 4 年愣是考不上，于是放弃。\r\n\r\n然后悲剧的人物就来了，我的表姐夫，在网上跟我表姐认识，武汉大学的，挺帅挺清秀，也不知道看上我表姐什么，只身前往南宁，考了西大的博，来的时候看我舅家挺穷，置办了很多家电。为了讨好我舅，还决定留在我们这边发展。于是悲剧就开始了，结婚的时候，我舅一分钱没出，在南宁办的，表姐夫一家人大老远从武汉跑过来，出钱出力，但是看得出表姐夫还是很幸福的，我表姐好面子，去了五星级酒店，本来我表姐夫一家人也没什么钱。基本上是掏积蓄给办婚礼，我舅那边的亲戚死抠。红包基本给的 100 块。差不多一道菜钱。拖家带口的来。但是我表姐夫有出息啊，把工程爆破证给考了，挂给别人，一年有 10 几万的收入（现在不知道了），博士毕业后工作一个月 2 万月薪，（真不吹）。年薪贼高，于是就按揭买了个地段不错的房，月供多少没说，但应该负担得起。我小表哥看我表姐夫那么有钱，就怂恿我表姐，让她买车，还说年薪那么高，买辆车有什么难，我表姐好面子，就逼我表姐夫又按揭买了天籁，但是我表姐夫因为早年读书比较认真没考驾照，于是车顺理成章的给我表哥开，还不带出油费的，一开就是开到现在。于是表姐夫日子开始过得紧巴巴的，我表姐生完孩子后也不上班了，天天在家里看电视带孩子逢人就说她老公多牛逼。万幸我表姐夫人踏实努力，很快生活就开始有点起色了。但是这时候我表哥因为走偏门，卖毒 品，被抓，看守所的人说给 10 万就改成吸毒，不是贩毒。我舅穷的叮当响，只能求助我表姐夫，我舅妈一把鼻涕一把泪，我表姐夫没办法，10 万一掏，等我表哥出来了还给我表哥讲了一晚上道理，我当时心里就替他悲哀，我表哥什么人啊你真是幼稚。\r\n\r\n然后就是老城区的房子突然说要拆，我舅跟智障一样，以为偷偷加盖能多赚点钱，于是把房子加做了两层（钱大部分我表姐夫出，说是拿了拆迁款多还他），结果检测员来检测，说多盖的不算，又因为房子比较老，就只有土地证，没有其他两证，一平米只补偿几百（坑吧，前段时间还有因为这个闹事的），我舅瞬间傻眼了，苦的还是我表姐夫，房子快没了，又不愿意租房，那怎么办？举家全搬我表姐夫的房子去了。一家人偷偷核算着，拆迁款那么少。买个房子都不够，又因为常年好吃懒做，收租收习惯了，还是想买自建房，但是现在自建房贵啊，一栋都是几百万的。然后就开始怂恿我表姐夫，贷款，把自己的房子抵押上，贷款买自建房，说是投资，以后升值。其实谁都懂是为了自己一家人住顺带收租。我表姐夫自然不乐意，闹了好一阵，终于没闹成，双方各让一步，等房子拆了，我表姐夫再出一笔钱，加上拆迁款给我舅一家买套房，前前后后预计得要几十万感觉。\r\n\r\n然后就是几个星期前，我表哥给放高 利 贷的做打手，被人捅了，伤到了肾，做了很久的手术（我妈还掏了 3000 救急，估计也不会还了），当时已经有生命危险，还好我表哥命大，活了下来，捅人的那个人早就消失了，于是住院的钱，药钱，还得我表姐夫来，听我妈说，我表哥不懂伤哪里了，手一直抖，医生说估计会有后遗症，我妈就很叹息。不懂以后还能不能干活。昨晚我和我爸妈一起去看我表哥，我舅一家人都在，我表姐夫在表姐吵得很厉害，我们一来，就又不说话了，脸色黑得厉害，回来我妈说是我舅为了让我表哥 \" 改邪归正 \"，强烈要求我表姐夫在公司安排一份工作给我表哥，但是公司又不是我表姐夫开的，当然不可能，于是我表姐就闹，现在情况怎样不得而知。\r\n\r\n昨晚我看到我表姐夫的时候，差点认不出来，虽说他天天跑工地，但是看起来真的很寒掺啊，犹记得当年那清秀的样啊，现在变成这样，真是感慨，想想如果他娶的是个普通人家明事理的女孩子，加上他那么有本事，现在生活得过得多好。同时也让我更加明白，结婚跟谈恋爱真的差很多，千万别为了爱情盲目结婚，我爸妈也表示让我远离这样家庭背景的女生，日子毕竟是过的，不是一时半会的，两个人在一起应该是让生活有所提升，而不是倒退。现在想想也是感慨，都说男怕入错行，女怕嫁错郎，其实男人也要怕娶错人啊。\r\n\r\n来源：虎扑步行街', ',思想,', '19', '0', '2016-09-10 15:05:30', '2016-09-10 15:06:06', '0', '', '1', 'http://www.nanyangshi.com/news/2016/04-25/2b2bc85135187818772e08c15dd0facd.html');
INSERT INTO `tb_post` VALUES ('80', '1', '底层放弃教育，中产过度焦虑，上层不玩高考', '', '', '0', '作者：余秀兰\r\n　　越来越多的社会底层家庭的孩子放弃高中、大学，直接选择技工学校，学门手艺和技术；5%的上层家庭根本不玩中国高考游戏，也看不上国内质量越来越差的本科教育，这些家庭的孩子从幼儿园开始就选择每年学费高达数十万的国际学校，高中甚至初中就到欧美发达国家继续接受最优质的教育，他们将是未来中国社会甚至国际化的精英。\r\n　　对教育最抓狂和焦虑的当属城市中产阶级家庭，他们的孩子输不起，稍不努力考不上一本、985、211大学，他们的社会流动轨迹就将滑向底层。这就是中国社会当下，生动的阶层教育画像。\r\n##### 余秀兰：焦虑的中产阶级，焦虑的教育梦\r\n　　曾经，“读书改变命运”“知识就是力量”是社会上流行的口号。教育是中国亿万家庭，特别是贫困家庭子弟的一剂强心针。\r\n![](http://img.mp.itc.cn/upload/20160904/84474bad902f4141993facf27a8a9288.jpeg)\r\n　　如今，“一毕业就失业””“学好数理化，不如有个好爸爸”等口号却戏谑地调侃了教育，这个曾是渴望向上流动的人们赖以改变命运的独木桥。许多令人困惑的情况出现了——\r\n　　第一，“教育改变命运”的口号在当前的社会环境下已然变味。整个社会教育的起点已经提高，即使付出很大成本，得到的也只不过是最基础与必需的教育。受教育已不是提高个人档次的问题，而是维持最低生活所必需的问题。\r\n　　第二，教育不再是让一个家庭脱贫致富的好事。对于许多家庭而言，大学学费无异于天文数字。一个人考上大学，一个家族都会被拖入贫困的泥潭。加之如今就业压力不断增加，城市生活成本日益趋高，即使大学毕业，对家庭的回报也没有保障。\r\n　　第三，欠缺高等教育，同样可以获得高的社会地位。许多名人并未受过高层次的教育，但有着可观的金钱和较高的地位。再加上所谓的“土豪”、富二代、官二代的不断涌现，使得“读书无用论”有了生存的土壤。\r\n　　种种现象似乎表明，教育促进社会成员的升迁性社会流动的功能减弱了，高层次的教育并不必然带来好的收入和职业地位。\r\n　　“教育改变命运”的口号不再像过去那么令人信服了。而中国的不同阶层，对待教育的态度也有了截然不同的差别。\r\n#### 一.绝望的底层人民：干脆放弃高等教育\r\n　　一位两个孩子均在外打工的家长说：“读个初中就行了，读多了也没用的！”“以前村子里的人都认为我目光短浅，瞧不起我，现在，他们好多人反过来求着我，让我儿子帮他们的孩子找工作。念大学又怎么样，还不是为了找一份好工作。可是现在，机会多的是，不是非要上大学。”\r\n![](http://img.mp.itc.cn/upload/20160904/563b16b9503d4af0a822c51ba05dd38a_th.jpeg)\r\n　　中科院社会学博士后的调查发现，越贫穷越认同“读书无用”：村庄贫困层认同度62.32%、农村中间层37.24%；年收入1万元以下的村庄贫困层认为读书无用的比例最高。\r\n　　由此可见，认为“读书无用论”再次泛滥的结论并不正确。中高层从未说过读书无用，相反，他们更加疯狂。\r\n#### 二.疯狂的中产阶级：对教育的焦虑与过度重视\r\n　　且不提一线城市天价却依旧供不应求的名校学区房，根据今年七月的一则新闻报道，一位80后上海妈妈为今年9月即将上小学一年级的孩子列了个学期清单，暑假开销加课外学习的开销达到32万元。除了各种学习用品、家居用品和夏令营以外，总计20个课外兴趣班。\r\n　　中产阶级对教育的焦虑，从中国不断高企的学区房价和愈发火热的补习班便可一窥全貌。\r\n　　而一条新的道路越来越成为新中产阶级的家庭标配，那就是读私立学校和出国读书。2016年6月10日，南京某私立学校的幼升小面试中，5086名孩子竞争216个名额，录取比例破23:1。而其如此受欢迎的原因，与该校针对出国留学的教育方式有不容忽略的关系。\r\n![](http://img.mp.itc.cn/upload/20160904/6a19fd2ecb644044a6b8c12158f6448d_th.jpeg)\r\n　　孩子的教育问题集中反映了中产阶级的焦虑情绪。中产阶级希望自己的孩子可以继续接力，向更高的社会经济地位跃迁，为此他们不惜重金，让孩子去上各种辅导班，学习各种才艺和礼仪，让孩子赢在起跑线；如果做不到这一点，他们就会转而拥抱阶层固化，希望孩子至少可以继承自己的中产阶级身份，为此他们不惜搁置自己的价值观，他们会坚定地反对异地高考，将招收农民工子女的学校贬称为“菜场小学”，避之不及。\r\n　　中产阶级的孩子，也许是学业压力最大的一个群体，这源于他们父母内心深处巨大的不安全感：毕竟，与社会上层相比，他们的孩子输不起。（熊易寒：中国中产阶级的三副面孔，《文化纵横》2016年8月）\r\n　　这些现象都带给人们极大的困惑：教育还能改变命运吗？底层的上升通道关闭了吗？教育与社会流动究竟是怎样的关系？\r\n#### 三.人们为什么讨厌那些“二代”？\r\n　　观察当前的中国社会可以发现，社会阶层固化趋势显现，向上流动困难。\r\n##### 第一，教育面前机会不平等的现象仍很严重。\r\n　　这些教育差距（除第四个差距）主要是因地域差距造成的，但同时也有家庭社会经济背景的因素，不同家庭背景为孩子提供的经济资本、文化资本、社会资本差距越来越大。具有较好社会经济条件的家庭会为孩子选择较好的教育。此外，家长在学校教育之外的投入也因家庭条件的不同而差距很大，家庭条件好的家庭可以为孩子找家教、选择辅导班和进行各种才艺培训。\r\n　　这些，都导致了不同家庭背景的孩子拥有不同的教育成就。\r\n![](http://img.mp.itc.cn/upload/20160904/8b874eb3f94a423b82ac595dc99e1d2b_th.jpeg)\r\n##### 第二，优胜劣汰公理遭“二代”现象挑战。\r\n　　“二代”现象反映了社会差别通过代际更替具备一定的遗传性，上代的优势可以通过各种途径放大和强化而传递给下代。\r\n　　在地位获得方面，一方面，上代的优势可以通过影响下代的教育水平，从而影响下代的地位获得，即上代可以为子女提供更优质的教育资源，从而使他们在教育竞争中获得优势，进而在地位获得上取得优势；\r\n　　另一方面，上代可以直接利用经济资本和社会资本为下代获得较好的职位。有研究表明，社会就业竞争越激烈，社会资本运作的空间就越大。“拼爹”是对这一现象最形象的概括。\r\n　　由于高等教育的扩张，获得大学文凭不再是件困难的事情，但大学文凭对不同的人具有不同的功能。对于某些家庭社会经济背景好的学生来说，大学文凭可能只具有象征性的功能，他们的就业不需要完全依靠这张文凭；而对于家庭社会背景差的学生来说，大学文凭则具有实在的工具性功能，是他们找工作的唯一资本。\r\n　　正如杜里－柏拉和让丹所指出的：“虽然文凭是必不可少的，但是并不能因此认为为了获得某一社会职位有文凭就足够了。”“现实中，择优录用的运作似乎被社会因素严重扭曲了。在学业成功和选择某一教育与家庭环境不无关系的事实之外，社会出身继续对教育水平相当的青年们的职业插入产生影响，并在整个职业生涯中继续介入其中。”\r\n　　正是这些原因，导致了底层人们向上流动受阻，对教育绝望。而中产阶级，却开始了地位焦虑和对教育的疯狂。社会阶层结构变得更加固化，“拼爹一代”成为人生赢家。与此同时，社会矛盾极易激化，富二代、官二代成为了诸多社会矛盾的来源，和一触碰就燃起熊熊舆论之火的敏感词。\r\n#### 四.寒门学子，除了努力还能拼什么？\r\n　　教育，究竟能否促进升迁性的社会流动？\r\n![](http://img.mp.itc.cn/upload/20160904/2c04005495934bf480822be5c87318f9_th.jpeg)\r\n　　事实上，这取决于大的社会结构，当一个社会是开放公正的，人们的地位获得主要依靠其知识与能力，而不是其家庭背景和社会资本，教育所起的作用就会较大；反之，当一个社会的阶层结构封闭固化，人们的地位获得主要依靠先赋因素，依靠对上代优势的“继承”，教育所起的作用就很小。\r\n　　其次，取决于教育本身是否公平合理，教育机会与教育资源是否公平地向每个阶层的人开放，教育中是否不带有任何阶级偏向。因为只有公平合理的教育才能促进合理的社会流动。\r\n　　此外，还要考虑教育发展的速度与规模同经济发展之间的匹配性。这就是说，教育能否促进底层的升迁性社会流动，并不仅仅是由教育本身决定的，还受社会因素制约，而且归根结底是社会结构起决定作用。\r\n- 只是，寒门学子，除了努力还能拼什么？\r\n- 你有什么理由放弃努力？\r\n- 你有什么理由放弃改变命运的机会？\r\n- 努力是你唯一的宿命。\r\n　　法国当代著名社会学家布迪厄说过：面对经济资本和社会权力，文凭虽然只是“一个日渐疲软的通货”，但是中国中产阶级孩子除了拼高考，还有什么路可走？\r\n　　教育已经成为中国社会阶层的隐秘再生产的途径。上层阶级的父母用权力资本和经济资本为子女提供了最优质且稀缺的教育资源，这些出身背景相似的孩子从幼儿园开始就只和同样社会地位的孩子社交，形成上层精英封闭的人际网络。\r\n　　底层社会放弃高等教育这个中产阶级的孵化器，将世代都是蓝领个人。而中产阶级家庭多数孩子在普通大学毕业后将成为低收入的低级白领，要么是城市贫困群体，要么继续啃老。\r\n- 这是合理的现象吗？\r\n- 政府的责任何在？\r\n- 父母该为孩子的阶层负责吗？\r\n- 这些，或许都是我们应该进一步思考的问题。', ',思想,', '33', '0', '2016-09-10 16:25:36', '2016-09-11 11:02:10', '0', 'http://img.mp.itc.cn/upload/20160904/84474bad902f4141993facf27a8a9288.jpeg', '1', 'http://learning.sohu.com/20160904/n467555179.shtml');
INSERT INTO `tb_post` VALUES ('81', '1', '孩子问爸爸：为什么要上学？', '', '', '0', '![](http://img.mp.itc.cn/upload/20160908/81466aea05d94036ac031da8b838d24a_th.jpeg)\r\n　　“爸爸，我为什么要上学呢？” 上学不久的儿子问爸爸。\r\n　　爸爸说：\r\n　　儿子，你知道吧？一颗小树苗长1年的话，只能用来做篱笆，或当柴烧。\r\n　　长10年的话可以做檩条。\r\n　　长20年的话用处就大了，可以盖房子，可以做家具，还可以做玩玩具...\r\n　　一个小孩子如果不上学，他7岁的时候就可以放羊了，长大了能放一大群羊，可是他除了放羊，其他的事情基本干不了。\r\n　　如果上6年小学，毕业了，在农村他可以用新的技术来种地，在城里可以去打工，做保安，也可以当个小商贩，小学的知识就够用了。\r\n　　如果上9年，初中毕业后，他就可以学习一些机械的操作了。\r\n　　如果上12年，高中毕业后，他就可以学习很多机械的修理技术了。\r\n　　如果大学毕业，他就可以设计高楼，铁路桥梁。\r\n　　如果他硕士博士毕业，他就可能发明出许多我们原来没有的东西。\r\n　　知道了吗？\r\n　　儿子：知道了。\r\n　　爸爸问：那放羊、种地、当保安，丢人不？\r\n　　儿子：丢人。\r\n　　爸爸说：儿子，不丢人。他们不偷不抢，凭本事赚钱，养活自己的家，一点也不丢人。不是说不上学，或上学少就没用。就像一年的小树一样，有用，但用处不如大树多。对社会的贡献少，他们赚的钱就少。读书多，花的钱也多，用的时间也多，但是贡献大。\r\n　　儿子：我明白了，我要好好读书。\r\n　　\r\n　　儿子出国前还对爸爸说，那次谈话印象深刻。\r\n　　跟孩子交流既不需要威逼，也不需利诱，孩子会为自己做最好的选择。\r\n　　其实，教育很简单，越朴实的话语，越能震撼人心，越能激励孩子们努力前行！在这一点上，中外莫不如此！', ',思想,', '90', '0', '2016-09-11 10:53:28', '2016-09-11 10:53:34', '0', 'http://img.mp.itc.cn/upload/20160908/81466aea05d94036ac031da8b838d24a_th.jpeg', '1', 'http://baobao.sohu.com/20160908/n467983133.shtml');
INSERT INTO `tb_post` VALUES ('82', '1', '中国社会即将分层，你将会在第几层？', '', '', '0', '这不是鸡汤，也不是砒霜，只是从纷繁复杂的现状中，抓住背后的暗潮涌动，分析我们将面对的未来：\r\n#### 社会即将分层，你将会在第几层？\r\n01\r\n\r\n你的下一代将被迫逃离家乡？\r\n\r\n“凡有的，还要加给他，叫他有余；没有的，连他所有的也要夺过来。”\r\n\r\n这句话出自《圣经·马太福音》25章29节，后人以此为典故，归纳了“马太效应”，即强者愈强，弱者愈弱。\r\n\r\n#### 马太效应是世间最冰冷的规则，却又无处不在。\r\n\r\n当“逃离北上广”和“逃回北上广”的话题在网上大热时，公众号“城市数据团”发表了一篇爆文《逃离你终将衰落的家乡》。文章以各省人口流动的大数据为依据，得出了一个残酷的结论：\r\n\r\n#### 大都市就像抽水机，不停地从落后省份抽取劳动力，或许将来的某一天，我们就会像今天的日本一样，无数村庄和城镇凋零衰败，但东京和大阪都市圈繁华依旧。\r\n\r\n#### 在人口负增长的时代，大都市将毫不留情地吸干周边地区的血液，以便自己能够生存。残酷吗？不，因为这是年轻劳动力自己用脚（投票）投出的结果。\r\n\r\n![](http://dingyue.nosdn.127.net/qCQ6eiZoZWuBY3ByGXkVY5bGAwqbXQ66luTcgpywuvIno1473750305795transferflag.png?imageView&thumbnail=690x10000&quality=50)\r\n\r\n大都市拥有优质的政治资源、商业资源、教育资源、人力资源……这些优质资源吸引着无数优秀的年轻人，而优秀的年轻人将推动大都市的繁荣发展，从而让大都市获取更多的资源，于是形成了一个优势迭代的良性循环，这就是马太效应中的强者愈强。\r\n\r\n而由人口迁徙引申出来的推论，则更加触目惊心：\r\n\r\n#### 你还能在这些选择（逃离北上广还是逃回北上广）中犹豫，说明你无比幸福，因为你们的下一代和下下一代可能不会再有任何选择的机会。假如你最终选择留在了一个生活安逸风景如画的小城镇上，你也许会幸福地过完一生；但在你的子女到了你这个年纪的时候，很可能他们有且只有一个选择，那就是——逃离他们终将衰落的家乡。\r\n\r\n文中所谓的“无比幸福”其实“无比残酷”，因为大都市在攫取优秀人才的同时，也在用高额的房价和户籍制度将千千万万的普通人挤到繁华都市的边缘，将他们赶到逼仄的地下室，脏乱的出租房，直到他们梦碎的那一天，收起行囊，滚回家乡，然后他们的下一代再背起行囊，逃离家乡。\r\n\r\n这就是马太效应的另一面，弱者愈弱。\r\n\r\n![](http://dingyue.nosdn.127.net/hizhr45HX6YZpyo32mbrRsqmYfp4oTjXdF7dLJrUWP5Zg1473750305795.jpg?imageView&thumbnail=690x10000&quality=50)\r\n\r\n02 越有钱收入增长越快！\r\n\r\n《二十一世纪资本论》的作者汤玛斯·皮克提认为，当今的资本回报率已经大于经济的增长率，这将会导致社会财富向少数人聚集。\r\n\r\n也就是说，越有钱收入增长越快！经合组织（OECD）的统计数据验证了这一点。\r\n![](http://dingyue.nosdn.127.net/khSMkNnLaneASybmgDjLqKgWDOWSVEo3fg2uJUbp6mhs01473750305795.jpg?imageView&thumbnail=690x10000&quality=50)\r\n最近30年，英美等发达国家的高收入群体和低收入群体收入都有所增长，但是高收入群体（政企管理者、金融从业者、IT从业者）的收入增长更快。\r\n\r\n#### 投资财富的积累犹如滚雪球，同样的速度下，雪球越大体积增长越快\r\n![](http://dingyue.nosdn.127.net/vkMD6gvpu7H5rGcuC3K7wWS0Tpr66Zl6wt=rzTMdw6Jeq1473750305798transferflag.png?imageView&thumbnail=690x10000&quality=50)\r\n>当王健林“先赚它个一个亿”的小目标刷屏时，你有没有算过：王健林身家2600亿，一个亿只占他总资产的0.04%，对他而言真的只是一个小目标啊！\r\n\r\n而对于没有家产且年收入十万的年轻人而言，一个亿的小目标也不算太难，也就是不吃不喝工作1000年而已。\r\n\r\n03 寒门再难出贵子\r\n\r\n1980年，一个农民家的孩子踏进了北大的校门，邻里乡亲都以他为荣。可他到了北京之后才发现：自己没读过课外书，跟不上同学的聊天话题；穿衣搭配非常土，女生找他扛包打水，理由居然是为了让自己的男朋友休息一下；做个自我介绍，也被当众嘲笑，说他普通话讲得像日语；除了插秧是能手，他一样都拿不出手。\r\n\r\n就是这样一名农家子弟，他创办了第一家在美国上市的中国教育机构，他入选了“中国最具影响力的50位商业领袖”，他的名字叫俞敏洪。\r\n\r\n寒门出贵子，逆境出英才，俞敏洪的人生经历书写了读书改变命运的传奇。\r\n![俞敏洪照片对比](http://dingyue.nosdn.127.net/hYV0biqzK6sJaTMLPJSET1A4YMVNh09kTrOncg7YsaLXT1473750305798transferflag.png?imageView&thumbnail=690x10000&quality=50)\r\n可是，如果俞敏洪再晚生几年会怎样？\r\n\r\n北京大学教育学院副教授刘云杉统计1978年~2005年北大学生的家庭出身发现：\r\n\r\n80年代中后期是农家子弟用知识改变命运的黄金时代，三成以上的北大学子出自寒门；\r\n\r\n90年代中期农家子弟的比例开始下滑；\r\n\r\n2000年之后，考上北大的农村子弟仅占一成多。寒门子弟进名校的通道正变得越来越窄。\r\n\r\n农家子弟的名额都被谁占了？\r\n\r\n权威期刊《中国社会科学》于2012年刊登了一篇研究报告《无声的革命：北京大学与苏州大学学生社会来源研究（1952-2002）》。报告通过研究50年数据，得出了一个让全社会哗然的结论：\r\n\r\n#### 90年代后，考上北大的精英子弟比例快速攀升，这些社会精英只占全社会人口的1.7%，却有40%的北大学生诞生于这样的精英家庭。\r\n\r\n#### 寒门再难出贵子，精英扎堆进名校，这是马太效应的又一次胜利。\r\n\r\n（为什么80年代是农家子弟的黄金年代？因为高考是1977年才恢复的，随着时间的推移，马太效应日趋明显。）\r\n\r\n04 绝望的底层，高喊读书无用\r\n\r\n前几天，有读者转给我一篇“亚洲新闻周刊杂志”公众号的文章，标题是《底层放弃教育，中产过度焦虑，上层不玩中国高考》。\r\n\r\n在此之前，我早已在朋友圈刷到了这篇文章，因为标题实在太刺眼，而刺心的是，它反映的难道不就是现实吗？\r\n\r\n作者余秀兰借中科院社会学博士后的一项调查得出结论：**越贫穷越认同“读书无用”**。村庄贫困层认同度62.32%、农村中间层37.24%，年收入1万元以下的认同比例最高，于是作者用了这样的小标题来描述底层人民对待教育的态度——绝望的底层人民：干脆放弃高等教育。\r\n\r\n作者的结论对吗？\r\n\r\n对。虽然情理难容，但却在意料之中，不信我论证给你看：\r\n\r\n#### 论据之一：家里越穷，读书的代价越高\r\n\r\n2014年《经济学人》(The Economist)的一项报告指出：包括书本费用在内，高中三年的学费动辄数千美元——这往往超过了贫困农村家庭一年的收入。\r\n\r\n#### 论据之二：出身越底层，上的学校越差\r\n\r\n2014年，瑞典隆德大学的薄家珉(Benjamin Lillebrohus)的一项统计报告显示：2012年复旦大学新招收的农村学生占比为10.36%，同济大学占比18.98%，天津大学28.14%，吉林大学32.27%，西北师范大学59.85%，南昌大学43.68%，喀什大学（原喀什师范学院）56.98%。\r\n\r\n就像《南方周末》2011年的一篇报道中提到的那样：“出身越底层，上的学校越差”，这一趋势难以被逆转。\r\n\r\n#### 论据之三：学校越差，越难找到好工作\r\n\r\n当社会的教育起点越来越高，应届毕业生越来越多时，好工作的门槛也必然越来越高。毕业生要面对的竞争对手，是人才市场中所有竞争同一岗位的人，所以对于三流大学的毕业生，“毕业即失业”已不再是笑话。\r\n\r\n另一方面，无论寒门学子为上大学背了多少债，付出了多少代价，企业顶多只会表示遗憾，仅此而已。\r\n\r\n对于底层人民而言，教育的高成本，低收益，导致了他们对教育的绝望。\r\n![南方周末记者 翁洹/图](http://dingyue.nosdn.127.net/61Ozh6YLbUkoqJizcjsIvVgcKuM8BJV2uFIVfOkA67p2V1473750305798transferflag.png?imageView&thumbnail=690x10000&quality=50)\r\n05 海淀拼娃是怎么拼的？\r\n\r\n当“读书无用”的声音在底层日益高涨时，社会中上层却在教育的投入上更加疯狂。\r\n\r\n今年上半年，一篇名为《北京的无奈：海淀拼娃是怎么拼的》的文章在各路家长的朋友圈疯狂转发。\r\n\r\n当主流媒体炮轰课外班是培养应试教育的机器时，作者透露了他孩子在辅导班的课程：\r\n\r\n语文由北大的老师上课，孩子读的是《大学》和《春秋》，但很多内容讲的其实是历史，而且是把中国历史发生的事情与外国历史横向对比，带有文化和哲学的启蒙。\r\n\r\n英语则是新东方的名师上课，孩子从自然拼读开始，不再是死记硬背，而是在讲英语故事。\r\n\r\n数学则是国内985名校的毕业生授课，小学低年级的奥数就足以让文科生缴枪，但孩子学会了就会有乐趣。\r\n\r\n作者称儿子每天早上七点半起床，晚上八点课外班下课，赶回家还要写作业，做完作业还要看课外书，一般是儿童读物，一周读完一本，一个月读完一套，内容包括科技、历史、地理等等。\r\n\r\n或许你会觉得这样的家长很残酷，居然把孩子逼得那么苦，说好的快乐教育呢？可更残酷的是，所有的这一切，都是孩子自己要求的。\r\n\r\n“一般控制他晚上十点要睡觉，但他经常会比这个睡得晚，孩子才七岁啊！真的很担心，每次都对他说你不想学了课外班就不要上了，但他总是不愿意，他有一个目标，就是能够赢了老爸，要有他会他老爸不会的内容。\r\n\r\n文章的最后一句话耐人寻味：成功真的不是一代的积累。\r\n\r\n更耐人寻味的是：龟兔赛跑，如果兔子拼命向前跑，会怎么样？\r\n\r\n答案依然是马太效应。\r\n![](http://dingyue.nosdn.127.net/zFmp5R0vUbCl2gS1kCM4kz2VUVMVZCraUF1mw93R=H1bP1473750305798transferflag.png?imageView&thumbnail=690x10000&quality=50)\r\n06 社会越发达，阶层越固化\r\n\r\n《人生七年》是BBC的一部纪录片，它选择了14个不同阶层的英国孩子，记录了他们的人生轨迹。从7岁开始，每七年记录一次，一直到他们的56岁。\r\n\r\n这项历时49年的研究揭露了一个残酷的事实：穷人的孩子依然是穷人，富人的孩子依然是富人，阶层在代际间得到了传承。\r\n\r\n7岁本该是个天真烂漫的年纪，但不同阶层孩子已表现出了明显的差异。\r\n\r\n上流社会：John和Andrew就已经养成了阅读《金融时报》、《观察家》的习惯，他们明确地知道自己会上顶级的私立高中，然后读牛津大学，再然后进入政坛。\r\n\r\n中产阶层：男孩会拥有自己的理念，如反对种族歧视，帮助有色人种；女孩则想着长大嫁人生子。\r\n\r\n底层社会：有人希望当驯马师赚钱，有人希望能有机会见到自己的爸爸，而贫民窟出生的Paul，甚至把“吃饱饭、少罚站、少被打”当成了自己的人生愿望。\r\n\r\n49年之后，他们已是56岁。\r\n\r\n上流社会：John成为了企业家并致力于慈善事业，Andrew成为了律所合伙人，他们的孩子继续接受着精英教育。\r\n\r\n中产阶层：他们中的大多数人依然是中产，也会有个别滑落到了社会的底层。\r\n\r\n底层社会：Paul成为了泥瓦工，Symon则成为了司机，他们生了一大堆儿女，儿女中的大部分人继续在底层靠出卖劳动力为生。\r\n![](http://dingyue.nosdn.127.net/iNRI7dJwJjWWjiJTdxvRKts81ZYVPMMwA8ZV1aVnjiTkS1473750305800transferflag.png?imageView&thumbnail=690x10000&quality=50)\r\n在一个百废待兴的社会，弯道超车，一夜暴富都成为可能，但社会一旦进入到发达又稳定的阶段，阶层的分化和固化将变得日趋明显。\r\n\r\n哈佛公开课《公平的起点是什么》中指出：“即使是努力本身，很大程度上也依赖于幸运的家庭环境。”\r\n\r\n两位罗斯福总统都毕业于哈佛，“布什家族”四代都是耶鲁校友，小布什在竞选的时候甚至开玩笑说：“我继承了我父亲一半的朋友。”\r\n\r\n上层社会的人脉、财富、精英意识、教育资源等等，父传子，子传孙。\r\n\r\n而社会中下层的孩子，在公立学校接受了所谓的“快乐教育”后，构成了新一代的社会中下层。但不管怎样，发达社会至少能为他们提供可靠的生活保障。\r\n\r\n这是社会稳定的另一种形态。\r\n![](http://dingyue.nosdn.127.net/6tH0eSB=QqgAlvzXMXpon42LNO9VzrrC49rpfU4ihW7bv1473750305802transferflag.png?imageView&thumbnail=690x10000&quality=50)\r\n07社会即将分层，你将会在第几层？\r\n\r\n郝景芳的《北京折叠》荣获2016年的雨果奖。\r\n\r\n雨果奖是世界科幻小说的最高奖项，堪称科幻界的“诺贝尔文学奖”，可《北京折叠》与其说是科幻，不如说是披着科幻外衣的社会隐喻：\r\n\r\n#### 顶层操控规则，中层高节奏工作，而底层的穷人，将连被剥削的价值都不再会有。\r\n当底层人民对着邻里乡亲高喊读书无用时，阿尔法狗已经战胜了李世石，一场“人工智能”的革命正悄无声息地到来。\r\n\r\n可以预见，随着人工智能的发展，“机器换人”是必然的趋势，当一批又一批“自动XX机”进入各行各业之后，社会对蓝领的需求将大幅降低。到了那一天，那些放弃教育的底层人民，他们的出路又在哪里？\r\n\r\n这是政府要考虑的问题。\r\n\r\n#### 而对于我们自己而言，更关心的问题是：这个社会还有打破阶层的可能吗？\r\n有，当然有！\r\n\r\n即便是在阶层高度固化的英国社会，在纪录片《人生七年》中，依然出现了一个人，他打破了阶层的天花板成功晋升精英，他就是Nicolas ——一个农夫的儿子，他考上了牛津大学，然后成为了美国名校的教授。\r\n![](http://dingyue.nosdn.127.net/LzBa91oiED0eXYZ4h3chII2sU59E5ghKKrlM9PE16Zk511473750305802transferflag.png?imageView&thumbnail=690x10000&quality=50)\r\n十四分之一，从概率上来算，约为7%。\r\n\r\n无独有偶，全球复杂网络研究权威、美国物理学会院士巴拉巴西在《爆发》一书中提到了这样一个观点：**人类行为的93%是可以预测的，而剩下的那7%无法预测的人则改变了世界。**\r\n\r\n书中没有给出7%这个数字是怎么来的，但至少他给了我们一个启示：\r\n\r\n#### 世界上永远存在这样一类人，他能够超越自己的家庭、血缘、环境，他能够挣脱时代对他的束缚，让世界另眼相看，这一类人被称为英雄。\r\n那么问题来了：社会即将分层，阶层正在固化，而你，能成为英雄吗？\r\n\r\n本文转自公众号缓缓君', ',思想,', '26', '0', '2016-09-13 21:47:37', '2016-09-13 22:10:53', '0', 'http://dingyue.nosdn.127.net/qCQ6eiZoZWuBY3ByGXkVY5bGAwqbXQ66luTcgpywuvIno1473750305795transferflag.png?imageView&amp;thumbnail=690x10000&amp;quality=50', '1', 'http://c.m.163.com/news/a/C0RQ7S090521AGAM.html?s=newsapp&w=4&f=wx');
INSERT INTO `tb_post` VALUES ('83', '1', '2016-10-08 健身日志', '', '', '0', '\r\n#运动前：\r\n##### 1.跑步10分钟，速度7\r\n##### 2.拉伸\r\n<1>小腿\r\n<2>背肌，双手拉住栏杆，腿分叉直了，头往下压，要背部疼\r\n<3>臀部和大腿根部，双手拉住栏杆，腿分叉直了，下蹲姿势\r\n<4>大腿正面，手拉着脚背，往屁股后面拉脚。\r\n<5>胸肌，一只手扶在墙上，拉胸。\r\n#正式运动\r\n1.深蹲 15次*2组\r\n2.俯卧撑，跳起，张腿 15次*2组\r\n3.哑铃推举 10次*2组\r\n4.杠铃提取 10次*2组\r\n4.走5分钟+跑20分钟\r\n\r\n总耗时1个半小时\r\n', ',日记,', '41', '0', '2016-10-09 11:40:31', '2016-10-11 10:12:59', '0', '', '0', '');
INSERT INTO `tb_post` VALUES ('84', '1', '不要以为你是恩师，徒弟就不挖你的坟', '', '', '0', '近来偶得一本写明万历时代的小说，于是花时间阅读完，并且观看了与之相关的电视剧，通过搜索引擎，查找多篇百科，博客，论坛文章进行对比。虽然细微之处，各种小说野史评文等都有出入，有作者过份发挥的地方，不过总的人，事，时间点，缘由是差不多的。\r\n综合理了理万历和张居正之间的恩恩怨怨，让我起了不少共鸣。往大了看，似只是中国有史的这三千年来无数次皇权，后权，相权，宦官，外戚，一干朝臣之间的大戏而已，来回重复的在每个朝代上演。历史的车轮轧过去，倒回来再轧，我们小老百姓从小都在电视剧中看这种剧，熟的不能再熟的套路，没什么好讲的，而且，跟我们无关；往小了看，我认为这就是家事，是每一个作为社会细胞的家庭，都无法避免的事，这也是引起我共鸣之处。\r\n万历9岁接替皇位，一个小学三四年级的年纪，自然不能理政。朝政由张居正牵头，太后和宦官保驾护航，中兴了十年。这十年大家都忙着教小皇帝料理军国大事，可却没有人能看得到他从一个只会听话乖巧懂事的小孩子，成长为一个思想渴求独立到完全不受任何人，任何典法约束的昏君，这段漫长的心路历程。\r\n皇帝也是一个孩子，也必须要有那个年纪最必须要有的东西--童年。可显然张居正这个严师剥夺了他多数光阴，用以学习怎么当个好皇帝。如果你要教一个人做到什么事，犹其是那种故事中流传的圣人行为，那你可得十二万分的注意一件事，那就是：自己做的到吗？老百姓家说的和做的不一样，无非骂两句，可帝师的行事追不上他口中对小皇帝天天念经的那些个廉德，那下场，就是死一票人，毁好几代名声。\r\n张居正兴起了大明朝十年，首功一件，拿点钱财，受些荣誉是应该的，就像他自己的用人原则：尚循吏而不重清流。意思就是要重用那些虽贪但能解决实际问题的官员，比如像殷正茂；至于像海瑞这样的清官，更多只是成就了个人一世清明，却难以解决国计民生的实际问题。张居正自己也非清廉，但人家会办事。可是张居正对皇帝讲学，却是用圣人的要求来规策一个十来岁的小孩子。按理说，给小孩上课，就应讲那些三观很高大上，正治正确，有\r\n2016-10-24', ',思想,', '9', '0', '2016-10-24 22:56:02', '2016-10-24 22:56:22', '0', '', '0', '');
INSERT INTO `tb_post` VALUES ('85', '1', 'CentOS7.2 OpenStack kvm', '', '', '0', 'http://www.cnblogs.com/dongdongwq/p/5649894.html\r\n1、系统环境\r\n```\r\n# uname -r\r\n\r\n3.10.0-327.el7.x86_64\r\n\r\n# cat /etc/redhat-release\r\n\r\nCentOS Linux release 7.2.1511 (Core)\r\n```\r\n2、服务器部署\r\n\r\n|  ip | 主机名  | 角色  | 配置  |\r\n| ------------ | ------------ | ------------ | ------------ |\r\n| 192.168.0.6  | controller  | 控制节点  | 内存:4G;CPU:2核;硬盘:50G  |\r\n| 192.168.0.7  | compute  | 计算节点  | 内存:2G;CPU:2核;硬盘:50G  |\r\n\r\n3、基础环境准备\r\n\r\n3.1、配置hosts\r\n```\r\n# cat /etc/hosts\r\n\r\n192.168.0.6 controller\r\n\r\n192.168.0.7 compute\r\n```\r\n\r\n3.2、配置时间同步\r\n```\r\n[root@controller ~]# yum install -y ntp\r\n\r\n[root@controller ~]# vim /etc/ntp.conf\r\n\r\n15 restrict -6 ::1\r\n\r\n16 restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap\r\n\r\n27 restrict 0.centos.pool.ntp.org nomodify notrap noquery\r\n\r\n28 restrict 1.centos.pool.ntp.org nomodify notrap noquery\r\n\r\n29 restrict 2.centos.pool.ntp.org nomodify notrap noquery\r\n\r\n30 restrict 3.centos.pool.ntp.org nomodify notrap noquery\r\n\r\n31 server 127.127.1.0\r\n\r\n32 fudge 127.127.1.0 stratum 10\r\n\r\n[root@controller ~]# systemctl enable ntpd\r\n\r\n[root@controller ~]# systemctl start ntpd\r\n```\r\n在控制节点和计算节点配置定时任务\r\n```\r\n[root@compute ~]# crontab -e\r\n```\r\n新增定时任务如下\r\n```\r\n*/5 * * * * /usr/sbin/ntpdate 192.168.0.6 >/dev/null 2>&1\r\n```\r\n3.3、关闭防火墙\r\n```\r\n# systemctl stop firewalld\r\n```\r\n3.4、关闭selinux\r\n```\r\nvim /etc/selinux/config\r\n# SELINUX=disabled\r\n```\r\n需要重启\r\n3.5、安装基础包\r\n```\r\n[root@controller ~]# yum install -y http://dl.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-8.noarch.rpm\r\n又发现了另外一个地址，不知道用哪个好\r\nyum install -y http://dl.fedoraproject.org/pub/epel/7Server/x86_64/e/epel-release-7-8.noarch.rpm\r\n\r\n[root@controller ~]# yum install -y centos-release-openstack-liberty\r\n\r\n[root@controller ~]# yum install -y python-openstackclient\r\n```\r\n3.6、安装mysql\r\n```\r\n[root@controller ~]# yum install -y mariadb mariadb-server MySQL-python\r\n\r\n[root@controller ~]# vim /etc/my.cnf\r\n```\r\n在mysqld模块添加如下几行：\r\n```\r\ndefault-storage-engine = innodb\r\n\r\ninnodb_file_per_table\r\n\r\ncollation-server = utf8_general_ci  \r\n\r\ninit-connect = \'SET NAMES utf8\'\r\n\r\ncharacter-set-server = utf8\r\n\r\n[root@controller ~]# systemctl enable mariadb.service\r\n\r\n[root@controller ~]# systemctl start mariadb.service\r\n\r\n[root@controller ~]# mysql_secure_installation\r\n```\r\n3.7、安装rabbitmq\r\n```\r\n[root@controller ~]# yum install -y rabbitmq-server\r\n\r\n[root@controller ~]# systemctl enable rabbitmq-server.service\r\n\r\n[root@controller ~]# systemctl start rabbitmq-server.service\r\n\r\n[root@controller ~]# rabbitmqctl add_user openstack openstack\r\n\r\nCreating user \"openstack\" ...\r\n\r\n...done.\r\n\r\n[root@controller ~]# rabbitmqctl set_permissions openstack \'.*\' \'.*\' \'.*\'\r\n\r\nSetting permissions for user \"openstack\" in vhost \"/\"...\r\n\r\n...done.\r\n\r\n[root@controller ~]# rabbitmqctl  set_user_tags openstack administrator\r\n\r\n[root@controller ~]# rabbitmq-plugins enable rabbitmq_management\r\n\r\n[root@controller ~]# systemctl restart rabbitmq-server.service\r\n\r\n```\r\n\r\n在浏览器中输入http://192.168.0.6:15672，默认账户和密码为guest\r\n\r\n登录后将前面创建的openstack用户加入到admin中，结果如下图：\r\n\r\n', ',技术,', '24', '0', '2016-10-28 23:07:47', '2016-10-29 00:16:55', '0', '', '0', '');
INSERT INTO `tb_post` VALUES ('86', '1', '吉他练习', '', '', '0', '53231323 43231323 63231323\r\n\r\n1 2 3 4 5  6  7  1\r\n3 5 7 8 10 12 14 15', ',思想,', '11', '0', '2016-11-05 19:20:44', '2016-11-05 19:35:57', '0', '', '0', '');
INSERT INTO `tb_post` VALUES ('87', '1', '摘录 2016-11月', '', '', '0', '- 你听过的最漂亮的一句话是什么？\r\n希望每个人死后尸体都能自动变成一本书，书的内容就是死者的生平。这样一来，有人成了名著，有人成了禁书，有人变成菜谱，有人变成地图，有人是美图秀秀使用手册，有人是小旅馆的登记薄......整个世界就是一个巨大的图书馆，我们读者别人，作者自己，等着被读\r\n\r\n', ',思想,', '4', '0', '2016-11-13 23:33:29', '2016-11-13 23:36:47', '0', '', '0', '');

-- ----------------------------
-- Table structure for tb_statistics
-- ----------------------------
DROP TABLE IF EXISTS `tb_statistics`;
CREATE TABLE `tb_statistics` (
  `id` mediumint(9) unsigned NOT NULL AUTO_INCREMENT COMMENT 'id',
  `user_count` int(10) unsigned DEFAULT '0' COMMENT '用户数',
  `post_count` int(10) unsigned DEFAULT '0' COMMENT '文章数量',
  `tag_count` int(10) unsigned DEFAULT '0' COMMENT '标签数量',
  `dau` int(10) unsigned DEFAULT '0' COMMENT '日活跃数量',
  `tags` varchar(128) DEFAULT NULL COMMENT '标签的统计数据',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=109 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of tb_statistics
-- ----------------------------
INSERT INTO `tb_statistics` VALUES ('1', '3', '39', '4', '2', null, '2016-08-17 12:56:09');
INSERT INTO `tb_statistics` VALUES ('2', '3', '39', '4', '2', null, '2016-08-18 00:00:00');
INSERT INTO `tb_statistics` VALUES ('3', '3', '39', '4', '1', null, '2016-08-19 00:00:00');
INSERT INTO `tb_statistics` VALUES ('4', '3', '41', '4', '2', null, '2016-08-20 00:00:00');
INSERT INTO `tb_statistics` VALUES ('5', '3', '41', '4', '0', null, '2016-08-21 00:00:00');
INSERT INTO `tb_statistics` VALUES ('6', '3', '41', '4', '0', null, '2016-08-22 00:00:00');
INSERT INTO `tb_statistics` VALUES ('7', '3', '41', '4', '0', null, '2016-08-23 00:00:00');
INSERT INTO `tb_statistics` VALUES ('8', '3', '44', '4', '1', null, '2016-08-24 00:00:00');
INSERT INTO `tb_statistics` VALUES ('9', '3', '44', '4', '1', null, '2016-08-25 00:00:00');
INSERT INTO `tb_statistics` VALUES ('10', '3', '44', '4', '2', null, '2016-08-26 00:00:00');
INSERT INTO `tb_statistics` VALUES ('11', '3', '44', '4', '0', null, '2016-08-27 00:00:00');
INSERT INTO `tb_statistics` VALUES ('12', '3', '44', '4', '0', null, '2016-08-28 00:00:00');
INSERT INTO `tb_statistics` VALUES ('13', '3', '44', '4', '0', null, '2016-08-29 00:00:00');
INSERT INTO `tb_statistics` VALUES ('14', '3', '44', '4', '0', null, '2016-08-30 00:00:00');
INSERT INTO `tb_statistics` VALUES ('15', '3', '44', '4', '0', null, '2016-08-31 00:00:00');
INSERT INTO `tb_statistics` VALUES ('16', '3', '44', '4', '1', null, '2016-09-01 00:00:00');
INSERT INTO `tb_statistics` VALUES ('17', '3', '44', '4', '1', null, '2016-09-02 00:00:00');
INSERT INTO `tb_statistics` VALUES ('18', '3', '45', '4', '1', null, '2016-09-03 00:00:00');
INSERT INTO `tb_statistics` VALUES ('19', '3', '45', '4', '0', null, '2016-09-04 00:00:00');
INSERT INTO `tb_statistics` VALUES ('20', '3', '46', '4', '1', null, '2016-09-05 00:00:00');
INSERT INTO `tb_statistics` VALUES ('21', '3', '46', '4', '0', null, '2016-09-06 00:00:00');
INSERT INTO `tb_statistics` VALUES ('22', '3', '47', '4', '1', null, '2016-09-07 00:00:00');
INSERT INTO `tb_statistics` VALUES ('23', '3', '48', '4', '1', null, '2016-09-08 00:00:00');
INSERT INTO `tb_statistics` VALUES ('24', '3', '48', '4', '1', null, '2016-09-09 00:00:00');
INSERT INTO `tb_statistics` VALUES ('25', '3', '49', '4', '1', null, '2016-09-10 00:00:00');
INSERT INTO `tb_statistics` VALUES ('26', '3', '52', '4', '1', '{\"total\":54,\"list\":[ {\"name\":\"技术\",\"count\":33},{\"name\":\"思想\",\"count\":19},{\"name\":\"历史\",\"count\":1}]}', '2016-09-11 00:00:00');
INSERT INTO `tb_statistics` VALUES ('30', '3', '53', '4', '1', null, '2016-09-13 00:00:00');
INSERT INTO `tb_statistics` VALUES ('31', '3', '54', '4', '1', null, '2016-09-14 00:00:00');
INSERT INTO `tb_statistics` VALUES ('29', '3', '53', '4', '1', null, '2016-09-12 00:00:00');
INSERT INTO `tb_statistics` VALUES ('32', '3', '54', '4', '0', null, '2016-09-15 00:00:00');
INSERT INTO `tb_statistics` VALUES ('33', '3', '54', '4', '0', null, '2016-09-16 00:00:00');
INSERT INTO `tb_statistics` VALUES ('34', '3', '54', '4', '0', null, '2016-09-17 00:00:00');
INSERT INTO `tb_statistics` VALUES ('35', '3', '54', '4', '1', null, '2016-09-18 00:00:00');
INSERT INTO `tb_statistics` VALUES ('36', '3', '54', '4', '0', null, '2016-09-19 00:00:00');
INSERT INTO `tb_statistics` VALUES ('37', '3', '54', '4', '0', null, '2016-09-20 00:00:00');
INSERT INTO `tb_statistics` VALUES ('38', '3', '54', '4', '1', null, '2016-09-21 00:00:00');
INSERT INTO `tb_statistics` VALUES ('39', '3', '54', '4', '0', null, '2016-09-22 00:00:00');
INSERT INTO `tb_statistics` VALUES ('40', '3', '54', '4', '0', null, '2016-09-23 00:00:00');
INSERT INTO `tb_statistics` VALUES ('41', '3', '54', '4', '0', null, '2016-09-24 00:00:00');
INSERT INTO `tb_statistics` VALUES ('42', '3', '54', '4', '0', null, '2016-09-25 00:00:00');
INSERT INTO `tb_statistics` VALUES ('43', '3', '54', '4', '0', null, '2016-09-26 00:00:00');
INSERT INTO `tb_statistics` VALUES ('44', '3', '54', '4', '0', null, '2016-09-27 00:00:00');
INSERT INTO `tb_statistics` VALUES ('45', '3', '54', '4', '0', null, '2016-09-28 00:00:00');
INSERT INTO `tb_statistics` VALUES ('46', '3', '54', '4', '0', null, '2016-09-29 00:00:00');
INSERT INTO `tb_statistics` VALUES ('47', '3', '54', '4', '0', null, '2016-09-30 00:00:00');
INSERT INTO `tb_statistics` VALUES ('48', '3', '54', '4', '0', null, '2016-10-01 00:00:00');
INSERT INTO `tb_statistics` VALUES ('49', '3', '54', '4', '0', null, '2016-10-02 00:00:00');
INSERT INTO `tb_statistics` VALUES ('50', '3', '54', '4', '0', null, '2016-10-03 00:00:00');
INSERT INTO `tb_statistics` VALUES ('51', '3', '54', '4', '0', null, '2016-10-04 00:00:00');
INSERT INTO `tb_statistics` VALUES ('52', '3', '54', '4', '0', null, '2016-10-05 00:00:00');
INSERT INTO `tb_statistics` VALUES ('53', '3', '54', '4', '0', null, '2016-10-06 00:00:00');
INSERT INTO `tb_statistics` VALUES ('54', '3', '54', '4', '0', null, '2016-10-07 00:00:00');
INSERT INTO `tb_statistics` VALUES ('55', '3', '54', '4', '0', null, '2016-10-08 00:00:00');
INSERT INTO `tb_statistics` VALUES ('56', '3', '54', '4', '0', null, '2016-10-09 00:00:00');
INSERT INTO `tb_statistics` VALUES ('57', '3', '55', '5', '1', null, '2016-10-10 00:00:00');
INSERT INTO `tb_statistics` VALUES ('58', '3', '55', '5', '0', null, '2016-10-11 00:00:00');
INSERT INTO `tb_statistics` VALUES ('59', '3', '55', '5', '1', null, '2016-10-12 00:00:00');
INSERT INTO `tb_statistics` VALUES ('60', '3', '55', '5', '0', null, '2016-10-13 00:00:00');
INSERT INTO `tb_statistics` VALUES ('61', '3', '55', '5', '0', null, '2016-10-14 00:00:00');
INSERT INTO `tb_statistics` VALUES ('62', '3', '55', '5', '0', null, '2016-10-15 00:00:00');
INSERT INTO `tb_statistics` VALUES ('63', '3', '55', '5', '0', null, '2016-10-16 00:00:00');
INSERT INTO `tb_statistics` VALUES ('64', '3', '55', '5', '0', null, '2016-10-17 00:00:00');
INSERT INTO `tb_statistics` VALUES ('65', '3', '55', '5', '0', null, '2016-10-18 00:00:00');
INSERT INTO `tb_statistics` VALUES ('66', '3', '55', '5', '0', null, '2016-10-19 00:00:00');
INSERT INTO `tb_statistics` VALUES ('67', '3', '55', '5', '0', null, '2016-10-20 00:00:00');
INSERT INTO `tb_statistics` VALUES ('68', '3', '55', '5', '0', null, '2016-10-21 00:00:00');
INSERT INTO `tb_statistics` VALUES ('69', '3', '55', '5', '0', null, '2016-10-22 00:00:00');
INSERT INTO `tb_statistics` VALUES ('70', '3', '55', '5', '0', null, '2016-10-23 00:00:00');
INSERT INTO `tb_statistics` VALUES ('71', '3', '55', '5', '0', null, '2016-10-24 00:00:00');
INSERT INTO `tb_statistics` VALUES ('72', '3', '56', '5', '1', null, '2016-10-25 00:00:00');
INSERT INTO `tb_statistics` VALUES ('73', '3', '56', '5', '0', null, '2016-10-26 00:00:00');
INSERT INTO `tb_statistics` VALUES ('74', '3', '56', '5', '0', null, '2016-10-27 00:00:00');
INSERT INTO `tb_statistics` VALUES ('75', '3', '56', '5', '0', null, '2016-10-28 00:00:00');
INSERT INTO `tb_statistics` VALUES ('76', '3', '57', '5', '1', null, '2016-10-29 00:00:00');
INSERT INTO `tb_statistics` VALUES ('77', '3', '57', '5', '0', null, '2016-10-30 00:00:00');
INSERT INTO `tb_statistics` VALUES ('78', '3', '57', '5', '0', null, '2016-10-31 00:00:00');
INSERT INTO `tb_statistics` VALUES ('79', '3', '57', '5', '0', null, '2016-11-01 00:00:00');
INSERT INTO `tb_statistics` VALUES ('80', '3', '57', '5', '0', null, '2016-11-02 00:00:00');
INSERT INTO `tb_statistics` VALUES ('81', '3', '57', '5', '0', null, '2016-11-03 00:00:00');
INSERT INTO `tb_statistics` VALUES ('82', '3', '57', '5', '0', null, '2016-11-04 00:00:00');
INSERT INTO `tb_statistics` VALUES ('83', '3', '57', '5', '0', null, '2016-11-05 00:00:00');
INSERT INTO `tb_statistics` VALUES ('84', '3', '58', '5', '1', null, '2016-11-06 00:00:00');
INSERT INTO `tb_statistics` VALUES ('85', '3', '58', '5', '0', null, '2016-11-07 00:00:00');
INSERT INTO `tb_statistics` VALUES ('86', '3', '58', '5', '0', null, '2016-11-08 00:00:00');
INSERT INTO `tb_statistics` VALUES ('87', '3', '58', '5', '0', null, '2016-11-09 00:00:00');
INSERT INTO `tb_statistics` VALUES ('88', '3', '58', '5', '0', null, '2016-11-10 00:00:00');
INSERT INTO `tb_statistics` VALUES ('89', '3', '58', '5', '0', null, '2016-11-11 00:00:00');
INSERT INTO `tb_statistics` VALUES ('90', '3', '58', '5', '0', null, '2016-11-12 00:00:00');
INSERT INTO `tb_statistics` VALUES ('91', '3', '58', '5', '0', null, '2016-11-13 00:00:00');
INSERT INTO `tb_statistics` VALUES ('92', '3', '59', '5', '1', null, '2016-11-14 00:00:00');
INSERT INTO `tb_statistics` VALUES ('93', '3', '59', '5', '0', null, '2016-11-15 00:00:00');
INSERT INTO `tb_statistics` VALUES ('94', '3', '59', '5', '0', null, '2016-11-16 00:00:00');
INSERT INTO `tb_statistics` VALUES ('95', '3', '59', '5', '0', null, '2016-11-17 00:00:00');
INSERT INTO `tb_statistics` VALUES ('96', '3', '59', '5', '0', null, '2016-11-18 00:00:00');
INSERT INTO `tb_statistics` VALUES ('97', '3', '59', '5', '0', null, '2016-11-19 00:00:00');
INSERT INTO `tb_statistics` VALUES ('98', '3', '59', '5', '0', null, '2016-11-20 00:00:00');
INSERT INTO `tb_statistics` VALUES ('99', '3', '59', '5', '0', null, '2016-11-21 00:00:00');
INSERT INTO `tb_statistics` VALUES ('100', '3', '59', '5', '0', null, '2016-11-22 00:00:00');
INSERT INTO `tb_statistics` VALUES ('101', '3', '59', '5', '0', null, '2016-11-23 00:00:00');
INSERT INTO `tb_statistics` VALUES ('102', '3', '59', '5', '0', null, '2016-11-24 00:00:00');
INSERT INTO `tb_statistics` VALUES ('103', '3', '59', '5', '0', null, '2016-11-25 00:00:00');
INSERT INTO `tb_statistics` VALUES ('104', '3', '59', '5', '0', null, '2016-11-26 00:00:00');
INSERT INTO `tb_statistics` VALUES ('105', '3', '59', '5', '0', null, '2016-11-27 00:00:00');
INSERT INTO `tb_statistics` VALUES ('106', '3', '59', '5', '0', null, '2016-11-28 00:00:00');
INSERT INTO `tb_statistics` VALUES ('107', '3', '59', '5', '0', null, '2016-11-29 00:00:00');
INSERT INTO `tb_statistics` VALUES ('108', '3', '59', '5', '0', null, '2016-11-30 00:00:00');

-- ----------------------------
-- Table structure for tb_tag
-- ----------------------------
DROP TABLE IF EXISTS `tb_tag`;
CREATE TABLE `tb_tag` (
  `id` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(20) NOT NULL DEFAULT '' COMMENT '标签名',
  `count` mediumint(8) unsigned NOT NULL DEFAULT '0' COMMENT '使用次数',
  PRIMARY KEY (`id`),
  KEY `name` (`name`)
) ENGINE=InnoDB AUTO_INCREMENT=18 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of tb_tag
-- ----------------------------
INSERT INTO `tb_tag` VALUES ('11', '技术', '34');
INSERT INTO `tb_tag` VALUES ('12', '思想', '24');
INSERT INTO `tb_tag` VALUES ('15', '历史', '1');
INSERT INTO `tb_tag` VALUES ('16', '比特币', '1');
INSERT INTO `tb_tag` VALUES ('17', '日记', '1');

-- ----------------------------
-- Table structure for tb_tag_post
-- ----------------------------
DROP TABLE IF EXISTS `tb_tag_post`;
CREATE TABLE `tb_tag_post` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `tagid` mediumint(8) unsigned NOT NULL DEFAULT '0' COMMENT '标签id',
  `postid` mediumint(8) unsigned NOT NULL DEFAULT '0' COMMENT '内容id',
  `poststatus` tinyint(3) NOT NULL DEFAULT '0' COMMENT '内容状态',
  `posttime` datetime DEFAULT NULL COMMENT '发布时间',
  PRIMARY KEY (`id`),
  KEY `tagid` (`tagid`),
  KEY `postid` (`postid`)
) ENGINE=InnoDB AUTO_INCREMENT=350 DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of tb_tag_post
-- ----------------------------
INSERT INTO `tb_tag_post` VALUES ('59', '12', '15', '0', '2015-10-08 01:07:35');
INSERT INTO `tb_tag_post` VALUES ('60', '11', '16', '0', '2015-10-08 01:10:12');
INSERT INTO `tb_tag_post` VALUES ('63', '11', '17', '0', '2015-10-08 21:27:21');
INSERT INTO `tb_tag_post` VALUES ('64', '12', '18', '0', '2015-10-09 01:12:13');
INSERT INTO `tb_tag_post` VALUES ('65', '12', '19', '0', '2015-10-09 01:18:39');
INSERT INTO `tb_tag_post` VALUES ('66', '12', '14', '0', '2015-10-27 11:11:05');
INSERT INTO `tb_tag_post` VALUES ('77', '11', '21', '0', '2015-10-28 23:22:09');
INSERT INTO `tb_tag_post` VALUES ('78', '11', '22', '0', '2015-10-30 11:42:12');
INSERT INTO `tb_tag_post` VALUES ('82', '11', '23', '0', '2015-10-30 22:47:44');
INSERT INTO `tb_tag_post` VALUES ('85', '11', '26', '0', '2015-11-03 21:57:45');
INSERT INTO `tb_tag_post` VALUES ('86', '11', '24', '0', '2015-11-05 14:01:17');
INSERT INTO `tb_tag_post` VALUES ('87', '11', '20', '0', '2015-11-05 14:04:54');
INSERT INTO `tb_tag_post` VALUES ('88', '11', '25', '0', '2015-11-05 14:05:08');
INSERT INTO `tb_tag_post` VALUES ('107', '11', '28', '0', '2015-11-07 16:31:44');
INSERT INTO `tb_tag_post` VALUES ('111', '11', '30', '0', '2016-02-23 12:57:59');
INSERT INTO `tb_tag_post` VALUES ('135', '11', '31', '0', '2016-06-03 14:13:18');
INSERT INTO `tb_tag_post` VALUES ('149', '11', '32', '0', '2016-06-04 15:12:03');
INSERT INTO `tb_tag_post` VALUES ('152', '11', '34', '0', '2016-06-04 18:28:04');
INSERT INTO `tb_tag_post` VALUES ('153', '11', '33', '0', '2016-06-04 18:28:55');
INSERT INTO `tb_tag_post` VALUES ('157', '11', '35', '0', '2016-06-04 22:34:35');
INSERT INTO `tb_tag_post` VALUES ('158', '11', '36', '0', '2016-06-04 23:33:59');
INSERT INTO `tb_tag_post` VALUES ('185', '11', '37', '0', '2016-06-14 18:03:27');
INSERT INTO `tb_tag_post` VALUES ('188', '11', '40', '0', '2016-06-20 21:10:02');
INSERT INTO `tb_tag_post` VALUES ('215', '11', '42', '0', '2016-07-07 19:16:23');
INSERT INTO `tb_tag_post` VALUES ('225', '11', '41', '0', '2016-07-07 20:44:04');
INSERT INTO `tb_tag_post` VALUES ('226', '11', '43', '0', '2016-07-08 15:18:54');
INSERT INTO `tb_tag_post` VALUES ('239', '11', '54', '0', '2016-07-22 22:54:22');
INSERT INTO `tb_tag_post` VALUES ('247', '11', '59', '0', '2016-08-06 00:07:48');
INSERT INTO `tb_tag_post` VALUES ('249', '11', '39', '0', '2016-08-06 20:50:17');
INSERT INTO `tb_tag_post` VALUES ('251', '12', '60', '0', '2016-08-06 21:35:03');
INSERT INTO `tb_tag_post` VALUES ('254', '12', '61', '0', '2016-08-10 14:02:04');
INSERT INTO `tb_tag_post` VALUES ('256', '12', '57', '0', '2016-08-10 15:32:51');
INSERT INTO `tb_tag_post` VALUES ('257', '11', '58', '0', '2016-08-10 16:01:02');
INSERT INTO `tb_tag_post` VALUES ('260', '11', '44', '0', '2016-08-10 19:33:30');
INSERT INTO `tb_tag_post` VALUES ('262', '11', '38', '0', '2016-08-13 16:05:06');
INSERT INTO `tb_tag_post` VALUES ('263', '12', '62', '0', '2016-08-13 22:07:34');
INSERT INTO `tb_tag_post` VALUES ('265', '12', '68', '0', '2016-08-19 12:52:43');
INSERT INTO `tb_tag_post` VALUES ('267', '11', '69', '0', '2016-08-19 16:42:49');
INSERT INTO `tb_tag_post` VALUES ('273', '11', '71', '0', '2016-08-23 16:29:42');
INSERT INTO `tb_tag_post` VALUES ('287', '12', '72', '0', '2016-08-25 13:24:27');
INSERT INTO `tb_tag_post` VALUES ('290', '15', '27', '0', '2016-08-25 16:31:39');
INSERT INTO `tb_tag_post` VALUES ('305', '12', '76', '0', '2016-09-07 17:26:26');
INSERT INTO `tb_tag_post` VALUES ('306', '12', '75', '0', '2016-09-07 21:16:59');
INSERT INTO `tb_tag_post` VALUES ('307', '12', '74', '0', '2016-09-07 21:17:40');
INSERT INTO `tb_tag_post` VALUES ('308', '12', '73', '0', '2016-09-07 21:18:20');
INSERT INTO `tb_tag_post` VALUES ('311', '11', '63', '0', '2016-09-07 21:40:44');
INSERT INTO `tb_tag_post` VALUES ('314', '12', '77', '0', '2016-09-09 22:42:14');
INSERT INTO `tb_tag_post` VALUES ('321', '16', '29', '0', '2016-09-09 23:33:00');
INSERT INTO `tb_tag_post` VALUES ('322', '11', '29', '0', '2016-09-09 23:33:00');
INSERT INTO `tb_tag_post` VALUES ('326', '12', '70', '0', '2016-09-10 14:49:04');
INSERT INTO `tb_tag_post` VALUES ('327', '12', '79', '0', '2016-09-10 15:06:06');
INSERT INTO `tb_tag_post` VALUES ('329', '12', '81', '0', '2016-09-11 10:53:34');
INSERT INTO `tb_tag_post` VALUES ('330', '12', '78', '0', '2016-09-11 10:56:28');
INSERT INTO `tb_tag_post` VALUES ('331', '12', '80', '0', '2016-09-11 11:02:10');
INSERT INTO `tb_tag_post` VALUES ('335', '12', '82', '0', '2016-09-13 22:10:53');
INSERT INTO `tb_tag_post` VALUES ('337', '17', '83', '0', '2016-10-11 10:12:59');
INSERT INTO `tb_tag_post` VALUES ('338', '12', '84', '0', '2016-10-24 22:56:22');
INSERT INTO `tb_tag_post` VALUES ('345', '11', '85', '0', '2016-10-29 00:16:55');
INSERT INTO `tb_tag_post` VALUES ('347', '12', '86', '0', '2016-11-05 19:35:57');
INSERT INTO `tb_tag_post` VALUES ('349', '12', '87', '0', '2016-11-13 23:36:47');

-- ----------------------------
-- Table structure for tb_user
-- ----------------------------
DROP TABLE IF EXISTS `tb_user`;
CREATE TABLE `tb_user` (
  `id` mediumint(8) unsigned NOT NULL AUTO_INCREMENT COMMENT '用户id',
  `username` varchar(15) CHARACTER SET utf8 NOT NULL DEFAULT '' COMMENT '用户名',
  `password` varchar(32) CHARACTER SET utf8 NOT NULL DEFAULT '' COMMENT '密码',
  `email` varchar(50) CHARACTER SET utf8 NOT NULL DEFAULT '' COMMENT '邮箱',
  `logincount` mediumint(8) unsigned NOT NULL DEFAULT '0' COMMENT '登录次数',
  `lastip` varchar(15) CHARACTER SET utf8 NOT NULL DEFAULT '0' COMMENT '最后登录ip',
  `lastlogin` datetime DEFAULT NULL COMMENT '最后登录时间',
  `authkey` char(10) CHARACTER SET utf8 NOT NULL DEFAULT '' COMMENT '登录key',
  `active` tinyint(3) NOT NULL DEFAULT '0' COMMENT '是否激活',
  `avatarurl` varchar(128) CHARACTER SET utf8 DEFAULT NULL,
  `follow_count` int(10) unsigned DEFAULT '0' COMMENT '粉丝数量',
  `post_count` int(10) unsigned DEFAULT '0' COMMENT '文章数量',
  `qq_openid` varchar(64) CHARACTER SET utf8 DEFAULT NULL COMMENT 'qq openid',
  `qq_accesstoken` varchar(64) CHARACTER SET utf8 DEFAULT NULL COMMENT 'qq accessToken',
  PRIMARY KEY (`id`),
  UNIQUE KEY `username` (`username`)
) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8mb4;

-- ----------------------------
-- Records of tb_user
-- ----------------------------
INSERT INTO `tb_user` VALUES ('1', 'Liberalman', 'e10adc3949ba59abbe56e057f20f883e', 'zscchina@163.com', '175', '[', '2017-02-09 00:46:44', '', '1', '/static/upload/smallpic/20151008/1444238136469360800.jpg', '0', '58', 'DBB544A169BFC1BA351FEC12ACDE51F3', '7CECDDE66B653E9B715356050F1E4748');
INSERT INTO `tb_user` VALUES ('2', '周强', 'e10adc3949ba59abbe56e057f20f883e', '875223415@qq.com', '25', '66.249.79.129', '2016-08-25 08:07:07', '', '1', '/static/upload/smallpic/20151008/1444238136459112184.jpg', '0', '1', '', '');
INSERT INTO `tb_user` VALUES ('6', '新月', '', '', '1', '111.20.18.68', '2016-08-16 16:40:39', '', '1', 'http://q.qlogo.cn/qqapp/101345272/C24773F25D170036BADA08641F11F383/100', '0', '0', 'C24773F25D170036BADA08641F11F383', 'A96EDBE5E8EEAC0187BC0B7F90D48FBF');

-- ----------------------------
-- View structure for tb_article
-- ----------------------------
DROP VIEW IF EXISTS `tb_article`;
CREATE ALGORITHM=UNDEFINED DEFINER=`socho`@`%` SQL SECURITY DEFINER VIEW `tb_article` AS select `tb_user`.`username` AS `username`,`tb_post`.`id` AS `id`,`tb_post`.`userid` AS `userid`,`tb_post`.`title` AS `title`,`tb_post`.`color` AS `color`,`tb_post`.`urlname` AS `urlname`,`tb_post`.`urltype` AS `urltype`,`tb_post`.`content` AS `content`,`tb_post`.`tags` AS `tags`,`tb_post`.`views` AS `views`,`tb_post`.`status` AS `status`,`tb_post`.`posttime` AS `posttime`,`tb_post`.`updated` AS `updated`,`tb_post`.`istop` AS `istop`,`tb_post`.`coverurl` AS `coverurl`,`tb_post`.`pubtype` AS `pubtype`,`tb_post`.`reprinturl` AS `reprinturl`,`tb_user`.`avatarurl` AS `avatarurl` from (`tb_user` join `tb_post`) where (`tb_user`.`id` = `tb_post`.`userid`) ;
DROP TRIGGER IF EXISTS `InsertPhoto`;
DELIMITER ;;
CREATE TRIGGER `InsertPhoto` AFTER INSERT ON `tb_photo` FOR EACH ROW update tb_album set photonum=photonum+1 where id = new.albumid
;;
DELIMITER ;
DROP TRIGGER IF EXISTS `tg_post_insert`;
DELIMITER ;;
CREATE TRIGGER `tg_post_insert` AFTER INSERT ON `tb_post` FOR EACH ROW begin
	update tb_user set post_count=(select count(id) from tb_post where userid=new.userid) where id=new.userid;
end
;;
DELIMITER ;
DROP TRIGGER IF EXISTS `tg_post_delete`;
DELIMITER ;;
CREATE TRIGGER `tg_post_delete` AFTER DELETE ON `tb_post` FOR EACH ROW begin
	update tb_user set post_count=(select count(id) from tb_post where userid=old.userid) where id=old.userid;
end
;;
DELIMITER ;
